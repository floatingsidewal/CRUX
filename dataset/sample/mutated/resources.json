[
  {
    "id": "/subscriptions/template-sim/resourceGroups/template-rg/providers/Microsoft.Storage/storageAccounts/[parameters('storageAccountName')]",
    "type": "Microsoft.Storage/storageAccounts",
    "apiVersion": "2023-05-01",
    "name": "[parameters('storageAccountName')]",
    "location": "[parameters('location')]",
    "properties": {
      "isHnsEnabled": true,
      "isLocalUserEnabled": true,
      "isSftpEnabled": true,
      "allowBlobPublicAccess": true
    },
    "dependsOn": [],
    "tags": {},
    "sku": {
      "name": "[parameters('storageAccountType')]"
    },
    "kind": "StorageV2",
    "_raw": {
      "type": "Microsoft.Storage/storageAccounts",
      "apiVersion": "2023-05-01",
      "name": "[parameters('storageAccountName')]",
      "location": "[parameters('location')]",
      "sku": {
        "name": "[parameters('storageAccountType')]"
      },
      "kind": "StorageV2",
      "properties": {
        "isHnsEnabled": true,
        "isLocalUserEnabled": true,
        "isSftpEnabled": true,
        "allowBlobPublicAccess": true
      }
    },
    "_metadata": {
      "source_template": "templates/azure-quickstart-templates/quickstarts/microsoft.storage/storage-sftp/main.bicep",
      "is_mutated": true,
      "mutation_id": "storage_public_blob_access",
      "mutation_description": "Enable public blob access on storage account",
      "mutation_severity": "high"
    },
    "_mutation_applied": [
      {
        "mutation_id": "storage_public_blob_access",
        "labels": [
          "Storage_PublicAccess",
          "CIS_3.7"
        ],
        "severity": "high"
      }
    ]
  },
  {
    "id": "/subscriptions/template-sim/resourceGroups/template-rg/providers/Microsoft.Storage/storageAccounts/[parameters('storageAccountName')]",
    "type": "Microsoft.Storage/storageAccounts",
    "apiVersion": "2023-05-01",
    "name": "[parameters('storageAccountName')]",
    "location": "[parameters('location')]",
    "properties": {
      "isHnsEnabled": true,
      "isLocalUserEnabled": true,
      "isSftpEnabled": true,
      "minimumTlsVersion": "TLS1_0"
    },
    "dependsOn": [],
    "tags": {},
    "sku": {
      "name": "[parameters('storageAccountType')]"
    },
    "kind": "StorageV2",
    "_raw": {
      "type": "Microsoft.Storage/storageAccounts",
      "apiVersion": "2023-05-01",
      "name": "[parameters('storageAccountName')]",
      "location": "[parameters('location')]",
      "sku": {
        "name": "[parameters('storageAccountType')]"
      },
      "kind": "StorageV2",
      "properties": {
        "isHnsEnabled": true,
        "isLocalUserEnabled": true,
        "isSftpEnabled": true,
        "minimumTlsVersion": "TLS1_0"
      }
    },
    "_metadata": {
      "source_template": "templates/azure-quickstart-templates/quickstarts/microsoft.storage/storage-sftp/main.bicep",
      "is_mutated": true,
      "mutation_id": "storage_weak_tls",
      "mutation_description": "Set minimum TLS version to 1.0 (weak)",
      "mutation_severity": "medium"
    },
    "_mutation_applied": [
      {
        "mutation_id": "storage_weak_tls",
        "labels": [
          "Storage_WeakTLS",
          "CIS_3.8"
        ],
        "severity": "medium"
      }
    ]
  },
  {
    "id": "/subscriptions/template-sim/resourceGroups/template-rg/providers/Microsoft.Storage/storageAccounts/[parameters('storageAccountName')]",
    "type": "Microsoft.Storage/storageAccounts",
    "apiVersion": "2023-05-01",
    "name": "[parameters('storageAccountName')]",
    "location": "[parameters('location')]",
    "properties": {
      "isHnsEnabled": true,
      "isLocalUserEnabled": true,
      "isSftpEnabled": true,
      "supportsHttpsTrafficOnly": false
    },
    "dependsOn": [],
    "tags": {},
    "sku": {
      "name": "[parameters('storageAccountType')]"
    },
    "kind": "StorageV2",
    "_raw": {
      "type": "Microsoft.Storage/storageAccounts",
      "apiVersion": "2023-05-01",
      "name": "[parameters('storageAccountName')]",
      "location": "[parameters('location')]",
      "sku": {
        "name": "[parameters('storageAccountType')]"
      },
      "kind": "StorageV2",
      "properties": {
        "isHnsEnabled": true,
        "isLocalUserEnabled": true,
        "isSftpEnabled": true,
        "supportsHttpsTrafficOnly": false
      }
    },
    "_metadata": {
      "source_template": "templates/azure-quickstart-templates/quickstarts/microsoft.storage/storage-sftp/main.bicep",
      "is_mutated": true,
      "mutation_id": "storage_http_allowed",
      "mutation_description": "Allow HTTP traffic (not HTTPS-only)",
      "mutation_severity": "high"
    },
    "_mutation_applied": [
      {
        "mutation_id": "storage_http_allowed",
        "labels": [
          "Storage_HTTPAllowed",
          "CIS_3.1"
        ],
        "severity": "high"
      }
    ]
  },
  {
    "id": "/subscriptions/template-sim/resourceGroups/template-rg/providers/Microsoft.Storage/storageAccounts/[parameters('storageAccountName')]",
    "type": "Microsoft.Storage/storageAccounts",
    "apiVersion": "2023-05-01",
    "name": "[parameters('storageAccountName')]",
    "location": "[parameters('location')]",
    "properties": {
      "isHnsEnabled": true,
      "isLocalUserEnabled": true,
      "isSftpEnabled": true,
      "networkAcls": {
        "defaultAction": "Allow"
      }
    },
    "dependsOn": [],
    "tags": {},
    "sku": {
      "name": "[parameters('storageAccountType')]"
    },
    "kind": "StorageV2",
    "_raw": {
      "type": "Microsoft.Storage/storageAccounts",
      "apiVersion": "2023-05-01",
      "name": "[parameters('storageAccountName')]",
      "location": "[parameters('location')]",
      "sku": {
        "name": "[parameters('storageAccountType')]"
      },
      "kind": "StorageV2",
      "properties": {
        "isHnsEnabled": true,
        "isLocalUserEnabled": true,
        "isSftpEnabled": true,
        "networkAcls": {
          "defaultAction": "Allow"
        }
      }
    },
    "_metadata": {
      "source_template": "templates/azure-quickstart-templates/quickstarts/microsoft.storage/storage-sftp/main.bicep",
      "is_mutated": true,
      "mutation_id": "storage_open_firewall",
      "mutation_description": "Set firewall to allow all network traffic",
      "mutation_severity": "high"
    },
    "_mutation_applied": [
      {
        "mutation_id": "storage_open_firewall",
        "labels": [
          "Storage_FirewallOpen",
          "CIS_3.6"
        ],
        "severity": "high"
      }
    ]
  },
  {
    "id": "/subscriptions/template-sim/resourceGroups/template-rg/providers/Microsoft.Storage/storageAccounts/[parameters('storageAccountName')]",
    "type": "Microsoft.Storage/storageAccounts",
    "apiVersion": "2023-05-01",
    "name": "[parameters('storageAccountName')]",
    "location": "[parameters('location')]",
    "properties": {
      "isHnsEnabled": true,
      "isLocalUserEnabled": true,
      "isSftpEnabled": true,
      "supportsHttpsTrafficOnly": false
    },
    "dependsOn": [],
    "tags": {},
    "sku": {
      "name": "[parameters('storageAccountType')]"
    },
    "kind": "StorageV2",
    "_raw": {
      "type": "Microsoft.Storage/storageAccounts",
      "apiVersion": "2023-05-01",
      "name": "[parameters('storageAccountName')]",
      "location": "[parameters('location')]",
      "sku": {
        "name": "[parameters('storageAccountType')]"
      },
      "kind": "StorageV2",
      "properties": {
        "isHnsEnabled": true,
        "isLocalUserEnabled": true,
        "isSftpEnabled": true,
        "supportsHttpsTrafficOnly": false
      }
    },
    "_metadata": {
      "source_template": "templates/azure-quickstart-templates/quickstarts/microsoft.storage/storage-sftp/main.bicep",
      "is_mutated": true,
      "mutation_id": "storage_insecure_transfer",
      "mutation_description": "Disable secure transfer requirement",
      "mutation_severity": "critical"
    },
    "_mutation_applied": [
      {
        "mutation_id": "storage_insecure_transfer",
        "labels": [
          "Storage_InsecureTransfer",
          "CIS_3.1"
        ],
        "severity": "critical"
      }
    ]
  },
  {
    "id": "/subscriptions/template-sim/resourceGroups/template-rg/providers/Microsoft.Storage/storageAccounts/[parameters('storageAccountName')]",
    "type": "Microsoft.Storage/storageAccounts",
    "apiVersion": "2023-05-01",
    "name": "[parameters('storageAccountName')]",
    "location": "[parameters('location')]",
    "properties": {
      "isHnsEnabled": true,
      "isLocalUserEnabled": true,
      "isSftpEnabled": true,
      "isVersioningEnabled": false
    },
    "dependsOn": [],
    "tags": {},
    "sku": {
      "name": "[parameters('storageAccountType')]"
    },
    "kind": "StorageV2",
    "_raw": {
      "type": "Microsoft.Storage/storageAccounts",
      "apiVersion": "2023-05-01",
      "name": "[parameters('storageAccountName')]",
      "location": "[parameters('location')]",
      "sku": {
        "name": "[parameters('storageAccountType')]"
      },
      "kind": "StorageV2",
      "properties": {
        "isHnsEnabled": true,
        "isLocalUserEnabled": true,
        "isSftpEnabled": true,
        "isVersioningEnabled": false
      }
    },
    "_metadata": {
      "source_template": "templates/azure-quickstart-templates/quickstarts/microsoft.storage/storage-sftp/main.bicep",
      "is_mutated": true,
      "mutation_id": "storage_no_blob_versioning",
      "mutation_description": "Disable blob versioning",
      "mutation_severity": "low"
    },
    "_mutation_applied": [
      {
        "mutation_id": "storage_no_blob_versioning",
        "labels": [
          "Storage_NoVersioning"
        ],
        "severity": "low"
      }
    ]
  },
  {
    "id": "/subscriptions/template-sim/resourceGroups/template-rg/providers/Microsoft.Storage/storageAccounts/[parameters('storageAccountName')]",
    "type": "Microsoft.Storage/storageAccounts",
    "apiVersion": "2023-05-01",
    "name": "[parameters('storageAccountName')]",
    "location": "[parameters('location')]",
    "properties": {
      "isHnsEnabled": true,
      "isLocalUserEnabled": true,
      "isSftpEnabled": true,
      "deleteRetentionPolicy": {
        "enabled": false
      }
    },
    "dependsOn": [],
    "tags": {},
    "sku": {
      "name": "[parameters('storageAccountType')]"
    },
    "kind": "StorageV2",
    "_raw": {
      "type": "Microsoft.Storage/storageAccounts",
      "apiVersion": "2023-05-01",
      "name": "[parameters('storageAccountName')]",
      "location": "[parameters('location')]",
      "sku": {
        "name": "[parameters('storageAccountType')]"
      },
      "kind": "StorageV2",
      "properties": {
        "isHnsEnabled": true,
        "isLocalUserEnabled": true,
        "isSftpEnabled": true,
        "deleteRetentionPolicy": {
          "enabled": false
        }
      }
    },
    "_metadata": {
      "source_template": "templates/azure-quickstart-templates/quickstarts/microsoft.storage/storage-sftp/main.bicep",
      "is_mutated": true,
      "mutation_id": "storage_no_soft_delete",
      "mutation_description": "Disable blob soft delete",
      "mutation_severity": "medium"
    },
    "_mutation_applied": [
      {
        "mutation_id": "storage_no_soft_delete",
        "labels": [
          "Storage_NoSoftDelete",
          "CIS_3.10"
        ],
        "severity": "medium"
      }
    ]
  },
  {
    "id": "/subscriptions/template-sim/resourceGroups/template-rg/providers/Microsoft.Storage/storageAccounts/[parameters('storageAccountName')]",
    "type": "Microsoft.Storage/storageAccounts",
    "apiVersion": "2023-05-01",
    "name": "[parameters('storageAccountName')]",
    "location": "[parameters('location')]",
    "properties": {
      "isHnsEnabled": true,
      "isLocalUserEnabled": true,
      "isSftpEnabled": true,
      "allowSharedKeyAccess": true
    },
    "dependsOn": [],
    "tags": {},
    "sku": {
      "name": "[parameters('storageAccountType')]"
    },
    "kind": "StorageV2",
    "_raw": {
      "type": "Microsoft.Storage/storageAccounts",
      "apiVersion": "2023-05-01",
      "name": "[parameters('storageAccountName')]",
      "location": "[parameters('location')]",
      "sku": {
        "name": "[parameters('storageAccountType')]"
      },
      "kind": "StorageV2",
      "properties": {
        "isHnsEnabled": true,
        "isLocalUserEnabled": true,
        "isSftpEnabled": true,
        "allowSharedKeyAccess": true
      }
    },
    "_metadata": {
      "source_template": "templates/azure-quickstart-templates/quickstarts/microsoft.storage/storage-sftp/main.bicep",
      "is_mutated": true,
      "mutation_id": "storage_allow_shared_key",
      "mutation_description": "Allow shared key access (not just Azure AD)",
      "mutation_severity": "medium"
    },
    "_mutation_applied": [
      {
        "mutation_id": "storage_allow_shared_key",
        "labels": [
          "Storage_SharedKeyAccess"
        ],
        "severity": "medium"
      }
    ]
  },
  {
    "id": "/subscriptions/template-sim/resourceGroups/template-rg/providers/Microsoft.Storage/storageAccounts/[parameters('storageAccountName')]",
    "type": "Microsoft.Storage/storageAccounts",
    "apiVersion": "2023-05-01",
    "name": "[parameters('storageAccountName')]",
    "location": "[parameters('location')]",
    "properties": {
      "isHnsEnabled": true,
      "isLocalUserEnabled": true,
      "isSftpEnabled": true,
      "encryption": {
        "requireInfrastructureEncryption": false
      }
    },
    "dependsOn": [],
    "tags": {},
    "sku": {
      "name": "[parameters('storageAccountType')]"
    },
    "kind": "StorageV2",
    "_raw": {
      "type": "Microsoft.Storage/storageAccounts",
      "apiVersion": "2023-05-01",
      "name": "[parameters('storageAccountName')]",
      "location": "[parameters('location')]",
      "sku": {
        "name": "[parameters('storageAccountType')]"
      },
      "kind": "StorageV2",
      "properties": {
        "isHnsEnabled": true,
        "isLocalUserEnabled": true,
        "isSftpEnabled": true,
        "encryption": {
          "requireInfrastructureEncryption": false
        }
      }
    },
    "_metadata": {
      "source_template": "templates/azure-quickstart-templates/quickstarts/microsoft.storage/storage-sftp/main.bicep",
      "is_mutated": true,
      "mutation_id": "storage_no_infrastructure_encryption",
      "mutation_description": "Disable infrastructure encryption",
      "mutation_severity": "medium"
    },
    "_mutation_applied": [
      {
        "mutation_id": "storage_no_infrastructure_encryption",
        "labels": [
          "Storage_NoInfraEncryption"
        ],
        "severity": "medium"
      }
    ]
  },
  {
    "id": "/subscriptions/template-sim/resourceGroups/template-rg/providers/Microsoft.Storage/storageAccounts/[parameters('storageAccountName')]",
    "type": "Microsoft.Storage/storageAccounts",
    "apiVersion": "2023-05-01",
    "name": "[parameters('storageAccountName')]",
    "location": "[parameters('location')]",
    "properties": {
      "isHnsEnabled": true,
      "isLocalUserEnabled": true,
      "isSftpEnabled": true,
      "allowCrossTenantReplication": true
    },
    "dependsOn": [],
    "tags": {},
    "sku": {
      "name": "[parameters('storageAccountType')]"
    },
    "kind": "StorageV2",
    "_raw": {
      "type": "Microsoft.Storage/storageAccounts",
      "apiVersion": "2023-05-01",
      "name": "[parameters('storageAccountName')]",
      "location": "[parameters('location')]",
      "sku": {
        "name": "[parameters('storageAccountType')]"
      },
      "kind": "StorageV2",
      "properties": {
        "isHnsEnabled": true,
        "isLocalUserEnabled": true,
        "isSftpEnabled": true,
        "allowCrossTenantReplication": true
      }
    },
    "_metadata": {
      "source_template": "templates/azure-quickstart-templates/quickstarts/microsoft.storage/storage-sftp/main.bicep",
      "is_mutated": true,
      "mutation_id": "storage_cross_tenant_replication",
      "mutation_description": "Allow cross-tenant replication",
      "mutation_severity": "low"
    },
    "_mutation_applied": [
      {
        "mutation_id": "storage_cross_tenant_replication",
        "labels": [
          "Storage_CrossTenantReplication"
        ],
        "severity": "low"
      }
    ]
  },
  {
    "id": "/subscriptions/template-sim/resourceGroups/template-rg/providers/Microsoft.Storage/storageAccounts/[parameters('storageAccountName')]",
    "type": "Microsoft.Storage/storageAccounts",
    "apiVersion": "2023-01-01",
    "name": "[parameters('storageAccountName')]",
    "location": "[parameters('location')]",
    "properties": {
      "accessTier": "Hot",
      "allowBlobPublicAccess": true
    },
    "dependsOn": [],
    "tags": {},
    "sku": {
      "name": "Standard_LRS"
    },
    "kind": "StorageV2",
    "_raw": {
      "type": "Microsoft.Storage/storageAccounts",
      "apiVersion": "2023-01-01",
      "name": "[parameters('storageAccountName')]",
      "location": "[parameters('location')]",
      "sku": {
        "name": "Standard_LRS"
      },
      "kind": "StorageV2",
      "properties": {
        "accessTier": "Hot",
        "allowBlobPublicAccess": true
      }
    },
    "_metadata": {
      "source_template": "templates/azure-quickstart-templates/quickstarts/microsoft.storage/storage-multi-blob-container/main.bicep",
      "is_mutated": true,
      "mutation_id": "storage_public_blob_access",
      "mutation_description": "Enable public blob access on storage account",
      "mutation_severity": "high"
    },
    "_mutation_applied": [
      {
        "mutation_id": "storage_public_blob_access",
        "labels": [
          "Storage_PublicAccess",
          "CIS_3.7"
        ],
        "severity": "high"
      }
    ]
  },
  {
    "id": "/subscriptions/template-sim/resourceGroups/template-rg/providers/Microsoft.Storage/storageAccounts/[parameters('storageAccountName')]",
    "type": "Microsoft.Storage/storageAccounts",
    "apiVersion": "2023-01-01",
    "name": "[parameters('storageAccountName')]",
    "location": "[parameters('location')]",
    "properties": {
      "accessTier": "Hot",
      "minimumTlsVersion": "TLS1_0"
    },
    "dependsOn": [],
    "tags": {},
    "sku": {
      "name": "Standard_LRS"
    },
    "kind": "StorageV2",
    "_raw": {
      "type": "Microsoft.Storage/storageAccounts",
      "apiVersion": "2023-01-01",
      "name": "[parameters('storageAccountName')]",
      "location": "[parameters('location')]",
      "sku": {
        "name": "Standard_LRS"
      },
      "kind": "StorageV2",
      "properties": {
        "accessTier": "Hot",
        "minimumTlsVersion": "TLS1_0"
      }
    },
    "_metadata": {
      "source_template": "templates/azure-quickstart-templates/quickstarts/microsoft.storage/storage-multi-blob-container/main.bicep",
      "is_mutated": true,
      "mutation_id": "storage_weak_tls",
      "mutation_description": "Set minimum TLS version to 1.0 (weak)",
      "mutation_severity": "medium"
    },
    "_mutation_applied": [
      {
        "mutation_id": "storage_weak_tls",
        "labels": [
          "Storage_WeakTLS",
          "CIS_3.8"
        ],
        "severity": "medium"
      }
    ]
  },
  {
    "id": "/subscriptions/template-sim/resourceGroups/template-rg/providers/Microsoft.Storage/storageAccounts/[parameters('storageAccountName')]",
    "type": "Microsoft.Storage/storageAccounts",
    "apiVersion": "2023-01-01",
    "name": "[parameters('storageAccountName')]",
    "location": "[parameters('location')]",
    "properties": {
      "accessTier": "Hot",
      "supportsHttpsTrafficOnly": false
    },
    "dependsOn": [],
    "tags": {},
    "sku": {
      "name": "Standard_LRS"
    },
    "kind": "StorageV2",
    "_raw": {
      "type": "Microsoft.Storage/storageAccounts",
      "apiVersion": "2023-01-01",
      "name": "[parameters('storageAccountName')]",
      "location": "[parameters('location')]",
      "sku": {
        "name": "Standard_LRS"
      },
      "kind": "StorageV2",
      "properties": {
        "accessTier": "Hot",
        "supportsHttpsTrafficOnly": false
      }
    },
    "_metadata": {
      "source_template": "templates/azure-quickstart-templates/quickstarts/microsoft.storage/storage-multi-blob-container/main.bicep",
      "is_mutated": true,
      "mutation_id": "storage_http_allowed",
      "mutation_description": "Allow HTTP traffic (not HTTPS-only)",
      "mutation_severity": "high"
    },
    "_mutation_applied": [
      {
        "mutation_id": "storage_http_allowed",
        "labels": [
          "Storage_HTTPAllowed",
          "CIS_3.1"
        ],
        "severity": "high"
      }
    ]
  },
  {
    "id": "/subscriptions/template-sim/resourceGroups/template-rg/providers/Microsoft.Storage/storageAccounts/[parameters('storageAccountName')]",
    "type": "Microsoft.Storage/storageAccounts",
    "apiVersion": "2023-01-01",
    "name": "[parameters('storageAccountName')]",
    "location": "[parameters('location')]",
    "properties": {
      "accessTier": "Hot",
      "networkAcls": {
        "defaultAction": "Allow"
      }
    },
    "dependsOn": [],
    "tags": {},
    "sku": {
      "name": "Standard_LRS"
    },
    "kind": "StorageV2",
    "_raw": {
      "type": "Microsoft.Storage/storageAccounts",
      "apiVersion": "2023-01-01",
      "name": "[parameters('storageAccountName')]",
      "location": "[parameters('location')]",
      "sku": {
        "name": "Standard_LRS"
      },
      "kind": "StorageV2",
      "properties": {
        "accessTier": "Hot",
        "networkAcls": {
          "defaultAction": "Allow"
        }
      }
    },
    "_metadata": {
      "source_template": "templates/azure-quickstart-templates/quickstarts/microsoft.storage/storage-multi-blob-container/main.bicep",
      "is_mutated": true,
      "mutation_id": "storage_open_firewall",
      "mutation_description": "Set firewall to allow all network traffic",
      "mutation_severity": "high"
    },
    "_mutation_applied": [
      {
        "mutation_id": "storage_open_firewall",
        "labels": [
          "Storage_FirewallOpen",
          "CIS_3.6"
        ],
        "severity": "high"
      }
    ]
  },
  {
    "id": "/subscriptions/template-sim/resourceGroups/template-rg/providers/Microsoft.Storage/storageAccounts/[parameters('storageAccountName')]",
    "type": "Microsoft.Storage/storageAccounts",
    "apiVersion": "2023-01-01",
    "name": "[parameters('storageAccountName')]",
    "location": "[parameters('location')]",
    "properties": {
      "accessTier": "Hot",
      "supportsHttpsTrafficOnly": false
    },
    "dependsOn": [],
    "tags": {},
    "sku": {
      "name": "Standard_LRS"
    },
    "kind": "StorageV2",
    "_raw": {
      "type": "Microsoft.Storage/storageAccounts",
      "apiVersion": "2023-01-01",
      "name": "[parameters('storageAccountName')]",
      "location": "[parameters('location')]",
      "sku": {
        "name": "Standard_LRS"
      },
      "kind": "StorageV2",
      "properties": {
        "accessTier": "Hot",
        "supportsHttpsTrafficOnly": false
      }
    },
    "_metadata": {
      "source_template": "templates/azure-quickstart-templates/quickstarts/microsoft.storage/storage-multi-blob-container/main.bicep",
      "is_mutated": true,
      "mutation_id": "storage_insecure_transfer",
      "mutation_description": "Disable secure transfer requirement",
      "mutation_severity": "critical"
    },
    "_mutation_applied": [
      {
        "mutation_id": "storage_insecure_transfer",
        "labels": [
          "Storage_InsecureTransfer",
          "CIS_3.1"
        ],
        "severity": "critical"
      }
    ]
  },
  {
    "id": "/subscriptions/template-sim/resourceGroups/template-rg/providers/Microsoft.Storage/storageAccounts/[parameters('storageAccountName')]",
    "type": "Microsoft.Storage/storageAccounts",
    "apiVersion": "2023-01-01",
    "name": "[parameters('storageAccountName')]",
    "location": "[parameters('location')]",
    "properties": {
      "accessTier": "Hot",
      "isVersioningEnabled": false
    },
    "dependsOn": [],
    "tags": {},
    "sku": {
      "name": "Standard_LRS"
    },
    "kind": "StorageV2",
    "_raw": {
      "type": "Microsoft.Storage/storageAccounts",
      "apiVersion": "2023-01-01",
      "name": "[parameters('storageAccountName')]",
      "location": "[parameters('location')]",
      "sku": {
        "name": "Standard_LRS"
      },
      "kind": "StorageV2",
      "properties": {
        "accessTier": "Hot",
        "isVersioningEnabled": false
      }
    },
    "_metadata": {
      "source_template": "templates/azure-quickstart-templates/quickstarts/microsoft.storage/storage-multi-blob-container/main.bicep",
      "is_mutated": true,
      "mutation_id": "storage_no_blob_versioning",
      "mutation_description": "Disable blob versioning",
      "mutation_severity": "low"
    },
    "_mutation_applied": [
      {
        "mutation_id": "storage_no_blob_versioning",
        "labels": [
          "Storage_NoVersioning"
        ],
        "severity": "low"
      }
    ]
  },
  {
    "id": "/subscriptions/template-sim/resourceGroups/template-rg/providers/Microsoft.Storage/storageAccounts/[parameters('storageAccountName')]",
    "type": "Microsoft.Storage/storageAccounts",
    "apiVersion": "2023-01-01",
    "name": "[parameters('storageAccountName')]",
    "location": "[parameters('location')]",
    "properties": {
      "accessTier": "Hot",
      "deleteRetentionPolicy": {
        "enabled": false
      }
    },
    "dependsOn": [],
    "tags": {},
    "sku": {
      "name": "Standard_LRS"
    },
    "kind": "StorageV2",
    "_raw": {
      "type": "Microsoft.Storage/storageAccounts",
      "apiVersion": "2023-01-01",
      "name": "[parameters('storageAccountName')]",
      "location": "[parameters('location')]",
      "sku": {
        "name": "Standard_LRS"
      },
      "kind": "StorageV2",
      "properties": {
        "accessTier": "Hot",
        "deleteRetentionPolicy": {
          "enabled": false
        }
      }
    },
    "_metadata": {
      "source_template": "templates/azure-quickstart-templates/quickstarts/microsoft.storage/storage-multi-blob-container/main.bicep",
      "is_mutated": true,
      "mutation_id": "storage_no_soft_delete",
      "mutation_description": "Disable blob soft delete",
      "mutation_severity": "medium"
    },
    "_mutation_applied": [
      {
        "mutation_id": "storage_no_soft_delete",
        "labels": [
          "Storage_NoSoftDelete",
          "CIS_3.10"
        ],
        "severity": "medium"
      }
    ]
  },
  {
    "id": "/subscriptions/template-sim/resourceGroups/template-rg/providers/Microsoft.Storage/storageAccounts/[parameters('storageAccountName')]",
    "type": "Microsoft.Storage/storageAccounts",
    "apiVersion": "2023-01-01",
    "name": "[parameters('storageAccountName')]",
    "location": "[parameters('location')]",
    "properties": {
      "accessTier": "Hot",
      "allowSharedKeyAccess": true
    },
    "dependsOn": [],
    "tags": {},
    "sku": {
      "name": "Standard_LRS"
    },
    "kind": "StorageV2",
    "_raw": {
      "type": "Microsoft.Storage/storageAccounts",
      "apiVersion": "2023-01-01",
      "name": "[parameters('storageAccountName')]",
      "location": "[parameters('location')]",
      "sku": {
        "name": "Standard_LRS"
      },
      "kind": "StorageV2",
      "properties": {
        "accessTier": "Hot",
        "allowSharedKeyAccess": true
      }
    },
    "_metadata": {
      "source_template": "templates/azure-quickstart-templates/quickstarts/microsoft.storage/storage-multi-blob-container/main.bicep",
      "is_mutated": true,
      "mutation_id": "storage_allow_shared_key",
      "mutation_description": "Allow shared key access (not just Azure AD)",
      "mutation_severity": "medium"
    },
    "_mutation_applied": [
      {
        "mutation_id": "storage_allow_shared_key",
        "labels": [
          "Storage_SharedKeyAccess"
        ],
        "severity": "medium"
      }
    ]
  },
  {
    "id": "/subscriptions/template-sim/resourceGroups/template-rg/providers/Microsoft.Storage/storageAccounts/[parameters('storageAccountName')]",
    "type": "Microsoft.Storage/storageAccounts",
    "apiVersion": "2023-01-01",
    "name": "[parameters('storageAccountName')]",
    "location": "[parameters('location')]",
    "properties": {
      "accessTier": "Hot",
      "encryption": {
        "requireInfrastructureEncryption": false
      }
    },
    "dependsOn": [],
    "tags": {},
    "sku": {
      "name": "Standard_LRS"
    },
    "kind": "StorageV2",
    "_raw": {
      "type": "Microsoft.Storage/storageAccounts",
      "apiVersion": "2023-01-01",
      "name": "[parameters('storageAccountName')]",
      "location": "[parameters('location')]",
      "sku": {
        "name": "Standard_LRS"
      },
      "kind": "StorageV2",
      "properties": {
        "accessTier": "Hot",
        "encryption": {
          "requireInfrastructureEncryption": false
        }
      }
    },
    "_metadata": {
      "source_template": "templates/azure-quickstart-templates/quickstarts/microsoft.storage/storage-multi-blob-container/main.bicep",
      "is_mutated": true,
      "mutation_id": "storage_no_infrastructure_encryption",
      "mutation_description": "Disable infrastructure encryption",
      "mutation_severity": "medium"
    },
    "_mutation_applied": [
      {
        "mutation_id": "storage_no_infrastructure_encryption",
        "labels": [
          "Storage_NoInfraEncryption"
        ],
        "severity": "medium"
      }
    ]
  },
  {
    "id": "/subscriptions/template-sim/resourceGroups/template-rg/providers/Microsoft.Storage/storageAccounts/[parameters('storageAccountName')]",
    "type": "Microsoft.Storage/storageAccounts",
    "apiVersion": "2023-01-01",
    "name": "[parameters('storageAccountName')]",
    "location": "[parameters('location')]",
    "properties": {
      "accessTier": "Hot",
      "allowCrossTenantReplication": true
    },
    "dependsOn": [],
    "tags": {},
    "sku": {
      "name": "Standard_LRS"
    },
    "kind": "StorageV2",
    "_raw": {
      "type": "Microsoft.Storage/storageAccounts",
      "apiVersion": "2023-01-01",
      "name": "[parameters('storageAccountName')]",
      "location": "[parameters('location')]",
      "sku": {
        "name": "Standard_LRS"
      },
      "kind": "StorageV2",
      "properties": {
        "accessTier": "Hot",
        "allowCrossTenantReplication": true
      }
    },
    "_metadata": {
      "source_template": "templates/azure-quickstart-templates/quickstarts/microsoft.storage/storage-multi-blob-container/main.bicep",
      "is_mutated": true,
      "mutation_id": "storage_cross_tenant_replication",
      "mutation_description": "Allow cross-tenant replication",
      "mutation_severity": "low"
    },
    "_mutation_applied": [
      {
        "mutation_id": "storage_cross_tenant_replication",
        "labels": [
          "Storage_CrossTenantReplication"
        ],
        "severity": "low"
      }
    ]
  },
  {
    "id": "/subscriptions/template-sim/resourceGroups/template-rg/providers/Microsoft.Storage/storageAccounts/[parameters('storageAccountName')]",
    "type": "Microsoft.Storage/storageAccounts",
    "apiVersion": "2023-01-01",
    "name": "[parameters('storageAccountName')]",
    "location": "[parameters('location')]",
    "properties": {
      "accessTier": "Hot",
      "allowBlobPublicAccess": true
    },
    "dependsOn": [],
    "tags": {},
    "sku": {
      "name": "Standard_LRS"
    },
    "kind": "StorageV2",
    "_raw": {
      "type": "Microsoft.Storage/storageAccounts",
      "apiVersion": "2023-01-01",
      "name": "[parameters('storageAccountName')]",
      "location": "[parameters('location')]",
      "sku": {
        "name": "Standard_LRS"
      },
      "kind": "StorageV2",
      "properties": {
        "accessTier": "Hot",
        "allowBlobPublicAccess": true
      }
    },
    "_metadata": {
      "source_template": "templates/azure-quickstart-templates/quickstarts/microsoft.storage/storage-blob-container/main.bicep",
      "is_mutated": true,
      "mutation_id": "storage_public_blob_access",
      "mutation_description": "Enable public blob access on storage account",
      "mutation_severity": "high"
    },
    "_mutation_applied": [
      {
        "mutation_id": "storage_public_blob_access",
        "labels": [
          "Storage_PublicAccess",
          "CIS_3.7"
        ],
        "severity": "high"
      }
    ]
  },
  {
    "id": "/subscriptions/template-sim/resourceGroups/template-rg/providers/Microsoft.Storage/storageAccounts/[parameters('storageAccountName')]",
    "type": "Microsoft.Storage/storageAccounts",
    "apiVersion": "2023-01-01",
    "name": "[parameters('storageAccountName')]",
    "location": "[parameters('location')]",
    "properties": {
      "accessTier": "Hot",
      "minimumTlsVersion": "TLS1_0"
    },
    "dependsOn": [],
    "tags": {},
    "sku": {
      "name": "Standard_LRS"
    },
    "kind": "StorageV2",
    "_raw": {
      "type": "Microsoft.Storage/storageAccounts",
      "apiVersion": "2023-01-01",
      "name": "[parameters('storageAccountName')]",
      "location": "[parameters('location')]",
      "sku": {
        "name": "Standard_LRS"
      },
      "kind": "StorageV2",
      "properties": {
        "accessTier": "Hot",
        "minimumTlsVersion": "TLS1_0"
      }
    },
    "_metadata": {
      "source_template": "templates/azure-quickstart-templates/quickstarts/microsoft.storage/storage-blob-container/main.bicep",
      "is_mutated": true,
      "mutation_id": "storage_weak_tls",
      "mutation_description": "Set minimum TLS version to 1.0 (weak)",
      "mutation_severity": "medium"
    },
    "_mutation_applied": [
      {
        "mutation_id": "storage_weak_tls",
        "labels": [
          "Storage_WeakTLS",
          "CIS_3.8"
        ],
        "severity": "medium"
      }
    ]
  },
  {
    "id": "/subscriptions/template-sim/resourceGroups/template-rg/providers/Microsoft.Storage/storageAccounts/[parameters('storageAccountName')]",
    "type": "Microsoft.Storage/storageAccounts",
    "apiVersion": "2023-01-01",
    "name": "[parameters('storageAccountName')]",
    "location": "[parameters('location')]",
    "properties": {
      "accessTier": "Hot",
      "supportsHttpsTrafficOnly": false
    },
    "dependsOn": [],
    "tags": {},
    "sku": {
      "name": "Standard_LRS"
    },
    "kind": "StorageV2",
    "_raw": {
      "type": "Microsoft.Storage/storageAccounts",
      "apiVersion": "2023-01-01",
      "name": "[parameters('storageAccountName')]",
      "location": "[parameters('location')]",
      "sku": {
        "name": "Standard_LRS"
      },
      "kind": "StorageV2",
      "properties": {
        "accessTier": "Hot",
        "supportsHttpsTrafficOnly": false
      }
    },
    "_metadata": {
      "source_template": "templates/azure-quickstart-templates/quickstarts/microsoft.storage/storage-blob-container/main.bicep",
      "is_mutated": true,
      "mutation_id": "storage_http_allowed",
      "mutation_description": "Allow HTTP traffic (not HTTPS-only)",
      "mutation_severity": "high"
    },
    "_mutation_applied": [
      {
        "mutation_id": "storage_http_allowed",
        "labels": [
          "Storage_HTTPAllowed",
          "CIS_3.1"
        ],
        "severity": "high"
      }
    ]
  },
  {
    "id": "/subscriptions/template-sim/resourceGroups/template-rg/providers/Microsoft.Storage/storageAccounts/[parameters('storageAccountName')]",
    "type": "Microsoft.Storage/storageAccounts",
    "apiVersion": "2023-01-01",
    "name": "[parameters('storageAccountName')]",
    "location": "[parameters('location')]",
    "properties": {
      "accessTier": "Hot",
      "networkAcls": {
        "defaultAction": "Allow"
      }
    },
    "dependsOn": [],
    "tags": {},
    "sku": {
      "name": "Standard_LRS"
    },
    "kind": "StorageV2",
    "_raw": {
      "type": "Microsoft.Storage/storageAccounts",
      "apiVersion": "2023-01-01",
      "name": "[parameters('storageAccountName')]",
      "location": "[parameters('location')]",
      "sku": {
        "name": "Standard_LRS"
      },
      "kind": "StorageV2",
      "properties": {
        "accessTier": "Hot",
        "networkAcls": {
          "defaultAction": "Allow"
        }
      }
    },
    "_metadata": {
      "source_template": "templates/azure-quickstart-templates/quickstarts/microsoft.storage/storage-blob-container/main.bicep",
      "is_mutated": true,
      "mutation_id": "storage_open_firewall",
      "mutation_description": "Set firewall to allow all network traffic",
      "mutation_severity": "high"
    },
    "_mutation_applied": [
      {
        "mutation_id": "storage_open_firewall",
        "labels": [
          "Storage_FirewallOpen",
          "CIS_3.6"
        ],
        "severity": "high"
      }
    ]
  },
  {
    "id": "/subscriptions/template-sim/resourceGroups/template-rg/providers/Microsoft.Storage/storageAccounts/[parameters('storageAccountName')]",
    "type": "Microsoft.Storage/storageAccounts",
    "apiVersion": "2023-01-01",
    "name": "[parameters('storageAccountName')]",
    "location": "[parameters('location')]",
    "properties": {
      "accessTier": "Hot",
      "supportsHttpsTrafficOnly": false
    },
    "dependsOn": [],
    "tags": {},
    "sku": {
      "name": "Standard_LRS"
    },
    "kind": "StorageV2",
    "_raw": {
      "type": "Microsoft.Storage/storageAccounts",
      "apiVersion": "2023-01-01",
      "name": "[parameters('storageAccountName')]",
      "location": "[parameters('location')]",
      "sku": {
        "name": "Standard_LRS"
      },
      "kind": "StorageV2",
      "properties": {
        "accessTier": "Hot",
        "supportsHttpsTrafficOnly": false
      }
    },
    "_metadata": {
      "source_template": "templates/azure-quickstart-templates/quickstarts/microsoft.storage/storage-blob-container/main.bicep",
      "is_mutated": true,
      "mutation_id": "storage_insecure_transfer",
      "mutation_description": "Disable secure transfer requirement",
      "mutation_severity": "critical"
    },
    "_mutation_applied": [
      {
        "mutation_id": "storage_insecure_transfer",
        "labels": [
          "Storage_InsecureTransfer",
          "CIS_3.1"
        ],
        "severity": "critical"
      }
    ]
  },
  {
    "id": "/subscriptions/template-sim/resourceGroups/template-rg/providers/Microsoft.Storage/storageAccounts/[parameters('storageAccountName')]",
    "type": "Microsoft.Storage/storageAccounts",
    "apiVersion": "2023-01-01",
    "name": "[parameters('storageAccountName')]",
    "location": "[parameters('location')]",
    "properties": {
      "accessTier": "Hot",
      "isVersioningEnabled": false
    },
    "dependsOn": [],
    "tags": {},
    "sku": {
      "name": "Standard_LRS"
    },
    "kind": "StorageV2",
    "_raw": {
      "type": "Microsoft.Storage/storageAccounts",
      "apiVersion": "2023-01-01",
      "name": "[parameters('storageAccountName')]",
      "location": "[parameters('location')]",
      "sku": {
        "name": "Standard_LRS"
      },
      "kind": "StorageV2",
      "properties": {
        "accessTier": "Hot",
        "isVersioningEnabled": false
      }
    },
    "_metadata": {
      "source_template": "templates/azure-quickstart-templates/quickstarts/microsoft.storage/storage-blob-container/main.bicep",
      "is_mutated": true,
      "mutation_id": "storage_no_blob_versioning",
      "mutation_description": "Disable blob versioning",
      "mutation_severity": "low"
    },
    "_mutation_applied": [
      {
        "mutation_id": "storage_no_blob_versioning",
        "labels": [
          "Storage_NoVersioning"
        ],
        "severity": "low"
      }
    ]
  },
  {
    "id": "/subscriptions/template-sim/resourceGroups/template-rg/providers/Microsoft.Storage/storageAccounts/[parameters('storageAccountName')]",
    "type": "Microsoft.Storage/storageAccounts",
    "apiVersion": "2023-01-01",
    "name": "[parameters('storageAccountName')]",
    "location": "[parameters('location')]",
    "properties": {
      "accessTier": "Hot",
      "deleteRetentionPolicy": {
        "enabled": false
      }
    },
    "dependsOn": [],
    "tags": {},
    "sku": {
      "name": "Standard_LRS"
    },
    "kind": "StorageV2",
    "_raw": {
      "type": "Microsoft.Storage/storageAccounts",
      "apiVersion": "2023-01-01",
      "name": "[parameters('storageAccountName')]",
      "location": "[parameters('location')]",
      "sku": {
        "name": "Standard_LRS"
      },
      "kind": "StorageV2",
      "properties": {
        "accessTier": "Hot",
        "deleteRetentionPolicy": {
          "enabled": false
        }
      }
    },
    "_metadata": {
      "source_template": "templates/azure-quickstart-templates/quickstarts/microsoft.storage/storage-blob-container/main.bicep",
      "is_mutated": true,
      "mutation_id": "storage_no_soft_delete",
      "mutation_description": "Disable blob soft delete",
      "mutation_severity": "medium"
    },
    "_mutation_applied": [
      {
        "mutation_id": "storage_no_soft_delete",
        "labels": [
          "Storage_NoSoftDelete",
          "CIS_3.10"
        ],
        "severity": "medium"
      }
    ]
  },
  {
    "id": "/subscriptions/template-sim/resourceGroups/template-rg/providers/Microsoft.Storage/storageAccounts/[parameters('storageAccountName')]",
    "type": "Microsoft.Storage/storageAccounts",
    "apiVersion": "2023-01-01",
    "name": "[parameters('storageAccountName')]",
    "location": "[parameters('location')]",
    "properties": {
      "accessTier": "Hot",
      "allowSharedKeyAccess": true
    },
    "dependsOn": [],
    "tags": {},
    "sku": {
      "name": "Standard_LRS"
    },
    "kind": "StorageV2",
    "_raw": {
      "type": "Microsoft.Storage/storageAccounts",
      "apiVersion": "2023-01-01",
      "name": "[parameters('storageAccountName')]",
      "location": "[parameters('location')]",
      "sku": {
        "name": "Standard_LRS"
      },
      "kind": "StorageV2",
      "properties": {
        "accessTier": "Hot",
        "allowSharedKeyAccess": true
      }
    },
    "_metadata": {
      "source_template": "templates/azure-quickstart-templates/quickstarts/microsoft.storage/storage-blob-container/main.bicep",
      "is_mutated": true,
      "mutation_id": "storage_allow_shared_key",
      "mutation_description": "Allow shared key access (not just Azure AD)",
      "mutation_severity": "medium"
    },
    "_mutation_applied": [
      {
        "mutation_id": "storage_allow_shared_key",
        "labels": [
          "Storage_SharedKeyAccess"
        ],
        "severity": "medium"
      }
    ]
  },
  {
    "id": "/subscriptions/template-sim/resourceGroups/template-rg/providers/Microsoft.Storage/storageAccounts/[parameters('storageAccountName')]",
    "type": "Microsoft.Storage/storageAccounts",
    "apiVersion": "2023-01-01",
    "name": "[parameters('storageAccountName')]",
    "location": "[parameters('location')]",
    "properties": {
      "accessTier": "Hot",
      "encryption": {
        "requireInfrastructureEncryption": false
      }
    },
    "dependsOn": [],
    "tags": {},
    "sku": {
      "name": "Standard_LRS"
    },
    "kind": "StorageV2",
    "_raw": {
      "type": "Microsoft.Storage/storageAccounts",
      "apiVersion": "2023-01-01",
      "name": "[parameters('storageAccountName')]",
      "location": "[parameters('location')]",
      "sku": {
        "name": "Standard_LRS"
      },
      "kind": "StorageV2",
      "properties": {
        "accessTier": "Hot",
        "encryption": {
          "requireInfrastructureEncryption": false
        }
      }
    },
    "_metadata": {
      "source_template": "templates/azure-quickstart-templates/quickstarts/microsoft.storage/storage-blob-container/main.bicep",
      "is_mutated": true,
      "mutation_id": "storage_no_infrastructure_encryption",
      "mutation_description": "Disable infrastructure encryption",
      "mutation_severity": "medium"
    },
    "_mutation_applied": [
      {
        "mutation_id": "storage_no_infrastructure_encryption",
        "labels": [
          "Storage_NoInfraEncryption"
        ],
        "severity": "medium"
      }
    ]
  },
  {
    "id": "/subscriptions/template-sim/resourceGroups/template-rg/providers/Microsoft.Storage/storageAccounts/[parameters('storageAccountName')]",
    "type": "Microsoft.Storage/storageAccounts",
    "apiVersion": "2023-01-01",
    "name": "[parameters('storageAccountName')]",
    "location": "[parameters('location')]",
    "properties": {
      "accessTier": "Hot",
      "allowCrossTenantReplication": true
    },
    "dependsOn": [],
    "tags": {},
    "sku": {
      "name": "Standard_LRS"
    },
    "kind": "StorageV2",
    "_raw": {
      "type": "Microsoft.Storage/storageAccounts",
      "apiVersion": "2023-01-01",
      "name": "[parameters('storageAccountName')]",
      "location": "[parameters('location')]",
      "sku": {
        "name": "Standard_LRS"
      },
      "kind": "StorageV2",
      "properties": {
        "accessTier": "Hot",
        "allowCrossTenantReplication": true
      }
    },
    "_metadata": {
      "source_template": "templates/azure-quickstart-templates/quickstarts/microsoft.storage/storage-blob-container/main.bicep",
      "is_mutated": true,
      "mutation_id": "storage_cross_tenant_replication",
      "mutation_description": "Allow cross-tenant replication",
      "mutation_severity": "low"
    },
    "_mutation_applied": [
      {
        "mutation_id": "storage_cross_tenant_replication",
        "labels": [
          "Storage_CrossTenantReplication"
        ],
        "severity": "low"
      }
    ]
  },
  {
    "id": "/subscriptions/template-sim/resourceGroups/template-rg/providers/Microsoft.Storage/storageAccounts/[parameters('storageAccountName')]",
    "type": "Microsoft.Storage/storageAccounts",
    "apiVersion": "2021-04-01",
    "name": "[parameters('storageAccountName')]",
    "location": "[parameters('location')]",
    "properties": {
      "encryption": {
        "keySource": "Microsoft.Storage",
        "services": {
          "blob": {
            "enabled": "[parameters('blobEncryptionEnabled')]"
          }
        }
      },
      "allowBlobPublicAccess": true
    },
    "dependsOn": [],
    "tags": {},
    "sku": {
      "name": "[parameters('storageAccountType')]"
    },
    "kind": "Storage",
    "_raw": {
      "type": "Microsoft.Storage/storageAccounts",
      "apiVersion": "2021-04-01",
      "name": "[parameters('storageAccountName')]",
      "location": "[parameters('location')]",
      "sku": {
        "name": "[parameters('storageAccountType')]"
      },
      "kind": "Storage",
      "properties": {
        "encryption": {
          "keySource": "Microsoft.Storage",
          "services": {
            "blob": {
              "enabled": "[parameters('blobEncryptionEnabled')]"
            }
          }
        },
        "allowBlobPublicAccess": true
      }
    },
    "_metadata": {
      "source_template": "templates/azure-quickstart-templates/quickstarts/microsoft.storage/storage-account-service-encryption-create/main.bicep",
      "is_mutated": true,
      "mutation_id": "storage_public_blob_access",
      "mutation_description": "Enable public blob access on storage account",
      "mutation_severity": "high"
    },
    "_mutation_applied": [
      {
        "mutation_id": "storage_public_blob_access",
        "labels": [
          "Storage_PublicAccess",
          "CIS_3.7"
        ],
        "severity": "high"
      }
    ]
  },
  {
    "id": "/subscriptions/template-sim/resourceGroups/template-rg/providers/Microsoft.Storage/storageAccounts/[parameters('storageAccountName')]",
    "type": "Microsoft.Storage/storageAccounts",
    "apiVersion": "2021-04-01",
    "name": "[parameters('storageAccountName')]",
    "location": "[parameters('location')]",
    "properties": {
      "encryption": {
        "keySource": "Microsoft.Storage",
        "services": {
          "blob": {
            "enabled": "[parameters('blobEncryptionEnabled')]"
          }
        }
      },
      "minimumTlsVersion": "TLS1_0"
    },
    "dependsOn": [],
    "tags": {},
    "sku": {
      "name": "[parameters('storageAccountType')]"
    },
    "kind": "Storage",
    "_raw": {
      "type": "Microsoft.Storage/storageAccounts",
      "apiVersion": "2021-04-01",
      "name": "[parameters('storageAccountName')]",
      "location": "[parameters('location')]",
      "sku": {
        "name": "[parameters('storageAccountType')]"
      },
      "kind": "Storage",
      "properties": {
        "encryption": {
          "keySource": "Microsoft.Storage",
          "services": {
            "blob": {
              "enabled": "[parameters('blobEncryptionEnabled')]"
            }
          }
        },
        "minimumTlsVersion": "TLS1_0"
      }
    },
    "_metadata": {
      "source_template": "templates/azure-quickstart-templates/quickstarts/microsoft.storage/storage-account-service-encryption-create/main.bicep",
      "is_mutated": true,
      "mutation_id": "storage_weak_tls",
      "mutation_description": "Set minimum TLS version to 1.0 (weak)",
      "mutation_severity": "medium"
    },
    "_mutation_applied": [
      {
        "mutation_id": "storage_weak_tls",
        "labels": [
          "Storage_WeakTLS",
          "CIS_3.8"
        ],
        "severity": "medium"
      }
    ]
  },
  {
    "id": "/subscriptions/template-sim/resourceGroups/template-rg/providers/Microsoft.Storage/storageAccounts/[parameters('storageAccountName')]",
    "type": "Microsoft.Storage/storageAccounts",
    "apiVersion": "2021-04-01",
    "name": "[parameters('storageAccountName')]",
    "location": "[parameters('location')]",
    "properties": {
      "encryption": {
        "keySource": "Microsoft.Storage",
        "services": {
          "blob": {
            "enabled": "[parameters('blobEncryptionEnabled')]"
          }
        }
      },
      "supportsHttpsTrafficOnly": false
    },
    "dependsOn": [],
    "tags": {},
    "sku": {
      "name": "[parameters('storageAccountType')]"
    },
    "kind": "Storage",
    "_raw": {
      "type": "Microsoft.Storage/storageAccounts",
      "apiVersion": "2021-04-01",
      "name": "[parameters('storageAccountName')]",
      "location": "[parameters('location')]",
      "sku": {
        "name": "[parameters('storageAccountType')]"
      },
      "kind": "Storage",
      "properties": {
        "encryption": {
          "keySource": "Microsoft.Storage",
          "services": {
            "blob": {
              "enabled": "[parameters('blobEncryptionEnabled')]"
            }
          }
        },
        "supportsHttpsTrafficOnly": false
      }
    },
    "_metadata": {
      "source_template": "templates/azure-quickstart-templates/quickstarts/microsoft.storage/storage-account-service-encryption-create/main.bicep",
      "is_mutated": true,
      "mutation_id": "storage_http_allowed",
      "mutation_description": "Allow HTTP traffic (not HTTPS-only)",
      "mutation_severity": "high"
    },
    "_mutation_applied": [
      {
        "mutation_id": "storage_http_allowed",
        "labels": [
          "Storage_HTTPAllowed",
          "CIS_3.1"
        ],
        "severity": "high"
      }
    ]
  },
  {
    "id": "/subscriptions/template-sim/resourceGroups/template-rg/providers/Microsoft.Storage/storageAccounts/[parameters('storageAccountName')]",
    "type": "Microsoft.Storage/storageAccounts",
    "apiVersion": "2021-04-01",
    "name": "[parameters('storageAccountName')]",
    "location": "[parameters('location')]",
    "properties": {
      "encryption": {
        "keySource": "Microsoft.Storage",
        "services": {
          "blob": {
            "enabled": "[parameters('blobEncryptionEnabled')]"
          }
        }
      },
      "networkAcls": {
        "defaultAction": "Allow"
      }
    },
    "dependsOn": [],
    "tags": {},
    "sku": {
      "name": "[parameters('storageAccountType')]"
    },
    "kind": "Storage",
    "_raw": {
      "type": "Microsoft.Storage/storageAccounts",
      "apiVersion": "2021-04-01",
      "name": "[parameters('storageAccountName')]",
      "location": "[parameters('location')]",
      "sku": {
        "name": "[parameters('storageAccountType')]"
      },
      "kind": "Storage",
      "properties": {
        "encryption": {
          "keySource": "Microsoft.Storage",
          "services": {
            "blob": {
              "enabled": "[parameters('blobEncryptionEnabled')]"
            }
          }
        },
        "networkAcls": {
          "defaultAction": "Allow"
        }
      }
    },
    "_metadata": {
      "source_template": "templates/azure-quickstart-templates/quickstarts/microsoft.storage/storage-account-service-encryption-create/main.bicep",
      "is_mutated": true,
      "mutation_id": "storage_open_firewall",
      "mutation_description": "Set firewall to allow all network traffic",
      "mutation_severity": "high"
    },
    "_mutation_applied": [
      {
        "mutation_id": "storage_open_firewall",
        "labels": [
          "Storage_FirewallOpen",
          "CIS_3.6"
        ],
        "severity": "high"
      }
    ]
  },
  {
    "id": "/subscriptions/template-sim/resourceGroups/template-rg/providers/Microsoft.Storage/storageAccounts/[parameters('storageAccountName')]",
    "type": "Microsoft.Storage/storageAccounts",
    "apiVersion": "2021-04-01",
    "name": "[parameters('storageAccountName')]",
    "location": "[parameters('location')]",
    "properties": {
      "encryption": {
        "keySource": "Microsoft.Storage",
        "services": {
          "blob": {
            "enabled": "[parameters('blobEncryptionEnabled')]"
          }
        }
      },
      "supportsHttpsTrafficOnly": false
    },
    "dependsOn": [],
    "tags": {},
    "sku": {
      "name": "[parameters('storageAccountType')]"
    },
    "kind": "Storage",
    "_raw": {
      "type": "Microsoft.Storage/storageAccounts",
      "apiVersion": "2021-04-01",
      "name": "[parameters('storageAccountName')]",
      "location": "[parameters('location')]",
      "sku": {
        "name": "[parameters('storageAccountType')]"
      },
      "kind": "Storage",
      "properties": {
        "encryption": {
          "keySource": "Microsoft.Storage",
          "services": {
            "blob": {
              "enabled": "[parameters('blobEncryptionEnabled')]"
            }
          }
        },
        "supportsHttpsTrafficOnly": false
      }
    },
    "_metadata": {
      "source_template": "templates/azure-quickstart-templates/quickstarts/microsoft.storage/storage-account-service-encryption-create/main.bicep",
      "is_mutated": true,
      "mutation_id": "storage_insecure_transfer",
      "mutation_description": "Disable secure transfer requirement",
      "mutation_severity": "critical"
    },
    "_mutation_applied": [
      {
        "mutation_id": "storage_insecure_transfer",
        "labels": [
          "Storage_InsecureTransfer",
          "CIS_3.1"
        ],
        "severity": "critical"
      }
    ]
  },
  {
    "id": "/subscriptions/template-sim/resourceGroups/template-rg/providers/Microsoft.Storage/storageAccounts/[parameters('storageAccountName')]",
    "type": "Microsoft.Storage/storageAccounts",
    "apiVersion": "2021-04-01",
    "name": "[parameters('storageAccountName')]",
    "location": "[parameters('location')]",
    "properties": {
      "encryption": {
        "keySource": "Microsoft.Storage",
        "services": {
          "blob": {
            "enabled": "[parameters('blobEncryptionEnabled')]"
          }
        }
      },
      "isVersioningEnabled": false
    },
    "dependsOn": [],
    "tags": {},
    "sku": {
      "name": "[parameters('storageAccountType')]"
    },
    "kind": "Storage",
    "_raw": {
      "type": "Microsoft.Storage/storageAccounts",
      "apiVersion": "2021-04-01",
      "name": "[parameters('storageAccountName')]",
      "location": "[parameters('location')]",
      "sku": {
        "name": "[parameters('storageAccountType')]"
      },
      "kind": "Storage",
      "properties": {
        "encryption": {
          "keySource": "Microsoft.Storage",
          "services": {
            "blob": {
              "enabled": "[parameters('blobEncryptionEnabled')]"
            }
          }
        },
        "isVersioningEnabled": false
      }
    },
    "_metadata": {
      "source_template": "templates/azure-quickstart-templates/quickstarts/microsoft.storage/storage-account-service-encryption-create/main.bicep",
      "is_mutated": true,
      "mutation_id": "storage_no_blob_versioning",
      "mutation_description": "Disable blob versioning",
      "mutation_severity": "low"
    },
    "_mutation_applied": [
      {
        "mutation_id": "storage_no_blob_versioning",
        "labels": [
          "Storage_NoVersioning"
        ],
        "severity": "low"
      }
    ]
  },
  {
    "id": "/subscriptions/template-sim/resourceGroups/template-rg/providers/Microsoft.Storage/storageAccounts/[parameters('storageAccountName')]",
    "type": "Microsoft.Storage/storageAccounts",
    "apiVersion": "2021-04-01",
    "name": "[parameters('storageAccountName')]",
    "location": "[parameters('location')]",
    "properties": {
      "encryption": {
        "keySource": "Microsoft.Storage",
        "services": {
          "blob": {
            "enabled": "[parameters('blobEncryptionEnabled')]"
          }
        }
      },
      "deleteRetentionPolicy": {
        "enabled": false
      }
    },
    "dependsOn": [],
    "tags": {},
    "sku": {
      "name": "[parameters('storageAccountType')]"
    },
    "kind": "Storage",
    "_raw": {
      "type": "Microsoft.Storage/storageAccounts",
      "apiVersion": "2021-04-01",
      "name": "[parameters('storageAccountName')]",
      "location": "[parameters('location')]",
      "sku": {
        "name": "[parameters('storageAccountType')]"
      },
      "kind": "Storage",
      "properties": {
        "encryption": {
          "keySource": "Microsoft.Storage",
          "services": {
            "blob": {
              "enabled": "[parameters('blobEncryptionEnabled')]"
            }
          }
        },
        "deleteRetentionPolicy": {
          "enabled": false
        }
      }
    },
    "_metadata": {
      "source_template": "templates/azure-quickstart-templates/quickstarts/microsoft.storage/storage-account-service-encryption-create/main.bicep",
      "is_mutated": true,
      "mutation_id": "storage_no_soft_delete",
      "mutation_description": "Disable blob soft delete",
      "mutation_severity": "medium"
    },
    "_mutation_applied": [
      {
        "mutation_id": "storage_no_soft_delete",
        "labels": [
          "Storage_NoSoftDelete",
          "CIS_3.10"
        ],
        "severity": "medium"
      }
    ]
  },
  {
    "id": "/subscriptions/template-sim/resourceGroups/template-rg/providers/Microsoft.Storage/storageAccounts/[parameters('storageAccountName')]",
    "type": "Microsoft.Storage/storageAccounts",
    "apiVersion": "2021-04-01",
    "name": "[parameters('storageAccountName')]",
    "location": "[parameters('location')]",
    "properties": {
      "encryption": {
        "keySource": "Microsoft.Storage",
        "services": {
          "blob": {
            "enabled": "[parameters('blobEncryptionEnabled')]"
          }
        }
      },
      "allowSharedKeyAccess": true
    },
    "dependsOn": [],
    "tags": {},
    "sku": {
      "name": "[parameters('storageAccountType')]"
    },
    "kind": "Storage",
    "_raw": {
      "type": "Microsoft.Storage/storageAccounts",
      "apiVersion": "2021-04-01",
      "name": "[parameters('storageAccountName')]",
      "location": "[parameters('location')]",
      "sku": {
        "name": "[parameters('storageAccountType')]"
      },
      "kind": "Storage",
      "properties": {
        "encryption": {
          "keySource": "Microsoft.Storage",
          "services": {
            "blob": {
              "enabled": "[parameters('blobEncryptionEnabled')]"
            }
          }
        },
        "allowSharedKeyAccess": true
      }
    },
    "_metadata": {
      "source_template": "templates/azure-quickstart-templates/quickstarts/microsoft.storage/storage-account-service-encryption-create/main.bicep",
      "is_mutated": true,
      "mutation_id": "storage_allow_shared_key",
      "mutation_description": "Allow shared key access (not just Azure AD)",
      "mutation_severity": "medium"
    },
    "_mutation_applied": [
      {
        "mutation_id": "storage_allow_shared_key",
        "labels": [
          "Storage_SharedKeyAccess"
        ],
        "severity": "medium"
      }
    ]
  },
  {
    "id": "/subscriptions/template-sim/resourceGroups/template-rg/providers/Microsoft.Storage/storageAccounts/[parameters('storageAccountName')]",
    "type": "Microsoft.Storage/storageAccounts",
    "apiVersion": "2021-04-01",
    "name": "[parameters('storageAccountName')]",
    "location": "[parameters('location')]",
    "properties": {
      "encryption": {
        "keySource": "Microsoft.Storage",
        "services": {
          "blob": {
            "enabled": "[parameters('blobEncryptionEnabled')]"
          }
        },
        "requireInfrastructureEncryption": false
      }
    },
    "dependsOn": [],
    "tags": {},
    "sku": {
      "name": "[parameters('storageAccountType')]"
    },
    "kind": "Storage",
    "_raw": {
      "type": "Microsoft.Storage/storageAccounts",
      "apiVersion": "2021-04-01",
      "name": "[parameters('storageAccountName')]",
      "location": "[parameters('location')]",
      "sku": {
        "name": "[parameters('storageAccountType')]"
      },
      "kind": "Storage",
      "properties": {
        "encryption": {
          "keySource": "Microsoft.Storage",
          "services": {
            "blob": {
              "enabled": "[parameters('blobEncryptionEnabled')]"
            }
          },
          "requireInfrastructureEncryption": false
        }
      }
    },
    "_metadata": {
      "source_template": "templates/azure-quickstart-templates/quickstarts/microsoft.storage/storage-account-service-encryption-create/main.bicep",
      "is_mutated": true,
      "mutation_id": "storage_no_infrastructure_encryption",
      "mutation_description": "Disable infrastructure encryption",
      "mutation_severity": "medium"
    },
    "_mutation_applied": [
      {
        "mutation_id": "storage_no_infrastructure_encryption",
        "labels": [
          "Storage_NoInfraEncryption"
        ],
        "severity": "medium"
      }
    ]
  },
  {
    "id": "/subscriptions/template-sim/resourceGroups/template-rg/providers/Microsoft.Storage/storageAccounts/[parameters('storageAccountName')]",
    "type": "Microsoft.Storage/storageAccounts",
    "apiVersion": "2021-04-01",
    "name": "[parameters('storageAccountName')]",
    "location": "[parameters('location')]",
    "properties": {
      "encryption": {
        "keySource": "Microsoft.Storage",
        "services": {
          "blob": {
            "enabled": "[parameters('blobEncryptionEnabled')]"
          }
        }
      },
      "allowCrossTenantReplication": true
    },
    "dependsOn": [],
    "tags": {},
    "sku": {
      "name": "[parameters('storageAccountType')]"
    },
    "kind": "Storage",
    "_raw": {
      "type": "Microsoft.Storage/storageAccounts",
      "apiVersion": "2021-04-01",
      "name": "[parameters('storageAccountName')]",
      "location": "[parameters('location')]",
      "sku": {
        "name": "[parameters('storageAccountType')]"
      },
      "kind": "Storage",
      "properties": {
        "encryption": {
          "keySource": "Microsoft.Storage",
          "services": {
            "blob": {
              "enabled": "[parameters('blobEncryptionEnabled')]"
            }
          }
        },
        "allowCrossTenantReplication": true
      }
    },
    "_metadata": {
      "source_template": "templates/azure-quickstart-templates/quickstarts/microsoft.storage/storage-account-service-encryption-create/main.bicep",
      "is_mutated": true,
      "mutation_id": "storage_cross_tenant_replication",
      "mutation_description": "Allow cross-tenant replication",
      "mutation_severity": "low"
    },
    "_mutation_applied": [
      {
        "mutation_id": "storage_cross_tenant_replication",
        "labels": [
          "Storage_CrossTenantReplication"
        ],
        "severity": "low"
      }
    ]
  },
  {
    "id": "/subscriptions/template-sim/resourceGroups/template-rg/providers/Microsoft.Storage/storageAccounts/[parameters('storageAccountName')]",
    "type": "Microsoft.Storage/storageAccounts",
    "apiVersion": "2022-09-01",
    "name": "[parameters('storageAccountName')]",
    "location": "[parameters('location')]",
    "properties": {
      "allowBlobPublicAccess": true
    },
    "dependsOn": [],
    "tags": {},
    "sku": {
      "name": "[parameters('storageAccountType')]"
    },
    "kind": "StorageV2",
    "_raw": {
      "type": "Microsoft.Storage/storageAccounts",
      "apiVersion": "2022-09-01",
      "name": "[parameters('storageAccountName')]",
      "location": "[parameters('location')]",
      "sku": {
        "name": "[parameters('storageAccountType')]"
      },
      "kind": "StorageV2",
      "properties": {
        "allowBlobPublicAccess": true
      }
    },
    "_metadata": {
      "source_template": "templates/azure-quickstart-templates/quickstarts/microsoft.storage/storage-account-create/main.bicep",
      "is_mutated": true,
      "mutation_id": "storage_public_blob_access",
      "mutation_description": "Enable public blob access on storage account",
      "mutation_severity": "high"
    },
    "_mutation_applied": [
      {
        "mutation_id": "storage_public_blob_access",
        "labels": [
          "Storage_PublicAccess",
          "CIS_3.7"
        ],
        "severity": "high"
      }
    ]
  },
  {
    "id": "/subscriptions/template-sim/resourceGroups/template-rg/providers/Microsoft.Storage/storageAccounts/[parameters('storageAccountName')]",
    "type": "Microsoft.Storage/storageAccounts",
    "apiVersion": "2022-09-01",
    "name": "[parameters('storageAccountName')]",
    "location": "[parameters('location')]",
    "properties": {
      "minimumTlsVersion": "TLS1_0"
    },
    "dependsOn": [],
    "tags": {},
    "sku": {
      "name": "[parameters('storageAccountType')]"
    },
    "kind": "StorageV2",
    "_raw": {
      "type": "Microsoft.Storage/storageAccounts",
      "apiVersion": "2022-09-01",
      "name": "[parameters('storageAccountName')]",
      "location": "[parameters('location')]",
      "sku": {
        "name": "[parameters('storageAccountType')]"
      },
      "kind": "StorageV2",
      "properties": {
        "minimumTlsVersion": "TLS1_0"
      }
    },
    "_metadata": {
      "source_template": "templates/azure-quickstart-templates/quickstarts/microsoft.storage/storage-account-create/main.bicep",
      "is_mutated": true,
      "mutation_id": "storage_weak_tls",
      "mutation_description": "Set minimum TLS version to 1.0 (weak)",
      "mutation_severity": "medium"
    },
    "_mutation_applied": [
      {
        "mutation_id": "storage_weak_tls",
        "labels": [
          "Storage_WeakTLS",
          "CIS_3.8"
        ],
        "severity": "medium"
      }
    ]
  },
  {
    "id": "/subscriptions/template-sim/resourceGroups/template-rg/providers/Microsoft.Storage/storageAccounts/[parameters('storageAccountName')]",
    "type": "Microsoft.Storage/storageAccounts",
    "apiVersion": "2022-09-01",
    "name": "[parameters('storageAccountName')]",
    "location": "[parameters('location')]",
    "properties": {
      "supportsHttpsTrafficOnly": false
    },
    "dependsOn": [],
    "tags": {},
    "sku": {
      "name": "[parameters('storageAccountType')]"
    },
    "kind": "StorageV2",
    "_raw": {
      "type": "Microsoft.Storage/storageAccounts",
      "apiVersion": "2022-09-01",
      "name": "[parameters('storageAccountName')]",
      "location": "[parameters('location')]",
      "sku": {
        "name": "[parameters('storageAccountType')]"
      },
      "kind": "StorageV2",
      "properties": {
        "supportsHttpsTrafficOnly": false
      }
    },
    "_metadata": {
      "source_template": "templates/azure-quickstart-templates/quickstarts/microsoft.storage/storage-account-create/main.bicep",
      "is_mutated": true,
      "mutation_id": "storage_http_allowed",
      "mutation_description": "Allow HTTP traffic (not HTTPS-only)",
      "mutation_severity": "high"
    },
    "_mutation_applied": [
      {
        "mutation_id": "storage_http_allowed",
        "labels": [
          "Storage_HTTPAllowed",
          "CIS_3.1"
        ],
        "severity": "high"
      }
    ]
  },
  {
    "id": "/subscriptions/template-sim/resourceGroups/template-rg/providers/Microsoft.Storage/storageAccounts/[parameters('storageAccountName')]",
    "type": "Microsoft.Storage/storageAccounts",
    "apiVersion": "2022-09-01",
    "name": "[parameters('storageAccountName')]",
    "location": "[parameters('location')]",
    "properties": {
      "networkAcls": {
        "defaultAction": "Allow"
      }
    },
    "dependsOn": [],
    "tags": {},
    "sku": {
      "name": "[parameters('storageAccountType')]"
    },
    "kind": "StorageV2",
    "_raw": {
      "type": "Microsoft.Storage/storageAccounts",
      "apiVersion": "2022-09-01",
      "name": "[parameters('storageAccountName')]",
      "location": "[parameters('location')]",
      "sku": {
        "name": "[parameters('storageAccountType')]"
      },
      "kind": "StorageV2",
      "properties": {
        "networkAcls": {
          "defaultAction": "Allow"
        }
      }
    },
    "_metadata": {
      "source_template": "templates/azure-quickstart-templates/quickstarts/microsoft.storage/storage-account-create/main.bicep",
      "is_mutated": true,
      "mutation_id": "storage_open_firewall",
      "mutation_description": "Set firewall to allow all network traffic",
      "mutation_severity": "high"
    },
    "_mutation_applied": [
      {
        "mutation_id": "storage_open_firewall",
        "labels": [
          "Storage_FirewallOpen",
          "CIS_3.6"
        ],
        "severity": "high"
      }
    ]
  },
  {
    "id": "/subscriptions/template-sim/resourceGroups/template-rg/providers/Microsoft.Storage/storageAccounts/[parameters('storageAccountName')]",
    "type": "Microsoft.Storage/storageAccounts",
    "apiVersion": "2022-09-01",
    "name": "[parameters('storageAccountName')]",
    "location": "[parameters('location')]",
    "properties": {
      "supportsHttpsTrafficOnly": false
    },
    "dependsOn": [],
    "tags": {},
    "sku": {
      "name": "[parameters('storageAccountType')]"
    },
    "kind": "StorageV2",
    "_raw": {
      "type": "Microsoft.Storage/storageAccounts",
      "apiVersion": "2022-09-01",
      "name": "[parameters('storageAccountName')]",
      "location": "[parameters('location')]",
      "sku": {
        "name": "[parameters('storageAccountType')]"
      },
      "kind": "StorageV2",
      "properties": {
        "supportsHttpsTrafficOnly": false
      }
    },
    "_metadata": {
      "source_template": "templates/azure-quickstart-templates/quickstarts/microsoft.storage/storage-account-create/main.bicep",
      "is_mutated": true,
      "mutation_id": "storage_insecure_transfer",
      "mutation_description": "Disable secure transfer requirement",
      "mutation_severity": "critical"
    },
    "_mutation_applied": [
      {
        "mutation_id": "storage_insecure_transfer",
        "labels": [
          "Storage_InsecureTransfer",
          "CIS_3.1"
        ],
        "severity": "critical"
      }
    ]
  },
  {
    "id": "/subscriptions/template-sim/resourceGroups/template-rg/providers/Microsoft.Storage/storageAccounts/[parameters('storageAccountName')]",
    "type": "Microsoft.Storage/storageAccounts",
    "apiVersion": "2022-09-01",
    "name": "[parameters('storageAccountName')]",
    "location": "[parameters('location')]",
    "properties": {
      "isVersioningEnabled": false
    },
    "dependsOn": [],
    "tags": {},
    "sku": {
      "name": "[parameters('storageAccountType')]"
    },
    "kind": "StorageV2",
    "_raw": {
      "type": "Microsoft.Storage/storageAccounts",
      "apiVersion": "2022-09-01",
      "name": "[parameters('storageAccountName')]",
      "location": "[parameters('location')]",
      "sku": {
        "name": "[parameters('storageAccountType')]"
      },
      "kind": "StorageV2",
      "properties": {
        "isVersioningEnabled": false
      }
    },
    "_metadata": {
      "source_template": "templates/azure-quickstart-templates/quickstarts/microsoft.storage/storage-account-create/main.bicep",
      "is_mutated": true,
      "mutation_id": "storage_no_blob_versioning",
      "mutation_description": "Disable blob versioning",
      "mutation_severity": "low"
    },
    "_mutation_applied": [
      {
        "mutation_id": "storage_no_blob_versioning",
        "labels": [
          "Storage_NoVersioning"
        ],
        "severity": "low"
      }
    ]
  },
  {
    "id": "/subscriptions/template-sim/resourceGroups/template-rg/providers/Microsoft.Storage/storageAccounts/[parameters('storageAccountName')]",
    "type": "Microsoft.Storage/storageAccounts",
    "apiVersion": "2022-09-01",
    "name": "[parameters('storageAccountName')]",
    "location": "[parameters('location')]",
    "properties": {
      "deleteRetentionPolicy": {
        "enabled": false
      }
    },
    "dependsOn": [],
    "tags": {},
    "sku": {
      "name": "[parameters('storageAccountType')]"
    },
    "kind": "StorageV2",
    "_raw": {
      "type": "Microsoft.Storage/storageAccounts",
      "apiVersion": "2022-09-01",
      "name": "[parameters('storageAccountName')]",
      "location": "[parameters('location')]",
      "sku": {
        "name": "[parameters('storageAccountType')]"
      },
      "kind": "StorageV2",
      "properties": {
        "deleteRetentionPolicy": {
          "enabled": false
        }
      }
    },
    "_metadata": {
      "source_template": "templates/azure-quickstart-templates/quickstarts/microsoft.storage/storage-account-create/main.bicep",
      "is_mutated": true,
      "mutation_id": "storage_no_soft_delete",
      "mutation_description": "Disable blob soft delete",
      "mutation_severity": "medium"
    },
    "_mutation_applied": [
      {
        "mutation_id": "storage_no_soft_delete",
        "labels": [
          "Storage_NoSoftDelete",
          "CIS_3.10"
        ],
        "severity": "medium"
      }
    ]
  },
  {
    "id": "/subscriptions/template-sim/resourceGroups/template-rg/providers/Microsoft.Storage/storageAccounts/[parameters('storageAccountName')]",
    "type": "Microsoft.Storage/storageAccounts",
    "apiVersion": "2022-09-01",
    "name": "[parameters('storageAccountName')]",
    "location": "[parameters('location')]",
    "properties": {
      "allowSharedKeyAccess": true
    },
    "dependsOn": [],
    "tags": {},
    "sku": {
      "name": "[parameters('storageAccountType')]"
    },
    "kind": "StorageV2",
    "_raw": {
      "type": "Microsoft.Storage/storageAccounts",
      "apiVersion": "2022-09-01",
      "name": "[parameters('storageAccountName')]",
      "location": "[parameters('location')]",
      "sku": {
        "name": "[parameters('storageAccountType')]"
      },
      "kind": "StorageV2",
      "properties": {
        "allowSharedKeyAccess": true
      }
    },
    "_metadata": {
      "source_template": "templates/azure-quickstart-templates/quickstarts/microsoft.storage/storage-account-create/main.bicep",
      "is_mutated": true,
      "mutation_id": "storage_allow_shared_key",
      "mutation_description": "Allow shared key access (not just Azure AD)",
      "mutation_severity": "medium"
    },
    "_mutation_applied": [
      {
        "mutation_id": "storage_allow_shared_key",
        "labels": [
          "Storage_SharedKeyAccess"
        ],
        "severity": "medium"
      }
    ]
  },
  {
    "id": "/subscriptions/template-sim/resourceGroups/template-rg/providers/Microsoft.Storage/storageAccounts/[parameters('storageAccountName')]",
    "type": "Microsoft.Storage/storageAccounts",
    "apiVersion": "2022-09-01",
    "name": "[parameters('storageAccountName')]",
    "location": "[parameters('location')]",
    "properties": {
      "encryption": {
        "requireInfrastructureEncryption": false
      }
    },
    "dependsOn": [],
    "tags": {},
    "sku": {
      "name": "[parameters('storageAccountType')]"
    },
    "kind": "StorageV2",
    "_raw": {
      "type": "Microsoft.Storage/storageAccounts",
      "apiVersion": "2022-09-01",
      "name": "[parameters('storageAccountName')]",
      "location": "[parameters('location')]",
      "sku": {
        "name": "[parameters('storageAccountType')]"
      },
      "kind": "StorageV2",
      "properties": {
        "encryption": {
          "requireInfrastructureEncryption": false
        }
      }
    },
    "_metadata": {
      "source_template": "templates/azure-quickstart-templates/quickstarts/microsoft.storage/storage-account-create/main.bicep",
      "is_mutated": true,
      "mutation_id": "storage_no_infrastructure_encryption",
      "mutation_description": "Disable infrastructure encryption",
      "mutation_severity": "medium"
    },
    "_mutation_applied": [
      {
        "mutation_id": "storage_no_infrastructure_encryption",
        "labels": [
          "Storage_NoInfraEncryption"
        ],
        "severity": "medium"
      }
    ]
  },
  {
    "id": "/subscriptions/template-sim/resourceGroups/template-rg/providers/Microsoft.Storage/storageAccounts/[parameters('storageAccountName')]",
    "type": "Microsoft.Storage/storageAccounts",
    "apiVersion": "2022-09-01",
    "name": "[parameters('storageAccountName')]",
    "location": "[parameters('location')]",
    "properties": {
      "allowCrossTenantReplication": true
    },
    "dependsOn": [],
    "tags": {},
    "sku": {
      "name": "[parameters('storageAccountType')]"
    },
    "kind": "StorageV2",
    "_raw": {
      "type": "Microsoft.Storage/storageAccounts",
      "apiVersion": "2022-09-01",
      "name": "[parameters('storageAccountName')]",
      "location": "[parameters('location')]",
      "sku": {
        "name": "[parameters('storageAccountType')]"
      },
      "kind": "StorageV2",
      "properties": {
        "allowCrossTenantReplication": true
      }
    },
    "_metadata": {
      "source_template": "templates/azure-quickstart-templates/quickstarts/microsoft.storage/storage-account-create/main.bicep",
      "is_mutated": true,
      "mutation_id": "storage_cross_tenant_replication",
      "mutation_description": "Allow cross-tenant replication",
      "mutation_severity": "low"
    },
    "_mutation_applied": [
      {
        "mutation_id": "storage_cross_tenant_replication",
        "labels": [
          "Storage_CrossTenantReplication"
        ],
        "severity": "low"
      }
    ]
  },
  {
    "id": "/subscriptions/template-sim/resourceGroups/template-rg/providers/Microsoft.Storage/storageAccounts/[parameters('storageAccountName')]",
    "type": "Microsoft.Storage/storageAccounts",
    "apiVersion": "2021-06-01",
    "name": "[parameters('storageAccountName')]",
    "location": "[parameters('location')]",
    "properties": {
      "allowBlobPublicAccess": true
    },
    "dependsOn": [],
    "tags": {},
    "sku": {
      "name": "[parameters('storageSku')]"
    },
    "kind": "StorageV2",
    "_raw": {
      "type": "Microsoft.Storage/storageAccounts",
      "apiVersion": "2021-06-01",
      "name": "[parameters('storageAccountName')]",
      "location": "[parameters('location')]",
      "kind": "StorageV2",
      "sku": {
        "name": "[parameters('storageSku')]"
      }
    },
    "_metadata": {
      "source_template": "templates/azure-quickstart-templates/quickstarts/microsoft.storage/storage-static-website/main.bicep",
      "is_mutated": true,
      "mutation_id": "storage_public_blob_access",
      "mutation_description": "Enable public blob access on storage account",
      "mutation_severity": "high"
    },
    "_mutation_applied": [
      {
        "mutation_id": "storage_public_blob_access",
        "labels": [
          "Storage_PublicAccess",
          "CIS_3.7"
        ],
        "severity": "high"
      }
    ]
  },
  {
    "id": "/subscriptions/template-sim/resourceGroups/template-rg/providers/Microsoft.Storage/storageAccounts/[parameters('storageAccountName')]",
    "type": "Microsoft.Storage/storageAccounts",
    "apiVersion": "2021-06-01",
    "name": "[parameters('storageAccountName')]",
    "location": "[parameters('location')]",
    "properties": {
      "minimumTlsVersion": "TLS1_0"
    },
    "dependsOn": [],
    "tags": {},
    "sku": {
      "name": "[parameters('storageSku')]"
    },
    "kind": "StorageV2",
    "_raw": {
      "type": "Microsoft.Storage/storageAccounts",
      "apiVersion": "2021-06-01",
      "name": "[parameters('storageAccountName')]",
      "location": "[parameters('location')]",
      "kind": "StorageV2",
      "sku": {
        "name": "[parameters('storageSku')]"
      }
    },
    "_metadata": {
      "source_template": "templates/azure-quickstart-templates/quickstarts/microsoft.storage/storage-static-website/main.bicep",
      "is_mutated": true,
      "mutation_id": "storage_weak_tls",
      "mutation_description": "Set minimum TLS version to 1.0 (weak)",
      "mutation_severity": "medium"
    },
    "_mutation_applied": [
      {
        "mutation_id": "storage_weak_tls",
        "labels": [
          "Storage_WeakTLS",
          "CIS_3.8"
        ],
        "severity": "medium"
      }
    ]
  },
  {
    "id": "/subscriptions/template-sim/resourceGroups/template-rg/providers/Microsoft.Storage/storageAccounts/[parameters('storageAccountName')]",
    "type": "Microsoft.Storage/storageAccounts",
    "apiVersion": "2021-06-01",
    "name": "[parameters('storageAccountName')]",
    "location": "[parameters('location')]",
    "properties": {
      "supportsHttpsTrafficOnly": false
    },
    "dependsOn": [],
    "tags": {},
    "sku": {
      "name": "[parameters('storageSku')]"
    },
    "kind": "StorageV2",
    "_raw": {
      "type": "Microsoft.Storage/storageAccounts",
      "apiVersion": "2021-06-01",
      "name": "[parameters('storageAccountName')]",
      "location": "[parameters('location')]",
      "kind": "StorageV2",
      "sku": {
        "name": "[parameters('storageSku')]"
      }
    },
    "_metadata": {
      "source_template": "templates/azure-quickstart-templates/quickstarts/microsoft.storage/storage-static-website/main.bicep",
      "is_mutated": true,
      "mutation_id": "storage_http_allowed",
      "mutation_description": "Allow HTTP traffic (not HTTPS-only)",
      "mutation_severity": "high"
    },
    "_mutation_applied": [
      {
        "mutation_id": "storage_http_allowed",
        "labels": [
          "Storage_HTTPAllowed",
          "CIS_3.1"
        ],
        "severity": "high"
      }
    ]
  },
  {
    "id": "/subscriptions/template-sim/resourceGroups/template-rg/providers/Microsoft.Storage/storageAccounts/[parameters('storageAccountName')]",
    "type": "Microsoft.Storage/storageAccounts",
    "apiVersion": "2021-06-01",
    "name": "[parameters('storageAccountName')]",
    "location": "[parameters('location')]",
    "properties": {
      "networkAcls": {
        "defaultAction": "Allow"
      }
    },
    "dependsOn": [],
    "tags": {},
    "sku": {
      "name": "[parameters('storageSku')]"
    },
    "kind": "StorageV2",
    "_raw": {
      "type": "Microsoft.Storage/storageAccounts",
      "apiVersion": "2021-06-01",
      "name": "[parameters('storageAccountName')]",
      "location": "[parameters('location')]",
      "kind": "StorageV2",
      "sku": {
        "name": "[parameters('storageSku')]"
      }
    },
    "_metadata": {
      "source_template": "templates/azure-quickstart-templates/quickstarts/microsoft.storage/storage-static-website/main.bicep",
      "is_mutated": true,
      "mutation_id": "storage_open_firewall",
      "mutation_description": "Set firewall to allow all network traffic",
      "mutation_severity": "high"
    },
    "_mutation_applied": [
      {
        "mutation_id": "storage_open_firewall",
        "labels": [
          "Storage_FirewallOpen",
          "CIS_3.6"
        ],
        "severity": "high"
      }
    ]
  },
  {
    "id": "/subscriptions/template-sim/resourceGroups/template-rg/providers/Microsoft.Storage/storageAccounts/[parameters('storageAccountName')]",
    "type": "Microsoft.Storage/storageAccounts",
    "apiVersion": "2021-06-01",
    "name": "[parameters('storageAccountName')]",
    "location": "[parameters('location')]",
    "properties": {
      "supportsHttpsTrafficOnly": false
    },
    "dependsOn": [],
    "tags": {},
    "sku": {
      "name": "[parameters('storageSku')]"
    },
    "kind": "StorageV2",
    "_raw": {
      "type": "Microsoft.Storage/storageAccounts",
      "apiVersion": "2021-06-01",
      "name": "[parameters('storageAccountName')]",
      "location": "[parameters('location')]",
      "kind": "StorageV2",
      "sku": {
        "name": "[parameters('storageSku')]"
      }
    },
    "_metadata": {
      "source_template": "templates/azure-quickstart-templates/quickstarts/microsoft.storage/storage-static-website/main.bicep",
      "is_mutated": true,
      "mutation_id": "storage_insecure_transfer",
      "mutation_description": "Disable secure transfer requirement",
      "mutation_severity": "critical"
    },
    "_mutation_applied": [
      {
        "mutation_id": "storage_insecure_transfer",
        "labels": [
          "Storage_InsecureTransfer",
          "CIS_3.1"
        ],
        "severity": "critical"
      }
    ]
  },
  {
    "id": "/subscriptions/template-sim/resourceGroups/template-rg/providers/Microsoft.Storage/storageAccounts/[parameters('storageAccountName')]",
    "type": "Microsoft.Storage/storageAccounts",
    "apiVersion": "2021-06-01",
    "name": "[parameters('storageAccountName')]",
    "location": "[parameters('location')]",
    "properties": {
      "isVersioningEnabled": false
    },
    "dependsOn": [],
    "tags": {},
    "sku": {
      "name": "[parameters('storageSku')]"
    },
    "kind": "StorageV2",
    "_raw": {
      "type": "Microsoft.Storage/storageAccounts",
      "apiVersion": "2021-06-01",
      "name": "[parameters('storageAccountName')]",
      "location": "[parameters('location')]",
      "kind": "StorageV2",
      "sku": {
        "name": "[parameters('storageSku')]"
      }
    },
    "_metadata": {
      "source_template": "templates/azure-quickstart-templates/quickstarts/microsoft.storage/storage-static-website/main.bicep",
      "is_mutated": true,
      "mutation_id": "storage_no_blob_versioning",
      "mutation_description": "Disable blob versioning",
      "mutation_severity": "low"
    },
    "_mutation_applied": [
      {
        "mutation_id": "storage_no_blob_versioning",
        "labels": [
          "Storage_NoVersioning"
        ],
        "severity": "low"
      }
    ]
  },
  {
    "id": "/subscriptions/template-sim/resourceGroups/template-rg/providers/Microsoft.Storage/storageAccounts/[parameters('storageAccountName')]",
    "type": "Microsoft.Storage/storageAccounts",
    "apiVersion": "2021-06-01",
    "name": "[parameters('storageAccountName')]",
    "location": "[parameters('location')]",
    "properties": {
      "deleteRetentionPolicy": {
        "enabled": false
      }
    },
    "dependsOn": [],
    "tags": {},
    "sku": {
      "name": "[parameters('storageSku')]"
    },
    "kind": "StorageV2",
    "_raw": {
      "type": "Microsoft.Storage/storageAccounts",
      "apiVersion": "2021-06-01",
      "name": "[parameters('storageAccountName')]",
      "location": "[parameters('location')]",
      "kind": "StorageV2",
      "sku": {
        "name": "[parameters('storageSku')]"
      }
    },
    "_metadata": {
      "source_template": "templates/azure-quickstart-templates/quickstarts/microsoft.storage/storage-static-website/main.bicep",
      "is_mutated": true,
      "mutation_id": "storage_no_soft_delete",
      "mutation_description": "Disable blob soft delete",
      "mutation_severity": "medium"
    },
    "_mutation_applied": [
      {
        "mutation_id": "storage_no_soft_delete",
        "labels": [
          "Storage_NoSoftDelete",
          "CIS_3.10"
        ],
        "severity": "medium"
      }
    ]
  },
  {
    "id": "/subscriptions/template-sim/resourceGroups/template-rg/providers/Microsoft.Storage/storageAccounts/[parameters('storageAccountName')]",
    "type": "Microsoft.Storage/storageAccounts",
    "apiVersion": "2021-06-01",
    "name": "[parameters('storageAccountName')]",
    "location": "[parameters('location')]",
    "properties": {
      "allowSharedKeyAccess": true
    },
    "dependsOn": [],
    "tags": {},
    "sku": {
      "name": "[parameters('storageSku')]"
    },
    "kind": "StorageV2",
    "_raw": {
      "type": "Microsoft.Storage/storageAccounts",
      "apiVersion": "2021-06-01",
      "name": "[parameters('storageAccountName')]",
      "location": "[parameters('location')]",
      "kind": "StorageV2",
      "sku": {
        "name": "[parameters('storageSku')]"
      }
    },
    "_metadata": {
      "source_template": "templates/azure-quickstart-templates/quickstarts/microsoft.storage/storage-static-website/main.bicep",
      "is_mutated": true,
      "mutation_id": "storage_allow_shared_key",
      "mutation_description": "Allow shared key access (not just Azure AD)",
      "mutation_severity": "medium"
    },
    "_mutation_applied": [
      {
        "mutation_id": "storage_allow_shared_key",
        "labels": [
          "Storage_SharedKeyAccess"
        ],
        "severity": "medium"
      }
    ]
  },
  {
    "id": "/subscriptions/template-sim/resourceGroups/template-rg/providers/Microsoft.Storage/storageAccounts/[parameters('storageAccountName')]",
    "type": "Microsoft.Storage/storageAccounts",
    "apiVersion": "2021-06-01",
    "name": "[parameters('storageAccountName')]",
    "location": "[parameters('location')]",
    "properties": {
      "encryption": {
        "requireInfrastructureEncryption": false
      }
    },
    "dependsOn": [],
    "tags": {},
    "sku": {
      "name": "[parameters('storageSku')]"
    },
    "kind": "StorageV2",
    "_raw": {
      "type": "Microsoft.Storage/storageAccounts",
      "apiVersion": "2021-06-01",
      "name": "[parameters('storageAccountName')]",
      "location": "[parameters('location')]",
      "kind": "StorageV2",
      "sku": {
        "name": "[parameters('storageSku')]"
      }
    },
    "_metadata": {
      "source_template": "templates/azure-quickstart-templates/quickstarts/microsoft.storage/storage-static-website/main.bicep",
      "is_mutated": true,
      "mutation_id": "storage_no_infrastructure_encryption",
      "mutation_description": "Disable infrastructure encryption",
      "mutation_severity": "medium"
    },
    "_mutation_applied": [
      {
        "mutation_id": "storage_no_infrastructure_encryption",
        "labels": [
          "Storage_NoInfraEncryption"
        ],
        "severity": "medium"
      }
    ]
  },
  {
    "id": "/subscriptions/template-sim/resourceGroups/template-rg/providers/Microsoft.Storage/storageAccounts/[parameters('storageAccountName')]",
    "type": "Microsoft.Storage/storageAccounts",
    "apiVersion": "2021-06-01",
    "name": "[parameters('storageAccountName')]",
    "location": "[parameters('location')]",
    "properties": {
      "allowCrossTenantReplication": true
    },
    "dependsOn": [],
    "tags": {},
    "sku": {
      "name": "[parameters('storageSku')]"
    },
    "kind": "StorageV2",
    "_raw": {
      "type": "Microsoft.Storage/storageAccounts",
      "apiVersion": "2021-06-01",
      "name": "[parameters('storageAccountName')]",
      "location": "[parameters('location')]",
      "kind": "StorageV2",
      "sku": {
        "name": "[parameters('storageSku')]"
      }
    },
    "_metadata": {
      "source_template": "templates/azure-quickstart-templates/quickstarts/microsoft.storage/storage-static-website/main.bicep",
      "is_mutated": true,
      "mutation_id": "storage_cross_tenant_replication",
      "mutation_description": "Allow cross-tenant replication",
      "mutation_severity": "low"
    },
    "_mutation_applied": [
      {
        "mutation_id": "storage_cross_tenant_replication",
        "labels": [
          "Storage_CrossTenantReplication"
        ],
        "severity": "low"
      }
    ]
  },
  {
    "id": "/subscriptions/template-sim/resourceGroups/template-rg/providers/Microsoft.Storage/storageAccounts/[parameters('storageAccountName')]",
    "type": "Microsoft.Storage/storageAccounts",
    "apiVersion": "2021-04-01",
    "name": "[parameters('storageAccountName')]",
    "location": "[parameters('location')]",
    "properties": {
      "allowBlobPublicAccess": true
    },
    "dependsOn": [],
    "tags": {},
    "sku": {
      "name": "[parameters('storageAccountReplication')]"
    },
    "kind": "StorageV2",
    "_raw": {
      "type": "Microsoft.Storage/storageAccounts",
      "apiVersion": "2021-04-01",
      "name": "[parameters('storageAccountName')]",
      "location": "[parameters('location')]",
      "sku": {
        "name": "[parameters('storageAccountReplication')]"
      },
      "kind": "StorageV2",
      "properties": {
        "allowBlobPublicAccess": true
      }
    },
    "_metadata": {
      "source_template": "templates/azure-quickstart-templates/quickstarts/microsoft.storage/storage-advanced-threat-protection-create/main.bicep",
      "is_mutated": true,
      "mutation_id": "storage_public_blob_access",
      "mutation_description": "Enable public blob access on storage account",
      "mutation_severity": "high"
    },
    "_mutation_applied": [
      {
        "mutation_id": "storage_public_blob_access",
        "labels": [
          "Storage_PublicAccess",
          "CIS_3.7"
        ],
        "severity": "high"
      }
    ]
  },
  {
    "id": "/subscriptions/template-sim/resourceGroups/template-rg/providers/Microsoft.Storage/storageAccounts/[parameters('storageAccountName')]",
    "type": "Microsoft.Storage/storageAccounts",
    "apiVersion": "2021-04-01",
    "name": "[parameters('storageAccountName')]",
    "location": "[parameters('location')]",
    "properties": {
      "minimumTlsVersion": "TLS1_0"
    },
    "dependsOn": [],
    "tags": {},
    "sku": {
      "name": "[parameters('storageAccountReplication')]"
    },
    "kind": "StorageV2",
    "_raw": {
      "type": "Microsoft.Storage/storageAccounts",
      "apiVersion": "2021-04-01",
      "name": "[parameters('storageAccountName')]",
      "location": "[parameters('location')]",
      "sku": {
        "name": "[parameters('storageAccountReplication')]"
      },
      "kind": "StorageV2",
      "properties": {
        "minimumTlsVersion": "TLS1_0"
      }
    },
    "_metadata": {
      "source_template": "templates/azure-quickstart-templates/quickstarts/microsoft.storage/storage-advanced-threat-protection-create/main.bicep",
      "is_mutated": true,
      "mutation_id": "storage_weak_tls",
      "mutation_description": "Set minimum TLS version to 1.0 (weak)",
      "mutation_severity": "medium"
    },
    "_mutation_applied": [
      {
        "mutation_id": "storage_weak_tls",
        "labels": [
          "Storage_WeakTLS",
          "CIS_3.8"
        ],
        "severity": "medium"
      }
    ]
  },
  {
    "id": "/subscriptions/template-sim/resourceGroups/template-rg/providers/Microsoft.Storage/storageAccounts/[parameters('storageAccountName')]",
    "type": "Microsoft.Storage/storageAccounts",
    "apiVersion": "2021-04-01",
    "name": "[parameters('storageAccountName')]",
    "location": "[parameters('location')]",
    "properties": {
      "supportsHttpsTrafficOnly": false
    },
    "dependsOn": [],
    "tags": {},
    "sku": {
      "name": "[parameters('storageAccountReplication')]"
    },
    "kind": "StorageV2",
    "_raw": {
      "type": "Microsoft.Storage/storageAccounts",
      "apiVersion": "2021-04-01",
      "name": "[parameters('storageAccountName')]",
      "location": "[parameters('location')]",
      "sku": {
        "name": "[parameters('storageAccountReplication')]"
      },
      "kind": "StorageV2",
      "properties": {
        "supportsHttpsTrafficOnly": false
      }
    },
    "_metadata": {
      "source_template": "templates/azure-quickstart-templates/quickstarts/microsoft.storage/storage-advanced-threat-protection-create/main.bicep",
      "is_mutated": true,
      "mutation_id": "storage_http_allowed",
      "mutation_description": "Allow HTTP traffic (not HTTPS-only)",
      "mutation_severity": "high"
    },
    "_mutation_applied": [
      {
        "mutation_id": "storage_http_allowed",
        "labels": [
          "Storage_HTTPAllowed",
          "CIS_3.1"
        ],
        "severity": "high"
      }
    ]
  },
  {
    "id": "/subscriptions/template-sim/resourceGroups/template-rg/providers/Microsoft.Storage/storageAccounts/[parameters('storageAccountName')]",
    "type": "Microsoft.Storage/storageAccounts",
    "apiVersion": "2021-04-01",
    "name": "[parameters('storageAccountName')]",
    "location": "[parameters('location')]",
    "properties": {
      "networkAcls": {
        "defaultAction": "Allow"
      }
    },
    "dependsOn": [],
    "tags": {},
    "sku": {
      "name": "[parameters('storageAccountReplication')]"
    },
    "kind": "StorageV2",
    "_raw": {
      "type": "Microsoft.Storage/storageAccounts",
      "apiVersion": "2021-04-01",
      "name": "[parameters('storageAccountName')]",
      "location": "[parameters('location')]",
      "sku": {
        "name": "[parameters('storageAccountReplication')]"
      },
      "kind": "StorageV2",
      "properties": {
        "networkAcls": {
          "defaultAction": "Allow"
        }
      }
    },
    "_metadata": {
      "source_template": "templates/azure-quickstart-templates/quickstarts/microsoft.storage/storage-advanced-threat-protection-create/main.bicep",
      "is_mutated": true,
      "mutation_id": "storage_open_firewall",
      "mutation_description": "Set firewall to allow all network traffic",
      "mutation_severity": "high"
    },
    "_mutation_applied": [
      {
        "mutation_id": "storage_open_firewall",
        "labels": [
          "Storage_FirewallOpen",
          "CIS_3.6"
        ],
        "severity": "high"
      }
    ]
  },
  {
    "id": "/subscriptions/template-sim/resourceGroups/template-rg/providers/Microsoft.Storage/storageAccounts/[parameters('storageAccountName')]",
    "type": "Microsoft.Storage/storageAccounts",
    "apiVersion": "2021-04-01",
    "name": "[parameters('storageAccountName')]",
    "location": "[parameters('location')]",
    "properties": {
      "supportsHttpsTrafficOnly": false
    },
    "dependsOn": [],
    "tags": {},
    "sku": {
      "name": "[parameters('storageAccountReplication')]"
    },
    "kind": "StorageV2",
    "_raw": {
      "type": "Microsoft.Storage/storageAccounts",
      "apiVersion": "2021-04-01",
      "name": "[parameters('storageAccountName')]",
      "location": "[parameters('location')]",
      "sku": {
        "name": "[parameters('storageAccountReplication')]"
      },
      "kind": "StorageV2",
      "properties": {
        "supportsHttpsTrafficOnly": false
      }
    },
    "_metadata": {
      "source_template": "templates/azure-quickstart-templates/quickstarts/microsoft.storage/storage-advanced-threat-protection-create/main.bicep",
      "is_mutated": true,
      "mutation_id": "storage_insecure_transfer",
      "mutation_description": "Disable secure transfer requirement",
      "mutation_severity": "critical"
    },
    "_mutation_applied": [
      {
        "mutation_id": "storage_insecure_transfer",
        "labels": [
          "Storage_InsecureTransfer",
          "CIS_3.1"
        ],
        "severity": "critical"
      }
    ]
  },
  {
    "id": "/subscriptions/template-sim/resourceGroups/template-rg/providers/Microsoft.Storage/storageAccounts/[parameters('storageAccountName')]",
    "type": "Microsoft.Storage/storageAccounts",
    "apiVersion": "2021-04-01",
    "name": "[parameters('storageAccountName')]",
    "location": "[parameters('location')]",
    "properties": {
      "isVersioningEnabled": false
    },
    "dependsOn": [],
    "tags": {},
    "sku": {
      "name": "[parameters('storageAccountReplication')]"
    },
    "kind": "StorageV2",
    "_raw": {
      "type": "Microsoft.Storage/storageAccounts",
      "apiVersion": "2021-04-01",
      "name": "[parameters('storageAccountName')]",
      "location": "[parameters('location')]",
      "sku": {
        "name": "[parameters('storageAccountReplication')]"
      },
      "kind": "StorageV2",
      "properties": {
        "isVersioningEnabled": false
      }
    },
    "_metadata": {
      "source_template": "templates/azure-quickstart-templates/quickstarts/microsoft.storage/storage-advanced-threat-protection-create/main.bicep",
      "is_mutated": true,
      "mutation_id": "storage_no_blob_versioning",
      "mutation_description": "Disable blob versioning",
      "mutation_severity": "low"
    },
    "_mutation_applied": [
      {
        "mutation_id": "storage_no_blob_versioning",
        "labels": [
          "Storage_NoVersioning"
        ],
        "severity": "low"
      }
    ]
  },
  {
    "id": "/subscriptions/template-sim/resourceGroups/template-rg/providers/Microsoft.Storage/storageAccounts/[parameters('storageAccountName')]",
    "type": "Microsoft.Storage/storageAccounts",
    "apiVersion": "2021-04-01",
    "name": "[parameters('storageAccountName')]",
    "location": "[parameters('location')]",
    "properties": {
      "deleteRetentionPolicy": {
        "enabled": false
      }
    },
    "dependsOn": [],
    "tags": {},
    "sku": {
      "name": "[parameters('storageAccountReplication')]"
    },
    "kind": "StorageV2",
    "_raw": {
      "type": "Microsoft.Storage/storageAccounts",
      "apiVersion": "2021-04-01",
      "name": "[parameters('storageAccountName')]",
      "location": "[parameters('location')]",
      "sku": {
        "name": "[parameters('storageAccountReplication')]"
      },
      "kind": "StorageV2",
      "properties": {
        "deleteRetentionPolicy": {
          "enabled": false
        }
      }
    },
    "_metadata": {
      "source_template": "templates/azure-quickstart-templates/quickstarts/microsoft.storage/storage-advanced-threat-protection-create/main.bicep",
      "is_mutated": true,
      "mutation_id": "storage_no_soft_delete",
      "mutation_description": "Disable blob soft delete",
      "mutation_severity": "medium"
    },
    "_mutation_applied": [
      {
        "mutation_id": "storage_no_soft_delete",
        "labels": [
          "Storage_NoSoftDelete",
          "CIS_3.10"
        ],
        "severity": "medium"
      }
    ]
  },
  {
    "id": "/subscriptions/template-sim/resourceGroups/template-rg/providers/Microsoft.Storage/storageAccounts/[parameters('storageAccountName')]",
    "type": "Microsoft.Storage/storageAccounts",
    "apiVersion": "2021-04-01",
    "name": "[parameters('storageAccountName')]",
    "location": "[parameters('location')]",
    "properties": {
      "allowSharedKeyAccess": true
    },
    "dependsOn": [],
    "tags": {},
    "sku": {
      "name": "[parameters('storageAccountReplication')]"
    },
    "kind": "StorageV2",
    "_raw": {
      "type": "Microsoft.Storage/storageAccounts",
      "apiVersion": "2021-04-01",
      "name": "[parameters('storageAccountName')]",
      "location": "[parameters('location')]",
      "sku": {
        "name": "[parameters('storageAccountReplication')]"
      },
      "kind": "StorageV2",
      "properties": {
        "allowSharedKeyAccess": true
      }
    },
    "_metadata": {
      "source_template": "templates/azure-quickstart-templates/quickstarts/microsoft.storage/storage-advanced-threat-protection-create/main.bicep",
      "is_mutated": true,
      "mutation_id": "storage_allow_shared_key",
      "mutation_description": "Allow shared key access (not just Azure AD)",
      "mutation_severity": "medium"
    },
    "_mutation_applied": [
      {
        "mutation_id": "storage_allow_shared_key",
        "labels": [
          "Storage_SharedKeyAccess"
        ],
        "severity": "medium"
      }
    ]
  },
  {
    "id": "/subscriptions/template-sim/resourceGroups/template-rg/providers/Microsoft.Storage/storageAccounts/[parameters('storageAccountName')]",
    "type": "Microsoft.Storage/storageAccounts",
    "apiVersion": "2021-04-01",
    "name": "[parameters('storageAccountName')]",
    "location": "[parameters('location')]",
    "properties": {
      "encryption": {
        "requireInfrastructureEncryption": false
      }
    },
    "dependsOn": [],
    "tags": {},
    "sku": {
      "name": "[parameters('storageAccountReplication')]"
    },
    "kind": "StorageV2",
    "_raw": {
      "type": "Microsoft.Storage/storageAccounts",
      "apiVersion": "2021-04-01",
      "name": "[parameters('storageAccountName')]",
      "location": "[parameters('location')]",
      "sku": {
        "name": "[parameters('storageAccountReplication')]"
      },
      "kind": "StorageV2",
      "properties": {
        "encryption": {
          "requireInfrastructureEncryption": false
        }
      }
    },
    "_metadata": {
      "source_template": "templates/azure-quickstart-templates/quickstarts/microsoft.storage/storage-advanced-threat-protection-create/main.bicep",
      "is_mutated": true,
      "mutation_id": "storage_no_infrastructure_encryption",
      "mutation_description": "Disable infrastructure encryption",
      "mutation_severity": "medium"
    },
    "_mutation_applied": [
      {
        "mutation_id": "storage_no_infrastructure_encryption",
        "labels": [
          "Storage_NoInfraEncryption"
        ],
        "severity": "medium"
      }
    ]
  },
  {
    "id": "/subscriptions/template-sim/resourceGroups/template-rg/providers/Microsoft.Storage/storageAccounts/[parameters('storageAccountName')]",
    "type": "Microsoft.Storage/storageAccounts",
    "apiVersion": "2021-04-01",
    "name": "[parameters('storageAccountName')]",
    "location": "[parameters('location')]",
    "properties": {
      "allowCrossTenantReplication": true
    },
    "dependsOn": [],
    "tags": {},
    "sku": {
      "name": "[parameters('storageAccountReplication')]"
    },
    "kind": "StorageV2",
    "_raw": {
      "type": "Microsoft.Storage/storageAccounts",
      "apiVersion": "2021-04-01",
      "name": "[parameters('storageAccountName')]",
      "location": "[parameters('location')]",
      "sku": {
        "name": "[parameters('storageAccountReplication')]"
      },
      "kind": "StorageV2",
      "properties": {
        "allowCrossTenantReplication": true
      }
    },
    "_metadata": {
      "source_template": "templates/azure-quickstart-templates/quickstarts/microsoft.storage/storage-advanced-threat-protection-create/main.bicep",
      "is_mutated": true,
      "mutation_id": "storage_cross_tenant_replication",
      "mutation_description": "Allow cross-tenant replication",
      "mutation_severity": "low"
    },
    "_mutation_applied": [
      {
        "mutation_id": "storage_cross_tenant_replication",
        "labels": [
          "Storage_CrossTenantReplication"
        ],
        "severity": "low"
      }
    ]
  },
  {
    "id": "/subscriptions/template-sim/resourceGroups/template-rg/providers/Microsoft.Storage/storageAccounts/[parameters('storageAccountName')]",
    "type": "Microsoft.Storage/storageAccounts",
    "apiVersion": "2021-04-01",
    "name": "[parameters('storageAccountName')]",
    "location": "[parameters('location')]",
    "properties": {
      "accessTier": "Hot",
      "allowBlobPublicAccess": true
    },
    "dependsOn": [],
    "tags": {},
    "sku": {
      "name": "Standard_LRS"
    },
    "kind": "StorageV2",
    "_raw": {
      "type": "Microsoft.Storage/storageAccounts",
      "apiVersion": "2021-04-01",
      "name": "[parameters('storageAccountName')]",
      "location": "[parameters('location')]",
      "kind": "StorageV2",
      "sku": {
        "name": "Standard_LRS"
      },
      "properties": {
        "accessTier": "Hot",
        "allowBlobPublicAccess": true
      }
    },
    "_metadata": {
      "source_template": "templates/azure-quickstart-templates/quickstarts/microsoft.storage/storage-multi-file-share/main.bicep",
      "is_mutated": true,
      "mutation_id": "storage_public_blob_access",
      "mutation_description": "Enable public blob access on storage account",
      "mutation_severity": "high"
    },
    "_mutation_applied": [
      {
        "mutation_id": "storage_public_blob_access",
        "labels": [
          "Storage_PublicAccess",
          "CIS_3.7"
        ],
        "severity": "high"
      }
    ]
  },
  {
    "id": "/subscriptions/template-sim/resourceGroups/template-rg/providers/Microsoft.Storage/storageAccounts/[parameters('storageAccountName')]",
    "type": "Microsoft.Storage/storageAccounts",
    "apiVersion": "2021-04-01",
    "name": "[parameters('storageAccountName')]",
    "location": "[parameters('location')]",
    "properties": {
      "accessTier": "Hot",
      "minimumTlsVersion": "TLS1_0"
    },
    "dependsOn": [],
    "tags": {},
    "sku": {
      "name": "Standard_LRS"
    },
    "kind": "StorageV2",
    "_raw": {
      "type": "Microsoft.Storage/storageAccounts",
      "apiVersion": "2021-04-01",
      "name": "[parameters('storageAccountName')]",
      "location": "[parameters('location')]",
      "kind": "StorageV2",
      "sku": {
        "name": "Standard_LRS"
      },
      "properties": {
        "accessTier": "Hot",
        "minimumTlsVersion": "TLS1_0"
      }
    },
    "_metadata": {
      "source_template": "templates/azure-quickstart-templates/quickstarts/microsoft.storage/storage-multi-file-share/main.bicep",
      "is_mutated": true,
      "mutation_id": "storage_weak_tls",
      "mutation_description": "Set minimum TLS version to 1.0 (weak)",
      "mutation_severity": "medium"
    },
    "_mutation_applied": [
      {
        "mutation_id": "storage_weak_tls",
        "labels": [
          "Storage_WeakTLS",
          "CIS_3.8"
        ],
        "severity": "medium"
      }
    ]
  },
  {
    "id": "/subscriptions/template-sim/resourceGroups/template-rg/providers/Microsoft.Storage/storageAccounts/[parameters('storageAccountName')]",
    "type": "Microsoft.Storage/storageAccounts",
    "apiVersion": "2021-04-01",
    "name": "[parameters('storageAccountName')]",
    "location": "[parameters('location')]",
    "properties": {
      "accessTier": "Hot",
      "supportsHttpsTrafficOnly": false
    },
    "dependsOn": [],
    "tags": {},
    "sku": {
      "name": "Standard_LRS"
    },
    "kind": "StorageV2",
    "_raw": {
      "type": "Microsoft.Storage/storageAccounts",
      "apiVersion": "2021-04-01",
      "name": "[parameters('storageAccountName')]",
      "location": "[parameters('location')]",
      "kind": "StorageV2",
      "sku": {
        "name": "Standard_LRS"
      },
      "properties": {
        "accessTier": "Hot",
        "supportsHttpsTrafficOnly": false
      }
    },
    "_metadata": {
      "source_template": "templates/azure-quickstart-templates/quickstarts/microsoft.storage/storage-multi-file-share/main.bicep",
      "is_mutated": true,
      "mutation_id": "storage_http_allowed",
      "mutation_description": "Allow HTTP traffic (not HTTPS-only)",
      "mutation_severity": "high"
    },
    "_mutation_applied": [
      {
        "mutation_id": "storage_http_allowed",
        "labels": [
          "Storage_HTTPAllowed",
          "CIS_3.1"
        ],
        "severity": "high"
      }
    ]
  },
  {
    "id": "/subscriptions/template-sim/resourceGroups/template-rg/providers/Microsoft.Storage/storageAccounts/[parameters('storageAccountName')]",
    "type": "Microsoft.Storage/storageAccounts",
    "apiVersion": "2021-04-01",
    "name": "[parameters('storageAccountName')]",
    "location": "[parameters('location')]",
    "properties": {
      "accessTier": "Hot",
      "networkAcls": {
        "defaultAction": "Allow"
      }
    },
    "dependsOn": [],
    "tags": {},
    "sku": {
      "name": "Standard_LRS"
    },
    "kind": "StorageV2",
    "_raw": {
      "type": "Microsoft.Storage/storageAccounts",
      "apiVersion": "2021-04-01",
      "name": "[parameters('storageAccountName')]",
      "location": "[parameters('location')]",
      "kind": "StorageV2",
      "sku": {
        "name": "Standard_LRS"
      },
      "properties": {
        "accessTier": "Hot",
        "networkAcls": {
          "defaultAction": "Allow"
        }
      }
    },
    "_metadata": {
      "source_template": "templates/azure-quickstart-templates/quickstarts/microsoft.storage/storage-multi-file-share/main.bicep",
      "is_mutated": true,
      "mutation_id": "storage_open_firewall",
      "mutation_description": "Set firewall to allow all network traffic",
      "mutation_severity": "high"
    },
    "_mutation_applied": [
      {
        "mutation_id": "storage_open_firewall",
        "labels": [
          "Storage_FirewallOpen",
          "CIS_3.6"
        ],
        "severity": "high"
      }
    ]
  },
  {
    "id": "/subscriptions/template-sim/resourceGroups/template-rg/providers/Microsoft.Storage/storageAccounts/[parameters('storageAccountName')]",
    "type": "Microsoft.Storage/storageAccounts",
    "apiVersion": "2021-04-01",
    "name": "[parameters('storageAccountName')]",
    "location": "[parameters('location')]",
    "properties": {
      "accessTier": "Hot",
      "supportsHttpsTrafficOnly": false
    },
    "dependsOn": [],
    "tags": {},
    "sku": {
      "name": "Standard_LRS"
    },
    "kind": "StorageV2",
    "_raw": {
      "type": "Microsoft.Storage/storageAccounts",
      "apiVersion": "2021-04-01",
      "name": "[parameters('storageAccountName')]",
      "location": "[parameters('location')]",
      "kind": "StorageV2",
      "sku": {
        "name": "Standard_LRS"
      },
      "properties": {
        "accessTier": "Hot",
        "supportsHttpsTrafficOnly": false
      }
    },
    "_metadata": {
      "source_template": "templates/azure-quickstart-templates/quickstarts/microsoft.storage/storage-multi-file-share/main.bicep",
      "is_mutated": true,
      "mutation_id": "storage_insecure_transfer",
      "mutation_description": "Disable secure transfer requirement",
      "mutation_severity": "critical"
    },
    "_mutation_applied": [
      {
        "mutation_id": "storage_insecure_transfer",
        "labels": [
          "Storage_InsecureTransfer",
          "CIS_3.1"
        ],
        "severity": "critical"
      }
    ]
  },
  {
    "id": "/subscriptions/template-sim/resourceGroups/template-rg/providers/Microsoft.Storage/storageAccounts/[parameters('storageAccountName')]",
    "type": "Microsoft.Storage/storageAccounts",
    "apiVersion": "2021-04-01",
    "name": "[parameters('storageAccountName')]",
    "location": "[parameters('location')]",
    "properties": {
      "accessTier": "Hot",
      "isVersioningEnabled": false
    },
    "dependsOn": [],
    "tags": {},
    "sku": {
      "name": "Standard_LRS"
    },
    "kind": "StorageV2",
    "_raw": {
      "type": "Microsoft.Storage/storageAccounts",
      "apiVersion": "2021-04-01",
      "name": "[parameters('storageAccountName')]",
      "location": "[parameters('location')]",
      "kind": "StorageV2",
      "sku": {
        "name": "Standard_LRS"
      },
      "properties": {
        "accessTier": "Hot",
        "isVersioningEnabled": false
      }
    },
    "_metadata": {
      "source_template": "templates/azure-quickstart-templates/quickstarts/microsoft.storage/storage-multi-file-share/main.bicep",
      "is_mutated": true,
      "mutation_id": "storage_no_blob_versioning",
      "mutation_description": "Disable blob versioning",
      "mutation_severity": "low"
    },
    "_mutation_applied": [
      {
        "mutation_id": "storage_no_blob_versioning",
        "labels": [
          "Storage_NoVersioning"
        ],
        "severity": "low"
      }
    ]
  },
  {
    "id": "/subscriptions/template-sim/resourceGroups/template-rg/providers/Microsoft.Storage/storageAccounts/[parameters('storageAccountName')]",
    "type": "Microsoft.Storage/storageAccounts",
    "apiVersion": "2021-04-01",
    "name": "[parameters('storageAccountName')]",
    "location": "[parameters('location')]",
    "properties": {
      "accessTier": "Hot",
      "deleteRetentionPolicy": {
        "enabled": false
      }
    },
    "dependsOn": [],
    "tags": {},
    "sku": {
      "name": "Standard_LRS"
    },
    "kind": "StorageV2",
    "_raw": {
      "type": "Microsoft.Storage/storageAccounts",
      "apiVersion": "2021-04-01",
      "name": "[parameters('storageAccountName')]",
      "location": "[parameters('location')]",
      "kind": "StorageV2",
      "sku": {
        "name": "Standard_LRS"
      },
      "properties": {
        "accessTier": "Hot",
        "deleteRetentionPolicy": {
          "enabled": false
        }
      }
    },
    "_metadata": {
      "source_template": "templates/azure-quickstart-templates/quickstarts/microsoft.storage/storage-multi-file-share/main.bicep",
      "is_mutated": true,
      "mutation_id": "storage_no_soft_delete",
      "mutation_description": "Disable blob soft delete",
      "mutation_severity": "medium"
    },
    "_mutation_applied": [
      {
        "mutation_id": "storage_no_soft_delete",
        "labels": [
          "Storage_NoSoftDelete",
          "CIS_3.10"
        ],
        "severity": "medium"
      }
    ]
  },
  {
    "id": "/subscriptions/template-sim/resourceGroups/template-rg/providers/Microsoft.Storage/storageAccounts/[parameters('storageAccountName')]",
    "type": "Microsoft.Storage/storageAccounts",
    "apiVersion": "2021-04-01",
    "name": "[parameters('storageAccountName')]",
    "location": "[parameters('location')]",
    "properties": {
      "accessTier": "Hot",
      "allowSharedKeyAccess": true
    },
    "dependsOn": [],
    "tags": {},
    "sku": {
      "name": "Standard_LRS"
    },
    "kind": "StorageV2",
    "_raw": {
      "type": "Microsoft.Storage/storageAccounts",
      "apiVersion": "2021-04-01",
      "name": "[parameters('storageAccountName')]",
      "location": "[parameters('location')]",
      "kind": "StorageV2",
      "sku": {
        "name": "Standard_LRS"
      },
      "properties": {
        "accessTier": "Hot",
        "allowSharedKeyAccess": true
      }
    },
    "_metadata": {
      "source_template": "templates/azure-quickstart-templates/quickstarts/microsoft.storage/storage-multi-file-share/main.bicep",
      "is_mutated": true,
      "mutation_id": "storage_allow_shared_key",
      "mutation_description": "Allow shared key access (not just Azure AD)",
      "mutation_severity": "medium"
    },
    "_mutation_applied": [
      {
        "mutation_id": "storage_allow_shared_key",
        "labels": [
          "Storage_SharedKeyAccess"
        ],
        "severity": "medium"
      }
    ]
  },
  {
    "id": "/subscriptions/template-sim/resourceGroups/template-rg/providers/Microsoft.Storage/storageAccounts/[parameters('storageAccountName')]",
    "type": "Microsoft.Storage/storageAccounts",
    "apiVersion": "2021-04-01",
    "name": "[parameters('storageAccountName')]",
    "location": "[parameters('location')]",
    "properties": {
      "accessTier": "Hot",
      "encryption": {
        "requireInfrastructureEncryption": false
      }
    },
    "dependsOn": [],
    "tags": {},
    "sku": {
      "name": "Standard_LRS"
    },
    "kind": "StorageV2",
    "_raw": {
      "type": "Microsoft.Storage/storageAccounts",
      "apiVersion": "2021-04-01",
      "name": "[parameters('storageAccountName')]",
      "location": "[parameters('location')]",
      "kind": "StorageV2",
      "sku": {
        "name": "Standard_LRS"
      },
      "properties": {
        "accessTier": "Hot",
        "encryption": {
          "requireInfrastructureEncryption": false
        }
      }
    },
    "_metadata": {
      "source_template": "templates/azure-quickstart-templates/quickstarts/microsoft.storage/storage-multi-file-share/main.bicep",
      "is_mutated": true,
      "mutation_id": "storage_no_infrastructure_encryption",
      "mutation_description": "Disable infrastructure encryption",
      "mutation_severity": "medium"
    },
    "_mutation_applied": [
      {
        "mutation_id": "storage_no_infrastructure_encryption",
        "labels": [
          "Storage_NoInfraEncryption"
        ],
        "severity": "medium"
      }
    ]
  },
  {
    "id": "/subscriptions/template-sim/resourceGroups/template-rg/providers/Microsoft.Storage/storageAccounts/[parameters('storageAccountName')]",
    "type": "Microsoft.Storage/storageAccounts",
    "apiVersion": "2021-04-01",
    "name": "[parameters('storageAccountName')]",
    "location": "[parameters('location')]",
    "properties": {
      "accessTier": "Hot",
      "allowCrossTenantReplication": true
    },
    "dependsOn": [],
    "tags": {},
    "sku": {
      "name": "Standard_LRS"
    },
    "kind": "StorageV2",
    "_raw": {
      "type": "Microsoft.Storage/storageAccounts",
      "apiVersion": "2021-04-01",
      "name": "[parameters('storageAccountName')]",
      "location": "[parameters('location')]",
      "kind": "StorageV2",
      "sku": {
        "name": "Standard_LRS"
      },
      "properties": {
        "accessTier": "Hot",
        "allowCrossTenantReplication": true
      }
    },
    "_metadata": {
      "source_template": "templates/azure-quickstart-templates/quickstarts/microsoft.storage/storage-multi-file-share/main.bicep",
      "is_mutated": true,
      "mutation_id": "storage_cross_tenant_replication",
      "mutation_description": "Allow cross-tenant replication",
      "mutation_severity": "low"
    },
    "_mutation_applied": [
      {
        "mutation_id": "storage_cross_tenant_replication",
        "labels": [
          "Storage_CrossTenantReplication"
        ],
        "severity": "low"
      }
    ]
  },
  {
    "id": "/subscriptions/template-sim/resourceGroups/template-rg/providers/Microsoft.Storage/storageAccounts/[parameters('storageAccountName')]",
    "type": "Microsoft.Storage/storageAccounts",
    "apiVersion": "2021-04-01",
    "name": "[parameters('storageAccountName')]",
    "location": "[parameters('location')]",
    "properties": {
      "accessTier": "Hot",
      "allowBlobPublicAccess": true
    },
    "dependsOn": [],
    "tags": {},
    "sku": {
      "name": "Standard_LRS"
    },
    "kind": "StorageV2",
    "_raw": {
      "type": "Microsoft.Storage/storageAccounts",
      "apiVersion": "2021-04-01",
      "name": "[parameters('storageAccountName')]",
      "location": "[parameters('location')]",
      "kind": "StorageV2",
      "sku": {
        "name": "Standard_LRS"
      },
      "properties": {
        "accessTier": "Hot",
        "allowBlobPublicAccess": true
      }
    },
    "_metadata": {
      "source_template": "templates/azure-quickstart-templates/quickstarts/microsoft.storage/storage-file-share/main.bicep",
      "is_mutated": true,
      "mutation_id": "storage_public_blob_access",
      "mutation_description": "Enable public blob access on storage account",
      "mutation_severity": "high"
    },
    "_mutation_applied": [
      {
        "mutation_id": "storage_public_blob_access",
        "labels": [
          "Storage_PublicAccess",
          "CIS_3.7"
        ],
        "severity": "high"
      }
    ]
  },
  {
    "id": "/subscriptions/template-sim/resourceGroups/template-rg/providers/Microsoft.Storage/storageAccounts/[parameters('storageAccountName')]",
    "type": "Microsoft.Storage/storageAccounts",
    "apiVersion": "2021-04-01",
    "name": "[parameters('storageAccountName')]",
    "location": "[parameters('location')]",
    "properties": {
      "accessTier": "Hot",
      "minimumTlsVersion": "TLS1_0"
    },
    "dependsOn": [],
    "tags": {},
    "sku": {
      "name": "Standard_LRS"
    },
    "kind": "StorageV2",
    "_raw": {
      "type": "Microsoft.Storage/storageAccounts",
      "apiVersion": "2021-04-01",
      "name": "[parameters('storageAccountName')]",
      "location": "[parameters('location')]",
      "kind": "StorageV2",
      "sku": {
        "name": "Standard_LRS"
      },
      "properties": {
        "accessTier": "Hot",
        "minimumTlsVersion": "TLS1_0"
      }
    },
    "_metadata": {
      "source_template": "templates/azure-quickstart-templates/quickstarts/microsoft.storage/storage-file-share/main.bicep",
      "is_mutated": true,
      "mutation_id": "storage_weak_tls",
      "mutation_description": "Set minimum TLS version to 1.0 (weak)",
      "mutation_severity": "medium"
    },
    "_mutation_applied": [
      {
        "mutation_id": "storage_weak_tls",
        "labels": [
          "Storage_WeakTLS",
          "CIS_3.8"
        ],
        "severity": "medium"
      }
    ]
  },
  {
    "id": "/subscriptions/template-sim/resourceGroups/template-rg/providers/Microsoft.Storage/storageAccounts/[parameters('storageAccountName')]",
    "type": "Microsoft.Storage/storageAccounts",
    "apiVersion": "2021-04-01",
    "name": "[parameters('storageAccountName')]",
    "location": "[parameters('location')]",
    "properties": {
      "accessTier": "Hot",
      "supportsHttpsTrafficOnly": false
    },
    "dependsOn": [],
    "tags": {},
    "sku": {
      "name": "Standard_LRS"
    },
    "kind": "StorageV2",
    "_raw": {
      "type": "Microsoft.Storage/storageAccounts",
      "apiVersion": "2021-04-01",
      "name": "[parameters('storageAccountName')]",
      "location": "[parameters('location')]",
      "kind": "StorageV2",
      "sku": {
        "name": "Standard_LRS"
      },
      "properties": {
        "accessTier": "Hot",
        "supportsHttpsTrafficOnly": false
      }
    },
    "_metadata": {
      "source_template": "templates/azure-quickstart-templates/quickstarts/microsoft.storage/storage-file-share/main.bicep",
      "is_mutated": true,
      "mutation_id": "storage_http_allowed",
      "mutation_description": "Allow HTTP traffic (not HTTPS-only)",
      "mutation_severity": "high"
    },
    "_mutation_applied": [
      {
        "mutation_id": "storage_http_allowed",
        "labels": [
          "Storage_HTTPAllowed",
          "CIS_3.1"
        ],
        "severity": "high"
      }
    ]
  },
  {
    "id": "/subscriptions/template-sim/resourceGroups/template-rg/providers/Microsoft.Storage/storageAccounts/[parameters('storageAccountName')]",
    "type": "Microsoft.Storage/storageAccounts",
    "apiVersion": "2021-04-01",
    "name": "[parameters('storageAccountName')]",
    "location": "[parameters('location')]",
    "properties": {
      "accessTier": "Hot",
      "networkAcls": {
        "defaultAction": "Allow"
      }
    },
    "dependsOn": [],
    "tags": {},
    "sku": {
      "name": "Standard_LRS"
    },
    "kind": "StorageV2",
    "_raw": {
      "type": "Microsoft.Storage/storageAccounts",
      "apiVersion": "2021-04-01",
      "name": "[parameters('storageAccountName')]",
      "location": "[parameters('location')]",
      "kind": "StorageV2",
      "sku": {
        "name": "Standard_LRS"
      },
      "properties": {
        "accessTier": "Hot",
        "networkAcls": {
          "defaultAction": "Allow"
        }
      }
    },
    "_metadata": {
      "source_template": "templates/azure-quickstart-templates/quickstarts/microsoft.storage/storage-file-share/main.bicep",
      "is_mutated": true,
      "mutation_id": "storage_open_firewall",
      "mutation_description": "Set firewall to allow all network traffic",
      "mutation_severity": "high"
    },
    "_mutation_applied": [
      {
        "mutation_id": "storage_open_firewall",
        "labels": [
          "Storage_FirewallOpen",
          "CIS_3.6"
        ],
        "severity": "high"
      }
    ]
  },
  {
    "id": "/subscriptions/template-sim/resourceGroups/template-rg/providers/Microsoft.Storage/storageAccounts/[parameters('storageAccountName')]",
    "type": "Microsoft.Storage/storageAccounts",
    "apiVersion": "2021-04-01",
    "name": "[parameters('storageAccountName')]",
    "location": "[parameters('location')]",
    "properties": {
      "accessTier": "Hot",
      "supportsHttpsTrafficOnly": false
    },
    "dependsOn": [],
    "tags": {},
    "sku": {
      "name": "Standard_LRS"
    },
    "kind": "StorageV2",
    "_raw": {
      "type": "Microsoft.Storage/storageAccounts",
      "apiVersion": "2021-04-01",
      "name": "[parameters('storageAccountName')]",
      "location": "[parameters('location')]",
      "kind": "StorageV2",
      "sku": {
        "name": "Standard_LRS"
      },
      "properties": {
        "accessTier": "Hot",
        "supportsHttpsTrafficOnly": false
      }
    },
    "_metadata": {
      "source_template": "templates/azure-quickstart-templates/quickstarts/microsoft.storage/storage-file-share/main.bicep",
      "is_mutated": true,
      "mutation_id": "storage_insecure_transfer",
      "mutation_description": "Disable secure transfer requirement",
      "mutation_severity": "critical"
    },
    "_mutation_applied": [
      {
        "mutation_id": "storage_insecure_transfer",
        "labels": [
          "Storage_InsecureTransfer",
          "CIS_3.1"
        ],
        "severity": "critical"
      }
    ]
  },
  {
    "id": "/subscriptions/template-sim/resourceGroups/template-rg/providers/Microsoft.Storage/storageAccounts/[parameters('storageAccountName')]",
    "type": "Microsoft.Storage/storageAccounts",
    "apiVersion": "2021-04-01",
    "name": "[parameters('storageAccountName')]",
    "location": "[parameters('location')]",
    "properties": {
      "accessTier": "Hot",
      "isVersioningEnabled": false
    },
    "dependsOn": [],
    "tags": {},
    "sku": {
      "name": "Standard_LRS"
    },
    "kind": "StorageV2",
    "_raw": {
      "type": "Microsoft.Storage/storageAccounts",
      "apiVersion": "2021-04-01",
      "name": "[parameters('storageAccountName')]",
      "location": "[parameters('location')]",
      "kind": "StorageV2",
      "sku": {
        "name": "Standard_LRS"
      },
      "properties": {
        "accessTier": "Hot",
        "isVersioningEnabled": false
      }
    },
    "_metadata": {
      "source_template": "templates/azure-quickstart-templates/quickstarts/microsoft.storage/storage-file-share/main.bicep",
      "is_mutated": true,
      "mutation_id": "storage_no_blob_versioning",
      "mutation_description": "Disable blob versioning",
      "mutation_severity": "low"
    },
    "_mutation_applied": [
      {
        "mutation_id": "storage_no_blob_versioning",
        "labels": [
          "Storage_NoVersioning"
        ],
        "severity": "low"
      }
    ]
  },
  {
    "id": "/subscriptions/template-sim/resourceGroups/template-rg/providers/Microsoft.Storage/storageAccounts/[parameters('storageAccountName')]",
    "type": "Microsoft.Storage/storageAccounts",
    "apiVersion": "2021-04-01",
    "name": "[parameters('storageAccountName')]",
    "location": "[parameters('location')]",
    "properties": {
      "accessTier": "Hot",
      "deleteRetentionPolicy": {
        "enabled": false
      }
    },
    "dependsOn": [],
    "tags": {},
    "sku": {
      "name": "Standard_LRS"
    },
    "kind": "StorageV2",
    "_raw": {
      "type": "Microsoft.Storage/storageAccounts",
      "apiVersion": "2021-04-01",
      "name": "[parameters('storageAccountName')]",
      "location": "[parameters('location')]",
      "kind": "StorageV2",
      "sku": {
        "name": "Standard_LRS"
      },
      "properties": {
        "accessTier": "Hot",
        "deleteRetentionPolicy": {
          "enabled": false
        }
      }
    },
    "_metadata": {
      "source_template": "templates/azure-quickstart-templates/quickstarts/microsoft.storage/storage-file-share/main.bicep",
      "is_mutated": true,
      "mutation_id": "storage_no_soft_delete",
      "mutation_description": "Disable blob soft delete",
      "mutation_severity": "medium"
    },
    "_mutation_applied": [
      {
        "mutation_id": "storage_no_soft_delete",
        "labels": [
          "Storage_NoSoftDelete",
          "CIS_3.10"
        ],
        "severity": "medium"
      }
    ]
  },
  {
    "id": "/subscriptions/template-sim/resourceGroups/template-rg/providers/Microsoft.Storage/storageAccounts/[parameters('storageAccountName')]",
    "type": "Microsoft.Storage/storageAccounts",
    "apiVersion": "2021-04-01",
    "name": "[parameters('storageAccountName')]",
    "location": "[parameters('location')]",
    "properties": {
      "accessTier": "Hot",
      "allowSharedKeyAccess": true
    },
    "dependsOn": [],
    "tags": {},
    "sku": {
      "name": "Standard_LRS"
    },
    "kind": "StorageV2",
    "_raw": {
      "type": "Microsoft.Storage/storageAccounts",
      "apiVersion": "2021-04-01",
      "name": "[parameters('storageAccountName')]",
      "location": "[parameters('location')]",
      "kind": "StorageV2",
      "sku": {
        "name": "Standard_LRS"
      },
      "properties": {
        "accessTier": "Hot",
        "allowSharedKeyAccess": true
      }
    },
    "_metadata": {
      "source_template": "templates/azure-quickstart-templates/quickstarts/microsoft.storage/storage-file-share/main.bicep",
      "is_mutated": true,
      "mutation_id": "storage_allow_shared_key",
      "mutation_description": "Allow shared key access (not just Azure AD)",
      "mutation_severity": "medium"
    },
    "_mutation_applied": [
      {
        "mutation_id": "storage_allow_shared_key",
        "labels": [
          "Storage_SharedKeyAccess"
        ],
        "severity": "medium"
      }
    ]
  },
  {
    "id": "/subscriptions/template-sim/resourceGroups/template-rg/providers/Microsoft.Storage/storageAccounts/[parameters('storageAccountName')]",
    "type": "Microsoft.Storage/storageAccounts",
    "apiVersion": "2021-04-01",
    "name": "[parameters('storageAccountName')]",
    "location": "[parameters('location')]",
    "properties": {
      "accessTier": "Hot",
      "encryption": {
        "requireInfrastructureEncryption": false
      }
    },
    "dependsOn": [],
    "tags": {},
    "sku": {
      "name": "Standard_LRS"
    },
    "kind": "StorageV2",
    "_raw": {
      "type": "Microsoft.Storage/storageAccounts",
      "apiVersion": "2021-04-01",
      "name": "[parameters('storageAccountName')]",
      "location": "[parameters('location')]",
      "kind": "StorageV2",
      "sku": {
        "name": "Standard_LRS"
      },
      "properties": {
        "accessTier": "Hot",
        "encryption": {
          "requireInfrastructureEncryption": false
        }
      }
    },
    "_metadata": {
      "source_template": "templates/azure-quickstart-templates/quickstarts/microsoft.storage/storage-file-share/main.bicep",
      "is_mutated": true,
      "mutation_id": "storage_no_infrastructure_encryption",
      "mutation_description": "Disable infrastructure encryption",
      "mutation_severity": "medium"
    },
    "_mutation_applied": [
      {
        "mutation_id": "storage_no_infrastructure_encryption",
        "labels": [
          "Storage_NoInfraEncryption"
        ],
        "severity": "medium"
      }
    ]
  },
  {
    "id": "/subscriptions/template-sim/resourceGroups/template-rg/providers/Microsoft.Storage/storageAccounts/[parameters('storageAccountName')]",
    "type": "Microsoft.Storage/storageAccounts",
    "apiVersion": "2021-04-01",
    "name": "[parameters('storageAccountName')]",
    "location": "[parameters('location')]",
    "properties": {
      "accessTier": "Hot",
      "allowCrossTenantReplication": true
    },
    "dependsOn": [],
    "tags": {},
    "sku": {
      "name": "Standard_LRS"
    },
    "kind": "StorageV2",
    "_raw": {
      "type": "Microsoft.Storage/storageAccounts",
      "apiVersion": "2021-04-01",
      "name": "[parameters('storageAccountName')]",
      "location": "[parameters('location')]",
      "kind": "StorageV2",
      "sku": {
        "name": "Standard_LRS"
      },
      "properties": {
        "accessTier": "Hot",
        "allowCrossTenantReplication": true
      }
    },
    "_metadata": {
      "source_template": "templates/azure-quickstart-templates/quickstarts/microsoft.storage/storage-file-share/main.bicep",
      "is_mutated": true,
      "mutation_id": "storage_cross_tenant_replication",
      "mutation_description": "Allow cross-tenant replication",
      "mutation_severity": "low"
    },
    "_mutation_applied": [
      {
        "mutation_id": "storage_cross_tenant_replication",
        "labels": [
          "Storage_CrossTenantReplication"
        ],
        "severity": "low"
      }
    ]
  },
  {
    "id": "/subscriptions/template-sim/resourceGroups/template-rg/providers/Microsoft.Storage/storageAccounts/[parameters('storageAccountName')]",
    "type": "Microsoft.Storage/storageAccounts",
    "apiVersion": "2021-04-01",
    "name": "[parameters('storageAccountName')]",
    "location": "[parameters('location')]",
    "properties": {
      "accessTier": "Hot",
      "supportsHttpsTrafficOnly": true,
      "minimumTlsVersion": "TLS1_2",
      "encryption": {
        "identity": {
          "userAssignedIdentity": "[extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', subscription().subscriptionId, parameters('userAssignedIdentityResourceGroupName')), 'Microsoft.ManagedIdentity/userAssignedIdentities', parameters('userAssignedIdentityName'))]"
        },
        "services": {
          "blob": {
            "enabled": true
          }
        },
        "keySource": "Microsoft.Keyvault",
        "keyvaultproperties": {
          "keyname": "[parameters('keyVaultKeyName')]",
          "keyvaulturi": "[if(endsWith(reference(resourceId('Microsoft.KeyVault/vaults', parameters('keyVaultName')), '2021-10-01').vaultUri, '/'), substring(reference(resourceId('Microsoft.KeyVault/vaults', parameters('keyVaultName')), '2021-10-01').vaultUri, 0, sub(length(reference(resourceId('Microsoft.KeyVault/vaults', parameters('keyVaultName')), '2021-10-01').vaultUri), 1)), reference(resourceId('Microsoft.KeyVault/vaults', parameters('keyVaultName')), '2021-10-01').vaultUri)]"
        }
      },
      "allowBlobPublicAccess": true
    },
    "dependsOn": [
      "[resourceId('Microsoft.KeyVault/vaults', parameters('keyVaultName'))]",
      "[resourceId('Microsoft.KeyVault/vaults/keys', parameters('keyVaultName'), parameters('keyVaultKeyName'))]"
    ],
    "tags": {},
    "sku": {
      "name": "Standard_LRS"
    },
    "kind": "StorageV2",
    "_raw": {
      "type": "Microsoft.Storage/storageAccounts",
      "apiVersion": "2021-04-01",
      "name": "[parameters('storageAccountName')]",
      "location": "[parameters('location')]",
      "sku": {
        "name": "Standard_LRS"
      },
      "kind": "StorageV2",
      "identity": {
        "type": "UserAssigned",
        "userAssignedIdentities": {
          "[format('{0}', extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', subscription().subscriptionId, parameters('userAssignedIdentityResourceGroupName')), 'Microsoft.ManagedIdentity/userAssignedIdentities', parameters('userAssignedIdentityName')))]": {}
        }
      },
      "properties": {
        "accessTier": "Hot",
        "supportsHttpsTrafficOnly": true,
        "minimumTlsVersion": "TLS1_2",
        "encryption": {
          "identity": {
            "userAssignedIdentity": "[extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', subscription().subscriptionId, parameters('userAssignedIdentityResourceGroupName')), 'Microsoft.ManagedIdentity/userAssignedIdentities', parameters('userAssignedIdentityName'))]"
          },
          "services": {
            "blob": {
              "enabled": true
            }
          },
          "keySource": "Microsoft.Keyvault",
          "keyvaultproperties": {
            "keyname": "[parameters('keyVaultKeyName')]",
            "keyvaulturi": "[if(endsWith(reference(resourceId('Microsoft.KeyVault/vaults', parameters('keyVaultName')), '2021-10-01').vaultUri, '/'), substring(reference(resourceId('Microsoft.KeyVault/vaults', parameters('keyVaultName')), '2021-10-01').vaultUri, 0, sub(length(reference(resourceId('Microsoft.KeyVault/vaults', parameters('keyVaultName')), '2021-10-01').vaultUri), 1)), reference(resourceId('Microsoft.KeyVault/vaults', parameters('keyVaultName')), '2021-10-01').vaultUri)]"
          }
        },
        "allowBlobPublicAccess": true
      },
      "dependsOn": [
        "[resourceId('Microsoft.KeyVault/vaults', parameters('keyVaultName'))]",
        "[resourceId('Microsoft.KeyVault/vaults/keys', parameters('keyVaultName'), parameters('keyVaultKeyName'))]"
      ]
    },
    "_metadata": {
      "source_template": "templates/azure-quickstart-templates/quickstarts/microsoft.storage/storage-blob-encryption-with-cmk/main.bicep",
      "is_mutated": true,
      "mutation_id": "storage_public_blob_access",
      "mutation_description": "Enable public blob access on storage account",
      "mutation_severity": "high"
    },
    "_mutation_applied": [
      {
        "mutation_id": "storage_public_blob_access",
        "labels": [
          "Storage_PublicAccess",
          "CIS_3.7"
        ],
        "severity": "high"
      }
    ]
  },
  {
    "id": "/subscriptions/template-sim/resourceGroups/template-rg/providers/Microsoft.Storage/storageAccounts/[parameters('storageAccountName')]",
    "type": "Microsoft.Storage/storageAccounts",
    "apiVersion": "2021-04-01",
    "name": "[parameters('storageAccountName')]",
    "location": "[parameters('location')]",
    "properties": {
      "accessTier": "Hot",
      "supportsHttpsTrafficOnly": true,
      "minimumTlsVersion": "TLS1_0",
      "encryption": {
        "identity": {
          "userAssignedIdentity": "[extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', subscription().subscriptionId, parameters('userAssignedIdentityResourceGroupName')), 'Microsoft.ManagedIdentity/userAssignedIdentities', parameters('userAssignedIdentityName'))]"
        },
        "services": {
          "blob": {
            "enabled": true
          }
        },
        "keySource": "Microsoft.Keyvault",
        "keyvaultproperties": {
          "keyname": "[parameters('keyVaultKeyName')]",
          "keyvaulturi": "[if(endsWith(reference(resourceId('Microsoft.KeyVault/vaults', parameters('keyVaultName')), '2021-10-01').vaultUri, '/'), substring(reference(resourceId('Microsoft.KeyVault/vaults', parameters('keyVaultName')), '2021-10-01').vaultUri, 0, sub(length(reference(resourceId('Microsoft.KeyVault/vaults', parameters('keyVaultName')), '2021-10-01').vaultUri), 1)), reference(resourceId('Microsoft.KeyVault/vaults', parameters('keyVaultName')), '2021-10-01').vaultUri)]"
        }
      }
    },
    "dependsOn": [
      "[resourceId('Microsoft.KeyVault/vaults', parameters('keyVaultName'))]",
      "[resourceId('Microsoft.KeyVault/vaults/keys', parameters('keyVaultName'), parameters('keyVaultKeyName'))]"
    ],
    "tags": {},
    "sku": {
      "name": "Standard_LRS"
    },
    "kind": "StorageV2",
    "_raw": {
      "type": "Microsoft.Storage/storageAccounts",
      "apiVersion": "2021-04-01",
      "name": "[parameters('storageAccountName')]",
      "location": "[parameters('location')]",
      "sku": {
        "name": "Standard_LRS"
      },
      "kind": "StorageV2",
      "identity": {
        "type": "UserAssigned",
        "userAssignedIdentities": {
          "[format('{0}', extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', subscription().subscriptionId, parameters('userAssignedIdentityResourceGroupName')), 'Microsoft.ManagedIdentity/userAssignedIdentities', parameters('userAssignedIdentityName')))]": {}
        }
      },
      "properties": {
        "accessTier": "Hot",
        "supportsHttpsTrafficOnly": true,
        "minimumTlsVersion": "TLS1_0",
        "encryption": {
          "identity": {
            "userAssignedIdentity": "[extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', subscription().subscriptionId, parameters('userAssignedIdentityResourceGroupName')), 'Microsoft.ManagedIdentity/userAssignedIdentities', parameters('userAssignedIdentityName'))]"
          },
          "services": {
            "blob": {
              "enabled": true
            }
          },
          "keySource": "Microsoft.Keyvault",
          "keyvaultproperties": {
            "keyname": "[parameters('keyVaultKeyName')]",
            "keyvaulturi": "[if(endsWith(reference(resourceId('Microsoft.KeyVault/vaults', parameters('keyVaultName')), '2021-10-01').vaultUri, '/'), substring(reference(resourceId('Microsoft.KeyVault/vaults', parameters('keyVaultName')), '2021-10-01').vaultUri, 0, sub(length(reference(resourceId('Microsoft.KeyVault/vaults', parameters('keyVaultName')), '2021-10-01').vaultUri), 1)), reference(resourceId('Microsoft.KeyVault/vaults', parameters('keyVaultName')), '2021-10-01').vaultUri)]"
          }
        }
      },
      "dependsOn": [
        "[resourceId('Microsoft.KeyVault/vaults', parameters('keyVaultName'))]",
        "[resourceId('Microsoft.KeyVault/vaults/keys', parameters('keyVaultName'), parameters('keyVaultKeyName'))]"
      ]
    },
    "_metadata": {
      "source_template": "templates/azure-quickstart-templates/quickstarts/microsoft.storage/storage-blob-encryption-with-cmk/main.bicep",
      "is_mutated": true,
      "mutation_id": "storage_weak_tls",
      "mutation_description": "Set minimum TLS version to 1.0 (weak)",
      "mutation_severity": "medium"
    },
    "_mutation_applied": [
      {
        "mutation_id": "storage_weak_tls",
        "labels": [
          "Storage_WeakTLS",
          "CIS_3.8"
        ],
        "severity": "medium"
      }
    ]
  },
  {
    "id": "/subscriptions/template-sim/resourceGroups/template-rg/providers/Microsoft.Storage/storageAccounts/[parameters('storageAccountName')]",
    "type": "Microsoft.Storage/storageAccounts",
    "apiVersion": "2021-04-01",
    "name": "[parameters('storageAccountName')]",
    "location": "[parameters('location')]",
    "properties": {
      "accessTier": "Hot",
      "supportsHttpsTrafficOnly": false,
      "minimumTlsVersion": "TLS1_2",
      "encryption": {
        "identity": {
          "userAssignedIdentity": "[extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', subscription().subscriptionId, parameters('userAssignedIdentityResourceGroupName')), 'Microsoft.ManagedIdentity/userAssignedIdentities', parameters('userAssignedIdentityName'))]"
        },
        "services": {
          "blob": {
            "enabled": true
          }
        },
        "keySource": "Microsoft.Keyvault",
        "keyvaultproperties": {
          "keyname": "[parameters('keyVaultKeyName')]",
          "keyvaulturi": "[if(endsWith(reference(resourceId('Microsoft.KeyVault/vaults', parameters('keyVaultName')), '2021-10-01').vaultUri, '/'), substring(reference(resourceId('Microsoft.KeyVault/vaults', parameters('keyVaultName')), '2021-10-01').vaultUri, 0, sub(length(reference(resourceId('Microsoft.KeyVault/vaults', parameters('keyVaultName')), '2021-10-01').vaultUri), 1)), reference(resourceId('Microsoft.KeyVault/vaults', parameters('keyVaultName')), '2021-10-01').vaultUri)]"
        }
      }
    },
    "dependsOn": [
      "[resourceId('Microsoft.KeyVault/vaults', parameters('keyVaultName'))]",
      "[resourceId('Microsoft.KeyVault/vaults/keys', parameters('keyVaultName'), parameters('keyVaultKeyName'))]"
    ],
    "tags": {},
    "sku": {
      "name": "Standard_LRS"
    },
    "kind": "StorageV2",
    "_raw": {
      "type": "Microsoft.Storage/storageAccounts",
      "apiVersion": "2021-04-01",
      "name": "[parameters('storageAccountName')]",
      "location": "[parameters('location')]",
      "sku": {
        "name": "Standard_LRS"
      },
      "kind": "StorageV2",
      "identity": {
        "type": "UserAssigned",
        "userAssignedIdentities": {
          "[format('{0}', extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', subscription().subscriptionId, parameters('userAssignedIdentityResourceGroupName')), 'Microsoft.ManagedIdentity/userAssignedIdentities', parameters('userAssignedIdentityName')))]": {}
        }
      },
      "properties": {
        "accessTier": "Hot",
        "supportsHttpsTrafficOnly": false,
        "minimumTlsVersion": "TLS1_2",
        "encryption": {
          "identity": {
            "userAssignedIdentity": "[extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', subscription().subscriptionId, parameters('userAssignedIdentityResourceGroupName')), 'Microsoft.ManagedIdentity/userAssignedIdentities', parameters('userAssignedIdentityName'))]"
          },
          "services": {
            "blob": {
              "enabled": true
            }
          },
          "keySource": "Microsoft.Keyvault",
          "keyvaultproperties": {
            "keyname": "[parameters('keyVaultKeyName')]",
            "keyvaulturi": "[if(endsWith(reference(resourceId('Microsoft.KeyVault/vaults', parameters('keyVaultName')), '2021-10-01').vaultUri, '/'), substring(reference(resourceId('Microsoft.KeyVault/vaults', parameters('keyVaultName')), '2021-10-01').vaultUri, 0, sub(length(reference(resourceId('Microsoft.KeyVault/vaults', parameters('keyVaultName')), '2021-10-01').vaultUri), 1)), reference(resourceId('Microsoft.KeyVault/vaults', parameters('keyVaultName')), '2021-10-01').vaultUri)]"
          }
        }
      },
      "dependsOn": [
        "[resourceId('Microsoft.KeyVault/vaults', parameters('keyVaultName'))]",
        "[resourceId('Microsoft.KeyVault/vaults/keys', parameters('keyVaultName'), parameters('keyVaultKeyName'))]"
      ]
    },
    "_metadata": {
      "source_template": "templates/azure-quickstart-templates/quickstarts/microsoft.storage/storage-blob-encryption-with-cmk/main.bicep",
      "is_mutated": true,
      "mutation_id": "storage_http_allowed",
      "mutation_description": "Allow HTTP traffic (not HTTPS-only)",
      "mutation_severity": "high"
    },
    "_mutation_applied": [
      {
        "mutation_id": "storage_http_allowed",
        "labels": [
          "Storage_HTTPAllowed",
          "CIS_3.1"
        ],
        "severity": "high"
      }
    ]
  },
  {
    "id": "/subscriptions/template-sim/resourceGroups/template-rg/providers/Microsoft.Storage/storageAccounts/[parameters('storageAccountName')]",
    "type": "Microsoft.Storage/storageAccounts",
    "apiVersion": "2021-04-01",
    "name": "[parameters('storageAccountName')]",
    "location": "[parameters('location')]",
    "properties": {
      "accessTier": "Hot",
      "supportsHttpsTrafficOnly": true,
      "minimumTlsVersion": "TLS1_2",
      "encryption": {
        "identity": {
          "userAssignedIdentity": "[extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', subscription().subscriptionId, parameters('userAssignedIdentityResourceGroupName')), 'Microsoft.ManagedIdentity/userAssignedIdentities', parameters('userAssignedIdentityName'))]"
        },
        "services": {
          "blob": {
            "enabled": true
          }
        },
        "keySource": "Microsoft.Keyvault",
        "keyvaultproperties": {
          "keyname": "[parameters('keyVaultKeyName')]",
          "keyvaulturi": "[if(endsWith(reference(resourceId('Microsoft.KeyVault/vaults', parameters('keyVaultName')), '2021-10-01').vaultUri, '/'), substring(reference(resourceId('Microsoft.KeyVault/vaults', parameters('keyVaultName')), '2021-10-01').vaultUri, 0, sub(length(reference(resourceId('Microsoft.KeyVault/vaults', parameters('keyVaultName')), '2021-10-01').vaultUri), 1)), reference(resourceId('Microsoft.KeyVault/vaults', parameters('keyVaultName')), '2021-10-01').vaultUri)]"
        }
      },
      "networkAcls": {
        "defaultAction": "Allow"
      }
    },
    "dependsOn": [
      "[resourceId('Microsoft.KeyVault/vaults', parameters('keyVaultName'))]",
      "[resourceId('Microsoft.KeyVault/vaults/keys', parameters('keyVaultName'), parameters('keyVaultKeyName'))]"
    ],
    "tags": {},
    "sku": {
      "name": "Standard_LRS"
    },
    "kind": "StorageV2",
    "_raw": {
      "type": "Microsoft.Storage/storageAccounts",
      "apiVersion": "2021-04-01",
      "name": "[parameters('storageAccountName')]",
      "location": "[parameters('location')]",
      "sku": {
        "name": "Standard_LRS"
      },
      "kind": "StorageV2",
      "identity": {
        "type": "UserAssigned",
        "userAssignedIdentities": {
          "[format('{0}', extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', subscription().subscriptionId, parameters('userAssignedIdentityResourceGroupName')), 'Microsoft.ManagedIdentity/userAssignedIdentities', parameters('userAssignedIdentityName')))]": {}
        }
      },
      "properties": {
        "accessTier": "Hot",
        "supportsHttpsTrafficOnly": true,
        "minimumTlsVersion": "TLS1_2",
        "encryption": {
          "identity": {
            "userAssignedIdentity": "[extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', subscription().subscriptionId, parameters('userAssignedIdentityResourceGroupName')), 'Microsoft.ManagedIdentity/userAssignedIdentities', parameters('userAssignedIdentityName'))]"
          },
          "services": {
            "blob": {
              "enabled": true
            }
          },
          "keySource": "Microsoft.Keyvault",
          "keyvaultproperties": {
            "keyname": "[parameters('keyVaultKeyName')]",
            "keyvaulturi": "[if(endsWith(reference(resourceId('Microsoft.KeyVault/vaults', parameters('keyVaultName')), '2021-10-01').vaultUri, '/'), substring(reference(resourceId('Microsoft.KeyVault/vaults', parameters('keyVaultName')), '2021-10-01').vaultUri, 0, sub(length(reference(resourceId('Microsoft.KeyVault/vaults', parameters('keyVaultName')), '2021-10-01').vaultUri), 1)), reference(resourceId('Microsoft.KeyVault/vaults', parameters('keyVaultName')), '2021-10-01').vaultUri)]"
          }
        },
        "networkAcls": {
          "defaultAction": "Allow"
        }
      },
      "dependsOn": [
        "[resourceId('Microsoft.KeyVault/vaults', parameters('keyVaultName'))]",
        "[resourceId('Microsoft.KeyVault/vaults/keys', parameters('keyVaultName'), parameters('keyVaultKeyName'))]"
      ]
    },
    "_metadata": {
      "source_template": "templates/azure-quickstart-templates/quickstarts/microsoft.storage/storage-blob-encryption-with-cmk/main.bicep",
      "is_mutated": true,
      "mutation_id": "storage_open_firewall",
      "mutation_description": "Set firewall to allow all network traffic",
      "mutation_severity": "high"
    },
    "_mutation_applied": [
      {
        "mutation_id": "storage_open_firewall",
        "labels": [
          "Storage_FirewallOpen",
          "CIS_3.6"
        ],
        "severity": "high"
      }
    ]
  },
  {
    "id": "/subscriptions/template-sim/resourceGroups/template-rg/providers/Microsoft.Storage/storageAccounts/[parameters('storageAccountName')]",
    "type": "Microsoft.Storage/storageAccounts",
    "apiVersion": "2021-04-01",
    "name": "[parameters('storageAccountName')]",
    "location": "[parameters('location')]",
    "properties": {
      "accessTier": "Hot",
      "supportsHttpsTrafficOnly": false,
      "minimumTlsVersion": "TLS1_2",
      "encryption": {
        "identity": {
          "userAssignedIdentity": "[extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', subscription().subscriptionId, parameters('userAssignedIdentityResourceGroupName')), 'Microsoft.ManagedIdentity/userAssignedIdentities', parameters('userAssignedIdentityName'))]"
        },
        "services": {
          "blob": {
            "enabled": true
          }
        },
        "keySource": "Microsoft.Keyvault",
        "keyvaultproperties": {
          "keyname": "[parameters('keyVaultKeyName')]",
          "keyvaulturi": "[if(endsWith(reference(resourceId('Microsoft.KeyVault/vaults', parameters('keyVaultName')), '2021-10-01').vaultUri, '/'), substring(reference(resourceId('Microsoft.KeyVault/vaults', parameters('keyVaultName')), '2021-10-01').vaultUri, 0, sub(length(reference(resourceId('Microsoft.KeyVault/vaults', parameters('keyVaultName')), '2021-10-01').vaultUri), 1)), reference(resourceId('Microsoft.KeyVault/vaults', parameters('keyVaultName')), '2021-10-01').vaultUri)]"
        }
      }
    },
    "dependsOn": [
      "[resourceId('Microsoft.KeyVault/vaults', parameters('keyVaultName'))]",
      "[resourceId('Microsoft.KeyVault/vaults/keys', parameters('keyVaultName'), parameters('keyVaultKeyName'))]"
    ],
    "tags": {},
    "sku": {
      "name": "Standard_LRS"
    },
    "kind": "StorageV2",
    "_raw": {
      "type": "Microsoft.Storage/storageAccounts",
      "apiVersion": "2021-04-01",
      "name": "[parameters('storageAccountName')]",
      "location": "[parameters('location')]",
      "sku": {
        "name": "Standard_LRS"
      },
      "kind": "StorageV2",
      "identity": {
        "type": "UserAssigned",
        "userAssignedIdentities": {
          "[format('{0}', extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', subscription().subscriptionId, parameters('userAssignedIdentityResourceGroupName')), 'Microsoft.ManagedIdentity/userAssignedIdentities', parameters('userAssignedIdentityName')))]": {}
        }
      },
      "properties": {
        "accessTier": "Hot",
        "supportsHttpsTrafficOnly": false,
        "minimumTlsVersion": "TLS1_2",
        "encryption": {
          "identity": {
            "userAssignedIdentity": "[extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', subscription().subscriptionId, parameters('userAssignedIdentityResourceGroupName')), 'Microsoft.ManagedIdentity/userAssignedIdentities', parameters('userAssignedIdentityName'))]"
          },
          "services": {
            "blob": {
              "enabled": true
            }
          },
          "keySource": "Microsoft.Keyvault",
          "keyvaultproperties": {
            "keyname": "[parameters('keyVaultKeyName')]",
            "keyvaulturi": "[if(endsWith(reference(resourceId('Microsoft.KeyVault/vaults', parameters('keyVaultName')), '2021-10-01').vaultUri, '/'), substring(reference(resourceId('Microsoft.KeyVault/vaults', parameters('keyVaultName')), '2021-10-01').vaultUri, 0, sub(length(reference(resourceId('Microsoft.KeyVault/vaults', parameters('keyVaultName')), '2021-10-01').vaultUri), 1)), reference(resourceId('Microsoft.KeyVault/vaults', parameters('keyVaultName')), '2021-10-01').vaultUri)]"
          }
        }
      },
      "dependsOn": [
        "[resourceId('Microsoft.KeyVault/vaults', parameters('keyVaultName'))]",
        "[resourceId('Microsoft.KeyVault/vaults/keys', parameters('keyVaultName'), parameters('keyVaultKeyName'))]"
      ]
    },
    "_metadata": {
      "source_template": "templates/azure-quickstart-templates/quickstarts/microsoft.storage/storage-blob-encryption-with-cmk/main.bicep",
      "is_mutated": true,
      "mutation_id": "storage_insecure_transfer",
      "mutation_description": "Disable secure transfer requirement",
      "mutation_severity": "critical"
    },
    "_mutation_applied": [
      {
        "mutation_id": "storage_insecure_transfer",
        "labels": [
          "Storage_InsecureTransfer",
          "CIS_3.1"
        ],
        "severity": "critical"
      }
    ]
  },
  {
    "id": "/subscriptions/template-sim/resourceGroups/template-rg/providers/Microsoft.Storage/storageAccounts/[parameters('storageAccountName')]",
    "type": "Microsoft.Storage/storageAccounts",
    "apiVersion": "2021-04-01",
    "name": "[parameters('storageAccountName')]",
    "location": "[parameters('location')]",
    "properties": {
      "accessTier": "Hot",
      "supportsHttpsTrafficOnly": true,
      "minimumTlsVersion": "TLS1_2",
      "encryption": {
        "identity": {
          "userAssignedIdentity": "[extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', subscription().subscriptionId, parameters('userAssignedIdentityResourceGroupName')), 'Microsoft.ManagedIdentity/userAssignedIdentities', parameters('userAssignedIdentityName'))]"
        },
        "services": {
          "blob": {
            "enabled": true
          }
        },
        "keySource": "Microsoft.Keyvault",
        "keyvaultproperties": {
          "keyname": "[parameters('keyVaultKeyName')]",
          "keyvaulturi": "[if(endsWith(reference(resourceId('Microsoft.KeyVault/vaults', parameters('keyVaultName')), '2021-10-01').vaultUri, '/'), substring(reference(resourceId('Microsoft.KeyVault/vaults', parameters('keyVaultName')), '2021-10-01').vaultUri, 0, sub(length(reference(resourceId('Microsoft.KeyVault/vaults', parameters('keyVaultName')), '2021-10-01').vaultUri), 1)), reference(resourceId('Microsoft.KeyVault/vaults', parameters('keyVaultName')), '2021-10-01').vaultUri)]"
        }
      },
      "isVersioningEnabled": false
    },
    "dependsOn": [
      "[resourceId('Microsoft.KeyVault/vaults', parameters('keyVaultName'))]",
      "[resourceId('Microsoft.KeyVault/vaults/keys', parameters('keyVaultName'), parameters('keyVaultKeyName'))]"
    ],
    "tags": {},
    "sku": {
      "name": "Standard_LRS"
    },
    "kind": "StorageV2",
    "_raw": {
      "type": "Microsoft.Storage/storageAccounts",
      "apiVersion": "2021-04-01",
      "name": "[parameters('storageAccountName')]",
      "location": "[parameters('location')]",
      "sku": {
        "name": "Standard_LRS"
      },
      "kind": "StorageV2",
      "identity": {
        "type": "UserAssigned",
        "userAssignedIdentities": {
          "[format('{0}', extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', subscription().subscriptionId, parameters('userAssignedIdentityResourceGroupName')), 'Microsoft.ManagedIdentity/userAssignedIdentities', parameters('userAssignedIdentityName')))]": {}
        }
      },
      "properties": {
        "accessTier": "Hot",
        "supportsHttpsTrafficOnly": true,
        "minimumTlsVersion": "TLS1_2",
        "encryption": {
          "identity": {
            "userAssignedIdentity": "[extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', subscription().subscriptionId, parameters('userAssignedIdentityResourceGroupName')), 'Microsoft.ManagedIdentity/userAssignedIdentities', parameters('userAssignedIdentityName'))]"
          },
          "services": {
            "blob": {
              "enabled": true
            }
          },
          "keySource": "Microsoft.Keyvault",
          "keyvaultproperties": {
            "keyname": "[parameters('keyVaultKeyName')]",
            "keyvaulturi": "[if(endsWith(reference(resourceId('Microsoft.KeyVault/vaults', parameters('keyVaultName')), '2021-10-01').vaultUri, '/'), substring(reference(resourceId('Microsoft.KeyVault/vaults', parameters('keyVaultName')), '2021-10-01').vaultUri, 0, sub(length(reference(resourceId('Microsoft.KeyVault/vaults', parameters('keyVaultName')), '2021-10-01').vaultUri), 1)), reference(resourceId('Microsoft.KeyVault/vaults', parameters('keyVaultName')), '2021-10-01').vaultUri)]"
          }
        },
        "isVersioningEnabled": false
      },
      "dependsOn": [
        "[resourceId('Microsoft.KeyVault/vaults', parameters('keyVaultName'))]",
        "[resourceId('Microsoft.KeyVault/vaults/keys', parameters('keyVaultName'), parameters('keyVaultKeyName'))]"
      ]
    },
    "_metadata": {
      "source_template": "templates/azure-quickstart-templates/quickstarts/microsoft.storage/storage-blob-encryption-with-cmk/main.bicep",
      "is_mutated": true,
      "mutation_id": "storage_no_blob_versioning",
      "mutation_description": "Disable blob versioning",
      "mutation_severity": "low"
    },
    "_mutation_applied": [
      {
        "mutation_id": "storage_no_blob_versioning",
        "labels": [
          "Storage_NoVersioning"
        ],
        "severity": "low"
      }
    ]
  },
  {
    "id": "/subscriptions/template-sim/resourceGroups/template-rg/providers/Microsoft.Storage/storageAccounts/[parameters('storageAccountName')]",
    "type": "Microsoft.Storage/storageAccounts",
    "apiVersion": "2021-04-01",
    "name": "[parameters('storageAccountName')]",
    "location": "[parameters('location')]",
    "properties": {
      "accessTier": "Hot",
      "supportsHttpsTrafficOnly": true,
      "minimumTlsVersion": "TLS1_2",
      "encryption": {
        "identity": {
          "userAssignedIdentity": "[extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', subscription().subscriptionId, parameters('userAssignedIdentityResourceGroupName')), 'Microsoft.ManagedIdentity/userAssignedIdentities', parameters('userAssignedIdentityName'))]"
        },
        "services": {
          "blob": {
            "enabled": true
          }
        },
        "keySource": "Microsoft.Keyvault",
        "keyvaultproperties": {
          "keyname": "[parameters('keyVaultKeyName')]",
          "keyvaulturi": "[if(endsWith(reference(resourceId('Microsoft.KeyVault/vaults', parameters('keyVaultName')), '2021-10-01').vaultUri, '/'), substring(reference(resourceId('Microsoft.KeyVault/vaults', parameters('keyVaultName')), '2021-10-01').vaultUri, 0, sub(length(reference(resourceId('Microsoft.KeyVault/vaults', parameters('keyVaultName')), '2021-10-01').vaultUri), 1)), reference(resourceId('Microsoft.KeyVault/vaults', parameters('keyVaultName')), '2021-10-01').vaultUri)]"
        }
      },
      "deleteRetentionPolicy": {
        "enabled": false
      }
    },
    "dependsOn": [
      "[resourceId('Microsoft.KeyVault/vaults', parameters('keyVaultName'))]",
      "[resourceId('Microsoft.KeyVault/vaults/keys', parameters('keyVaultName'), parameters('keyVaultKeyName'))]"
    ],
    "tags": {},
    "sku": {
      "name": "Standard_LRS"
    },
    "kind": "StorageV2",
    "_raw": {
      "type": "Microsoft.Storage/storageAccounts",
      "apiVersion": "2021-04-01",
      "name": "[parameters('storageAccountName')]",
      "location": "[parameters('location')]",
      "sku": {
        "name": "Standard_LRS"
      },
      "kind": "StorageV2",
      "identity": {
        "type": "UserAssigned",
        "userAssignedIdentities": {
          "[format('{0}', extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', subscription().subscriptionId, parameters('userAssignedIdentityResourceGroupName')), 'Microsoft.ManagedIdentity/userAssignedIdentities', parameters('userAssignedIdentityName')))]": {}
        }
      },
      "properties": {
        "accessTier": "Hot",
        "supportsHttpsTrafficOnly": true,
        "minimumTlsVersion": "TLS1_2",
        "encryption": {
          "identity": {
            "userAssignedIdentity": "[extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', subscription().subscriptionId, parameters('userAssignedIdentityResourceGroupName')), 'Microsoft.ManagedIdentity/userAssignedIdentities', parameters('userAssignedIdentityName'))]"
          },
          "services": {
            "blob": {
              "enabled": true
            }
          },
          "keySource": "Microsoft.Keyvault",
          "keyvaultproperties": {
            "keyname": "[parameters('keyVaultKeyName')]",
            "keyvaulturi": "[if(endsWith(reference(resourceId('Microsoft.KeyVault/vaults', parameters('keyVaultName')), '2021-10-01').vaultUri, '/'), substring(reference(resourceId('Microsoft.KeyVault/vaults', parameters('keyVaultName')), '2021-10-01').vaultUri, 0, sub(length(reference(resourceId('Microsoft.KeyVault/vaults', parameters('keyVaultName')), '2021-10-01').vaultUri), 1)), reference(resourceId('Microsoft.KeyVault/vaults', parameters('keyVaultName')), '2021-10-01').vaultUri)]"
          }
        },
        "deleteRetentionPolicy": {
          "enabled": false
        }
      },
      "dependsOn": [
        "[resourceId('Microsoft.KeyVault/vaults', parameters('keyVaultName'))]",
        "[resourceId('Microsoft.KeyVault/vaults/keys', parameters('keyVaultName'), parameters('keyVaultKeyName'))]"
      ]
    },
    "_metadata": {
      "source_template": "templates/azure-quickstart-templates/quickstarts/microsoft.storage/storage-blob-encryption-with-cmk/main.bicep",
      "is_mutated": true,
      "mutation_id": "storage_no_soft_delete",
      "mutation_description": "Disable blob soft delete",
      "mutation_severity": "medium"
    },
    "_mutation_applied": [
      {
        "mutation_id": "storage_no_soft_delete",
        "labels": [
          "Storage_NoSoftDelete",
          "CIS_3.10"
        ],
        "severity": "medium"
      }
    ]
  },
  {
    "id": "/subscriptions/template-sim/resourceGroups/template-rg/providers/Microsoft.Storage/storageAccounts/[parameters('storageAccountName')]",
    "type": "Microsoft.Storage/storageAccounts",
    "apiVersion": "2021-04-01",
    "name": "[parameters('storageAccountName')]",
    "location": "[parameters('location')]",
    "properties": {
      "accessTier": "Hot",
      "supportsHttpsTrafficOnly": true,
      "minimumTlsVersion": "TLS1_2",
      "encryption": {
        "identity": {
          "userAssignedIdentity": "[extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', subscription().subscriptionId, parameters('userAssignedIdentityResourceGroupName')), 'Microsoft.ManagedIdentity/userAssignedIdentities', parameters('userAssignedIdentityName'))]"
        },
        "services": {
          "blob": {
            "enabled": true
          }
        },
        "keySource": "Microsoft.Keyvault",
        "keyvaultproperties": {
          "keyname": "[parameters('keyVaultKeyName')]",
          "keyvaulturi": "[if(endsWith(reference(resourceId('Microsoft.KeyVault/vaults', parameters('keyVaultName')), '2021-10-01').vaultUri, '/'), substring(reference(resourceId('Microsoft.KeyVault/vaults', parameters('keyVaultName')), '2021-10-01').vaultUri, 0, sub(length(reference(resourceId('Microsoft.KeyVault/vaults', parameters('keyVaultName')), '2021-10-01').vaultUri), 1)), reference(resourceId('Microsoft.KeyVault/vaults', parameters('keyVaultName')), '2021-10-01').vaultUri)]"
        }
      },
      "allowSharedKeyAccess": true
    },
    "dependsOn": [
      "[resourceId('Microsoft.KeyVault/vaults', parameters('keyVaultName'))]",
      "[resourceId('Microsoft.KeyVault/vaults/keys', parameters('keyVaultName'), parameters('keyVaultKeyName'))]"
    ],
    "tags": {},
    "sku": {
      "name": "Standard_LRS"
    },
    "kind": "StorageV2",
    "_raw": {
      "type": "Microsoft.Storage/storageAccounts",
      "apiVersion": "2021-04-01",
      "name": "[parameters('storageAccountName')]",
      "location": "[parameters('location')]",
      "sku": {
        "name": "Standard_LRS"
      },
      "kind": "StorageV2",
      "identity": {
        "type": "UserAssigned",
        "userAssignedIdentities": {
          "[format('{0}', extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', subscription().subscriptionId, parameters('userAssignedIdentityResourceGroupName')), 'Microsoft.ManagedIdentity/userAssignedIdentities', parameters('userAssignedIdentityName')))]": {}
        }
      },
      "properties": {
        "accessTier": "Hot",
        "supportsHttpsTrafficOnly": true,
        "minimumTlsVersion": "TLS1_2",
        "encryption": {
          "identity": {
            "userAssignedIdentity": "[extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', subscription().subscriptionId, parameters('userAssignedIdentityResourceGroupName')), 'Microsoft.ManagedIdentity/userAssignedIdentities', parameters('userAssignedIdentityName'))]"
          },
          "services": {
            "blob": {
              "enabled": true
            }
          },
          "keySource": "Microsoft.Keyvault",
          "keyvaultproperties": {
            "keyname": "[parameters('keyVaultKeyName')]",
            "keyvaulturi": "[if(endsWith(reference(resourceId('Microsoft.KeyVault/vaults', parameters('keyVaultName')), '2021-10-01').vaultUri, '/'), substring(reference(resourceId('Microsoft.KeyVault/vaults', parameters('keyVaultName')), '2021-10-01').vaultUri, 0, sub(length(reference(resourceId('Microsoft.KeyVault/vaults', parameters('keyVaultName')), '2021-10-01').vaultUri), 1)), reference(resourceId('Microsoft.KeyVault/vaults', parameters('keyVaultName')), '2021-10-01').vaultUri)]"
          }
        },
        "allowSharedKeyAccess": true
      },
      "dependsOn": [
        "[resourceId('Microsoft.KeyVault/vaults', parameters('keyVaultName'))]",
        "[resourceId('Microsoft.KeyVault/vaults/keys', parameters('keyVaultName'), parameters('keyVaultKeyName'))]"
      ]
    },
    "_metadata": {
      "source_template": "templates/azure-quickstart-templates/quickstarts/microsoft.storage/storage-blob-encryption-with-cmk/main.bicep",
      "is_mutated": true,
      "mutation_id": "storage_allow_shared_key",
      "mutation_description": "Allow shared key access (not just Azure AD)",
      "mutation_severity": "medium"
    },
    "_mutation_applied": [
      {
        "mutation_id": "storage_allow_shared_key",
        "labels": [
          "Storage_SharedKeyAccess"
        ],
        "severity": "medium"
      }
    ]
  },
  {
    "id": "/subscriptions/template-sim/resourceGroups/template-rg/providers/Microsoft.Storage/storageAccounts/[parameters('storageAccountName')]",
    "type": "Microsoft.Storage/storageAccounts",
    "apiVersion": "2021-04-01",
    "name": "[parameters('storageAccountName')]",
    "location": "[parameters('location')]",
    "properties": {
      "accessTier": "Hot",
      "supportsHttpsTrafficOnly": true,
      "minimumTlsVersion": "TLS1_2",
      "encryption": {
        "identity": {
          "userAssignedIdentity": "[extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', subscription().subscriptionId, parameters('userAssignedIdentityResourceGroupName')), 'Microsoft.ManagedIdentity/userAssignedIdentities', parameters('userAssignedIdentityName'))]"
        },
        "services": {
          "blob": {
            "enabled": true
          }
        },
        "keySource": "Microsoft.Keyvault",
        "keyvaultproperties": {
          "keyname": "[parameters('keyVaultKeyName')]",
          "keyvaulturi": "[if(endsWith(reference(resourceId('Microsoft.KeyVault/vaults', parameters('keyVaultName')), '2021-10-01').vaultUri, '/'), substring(reference(resourceId('Microsoft.KeyVault/vaults', parameters('keyVaultName')), '2021-10-01').vaultUri, 0, sub(length(reference(resourceId('Microsoft.KeyVault/vaults', parameters('keyVaultName')), '2021-10-01').vaultUri), 1)), reference(resourceId('Microsoft.KeyVault/vaults', parameters('keyVaultName')), '2021-10-01').vaultUri)]"
        },
        "requireInfrastructureEncryption": false
      }
    },
    "dependsOn": [
      "[resourceId('Microsoft.KeyVault/vaults', parameters('keyVaultName'))]",
      "[resourceId('Microsoft.KeyVault/vaults/keys', parameters('keyVaultName'), parameters('keyVaultKeyName'))]"
    ],
    "tags": {},
    "sku": {
      "name": "Standard_LRS"
    },
    "kind": "StorageV2",
    "_raw": {
      "type": "Microsoft.Storage/storageAccounts",
      "apiVersion": "2021-04-01",
      "name": "[parameters('storageAccountName')]",
      "location": "[parameters('location')]",
      "sku": {
        "name": "Standard_LRS"
      },
      "kind": "StorageV2",
      "identity": {
        "type": "UserAssigned",
        "userAssignedIdentities": {
          "[format('{0}', extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', subscription().subscriptionId, parameters('userAssignedIdentityResourceGroupName')), 'Microsoft.ManagedIdentity/userAssignedIdentities', parameters('userAssignedIdentityName')))]": {}
        }
      },
      "properties": {
        "accessTier": "Hot",
        "supportsHttpsTrafficOnly": true,
        "minimumTlsVersion": "TLS1_2",
        "encryption": {
          "identity": {
            "userAssignedIdentity": "[extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', subscription().subscriptionId, parameters('userAssignedIdentityResourceGroupName')), 'Microsoft.ManagedIdentity/userAssignedIdentities', parameters('userAssignedIdentityName'))]"
          },
          "services": {
            "blob": {
              "enabled": true
            }
          },
          "keySource": "Microsoft.Keyvault",
          "keyvaultproperties": {
            "keyname": "[parameters('keyVaultKeyName')]",
            "keyvaulturi": "[if(endsWith(reference(resourceId('Microsoft.KeyVault/vaults', parameters('keyVaultName')), '2021-10-01').vaultUri, '/'), substring(reference(resourceId('Microsoft.KeyVault/vaults', parameters('keyVaultName')), '2021-10-01').vaultUri, 0, sub(length(reference(resourceId('Microsoft.KeyVault/vaults', parameters('keyVaultName')), '2021-10-01').vaultUri), 1)), reference(resourceId('Microsoft.KeyVault/vaults', parameters('keyVaultName')), '2021-10-01').vaultUri)]"
          },
          "requireInfrastructureEncryption": false
        }
      },
      "dependsOn": [
        "[resourceId('Microsoft.KeyVault/vaults', parameters('keyVaultName'))]",
        "[resourceId('Microsoft.KeyVault/vaults/keys', parameters('keyVaultName'), parameters('keyVaultKeyName'))]"
      ]
    },
    "_metadata": {
      "source_template": "templates/azure-quickstart-templates/quickstarts/microsoft.storage/storage-blob-encryption-with-cmk/main.bicep",
      "is_mutated": true,
      "mutation_id": "storage_no_infrastructure_encryption",
      "mutation_description": "Disable infrastructure encryption",
      "mutation_severity": "medium"
    },
    "_mutation_applied": [
      {
        "mutation_id": "storage_no_infrastructure_encryption",
        "labels": [
          "Storage_NoInfraEncryption"
        ],
        "severity": "medium"
      }
    ]
  },
  {
    "id": "/subscriptions/template-sim/resourceGroups/template-rg/providers/Microsoft.Storage/storageAccounts/[parameters('storageAccountName')]",
    "type": "Microsoft.Storage/storageAccounts",
    "apiVersion": "2021-04-01",
    "name": "[parameters('storageAccountName')]",
    "location": "[parameters('location')]",
    "properties": {
      "accessTier": "Hot",
      "supportsHttpsTrafficOnly": true,
      "minimumTlsVersion": "TLS1_2",
      "encryption": {
        "identity": {
          "userAssignedIdentity": "[extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', subscription().subscriptionId, parameters('userAssignedIdentityResourceGroupName')), 'Microsoft.ManagedIdentity/userAssignedIdentities', parameters('userAssignedIdentityName'))]"
        },
        "services": {
          "blob": {
            "enabled": true
          }
        },
        "keySource": "Microsoft.Keyvault",
        "keyvaultproperties": {
          "keyname": "[parameters('keyVaultKeyName')]",
          "keyvaulturi": "[if(endsWith(reference(resourceId('Microsoft.KeyVault/vaults', parameters('keyVaultName')), '2021-10-01').vaultUri, '/'), substring(reference(resourceId('Microsoft.KeyVault/vaults', parameters('keyVaultName')), '2021-10-01').vaultUri, 0, sub(length(reference(resourceId('Microsoft.KeyVault/vaults', parameters('keyVaultName')), '2021-10-01').vaultUri), 1)), reference(resourceId('Microsoft.KeyVault/vaults', parameters('keyVaultName')), '2021-10-01').vaultUri)]"
        }
      },
      "allowCrossTenantReplication": true
    },
    "dependsOn": [
      "[resourceId('Microsoft.KeyVault/vaults', parameters('keyVaultName'))]",
      "[resourceId('Microsoft.KeyVault/vaults/keys', parameters('keyVaultName'), parameters('keyVaultKeyName'))]"
    ],
    "tags": {},
    "sku": {
      "name": "Standard_LRS"
    },
    "kind": "StorageV2",
    "_raw": {
      "type": "Microsoft.Storage/storageAccounts",
      "apiVersion": "2021-04-01",
      "name": "[parameters('storageAccountName')]",
      "location": "[parameters('location')]",
      "sku": {
        "name": "Standard_LRS"
      },
      "kind": "StorageV2",
      "identity": {
        "type": "UserAssigned",
        "userAssignedIdentities": {
          "[format('{0}', extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', subscription().subscriptionId, parameters('userAssignedIdentityResourceGroupName')), 'Microsoft.ManagedIdentity/userAssignedIdentities', parameters('userAssignedIdentityName')))]": {}
        }
      },
      "properties": {
        "accessTier": "Hot",
        "supportsHttpsTrafficOnly": true,
        "minimumTlsVersion": "TLS1_2",
        "encryption": {
          "identity": {
            "userAssignedIdentity": "[extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', subscription().subscriptionId, parameters('userAssignedIdentityResourceGroupName')), 'Microsoft.ManagedIdentity/userAssignedIdentities', parameters('userAssignedIdentityName'))]"
          },
          "services": {
            "blob": {
              "enabled": true
            }
          },
          "keySource": "Microsoft.Keyvault",
          "keyvaultproperties": {
            "keyname": "[parameters('keyVaultKeyName')]",
            "keyvaulturi": "[if(endsWith(reference(resourceId('Microsoft.KeyVault/vaults', parameters('keyVaultName')), '2021-10-01').vaultUri, '/'), substring(reference(resourceId('Microsoft.KeyVault/vaults', parameters('keyVaultName')), '2021-10-01').vaultUri, 0, sub(length(reference(resourceId('Microsoft.KeyVault/vaults', parameters('keyVaultName')), '2021-10-01').vaultUri), 1)), reference(resourceId('Microsoft.KeyVault/vaults', parameters('keyVaultName')), '2021-10-01').vaultUri)]"
          }
        },
        "allowCrossTenantReplication": true
      },
      "dependsOn": [
        "[resourceId('Microsoft.KeyVault/vaults', parameters('keyVaultName'))]",
        "[resourceId('Microsoft.KeyVault/vaults/keys', parameters('keyVaultName'), parameters('keyVaultKeyName'))]"
      ]
    },
    "_metadata": {
      "source_template": "templates/azure-quickstart-templates/quickstarts/microsoft.storage/storage-blob-encryption-with-cmk/main.bicep",
      "is_mutated": true,
      "mutation_id": "storage_cross_tenant_replication",
      "mutation_description": "Allow cross-tenant replication",
      "mutation_severity": "low"
    },
    "_mutation_applied": [
      {
        "mutation_id": "storage_cross_tenant_replication",
        "labels": [
          "Storage_CrossTenantReplication"
        ],
        "severity": "low"
      }
    ]
  },
  {
    "id": "/subscriptions/template-sim/resourceGroups/template-rg/providers/Microsoft.KeyVault/vaults/[parameters('keyVaultName')]",
    "type": "Microsoft.KeyVault/vaults",
    "apiVersion": "2021-10-01",
    "name": "[parameters('keyVaultName')]",
    "location": "[parameters('location')]",
    "properties": {
      "sku": {
        "name": "standard",
        "family": "A"
      },
      "enableSoftDelete": true,
      "enablePurgeProtection": false,
      "enabledForDiskEncryption": true,
      "tenantId": "[parameters('tenantId')]",
      "accessPolicies": [
        {
          "tenantId": "[parameters('tenantId')]",
          "permissions": {
            "keys": [
              "unwrapKey",
              "wrapKey",
              "get"
            ]
          },
          "objectId": "[reference(extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', subscription().subscriptionId, parameters('userAssignedIdentityResourceGroupName')), 'Microsoft.ManagedIdentity/userAssignedIdentities', parameters('userAssignedIdentityName')), '2018-11-30').principalId]"
        }
      ]
    },
    "dependsOn": [],
    "tags": {},
    "sku": null,
    "kind": null,
    "_raw": {
      "type": "Microsoft.KeyVault/vaults",
      "apiVersion": "2021-10-01",
      "name": "[parameters('keyVaultName')]",
      "location": "[parameters('location')]",
      "properties": {
        "sku": {
          "name": "standard",
          "family": "A"
        },
        "enableSoftDelete": true,
        "enablePurgeProtection": false,
        "enabledForDiskEncryption": true,
        "tenantId": "[parameters('tenantId')]",
        "accessPolicies": [
          {
            "tenantId": "[parameters('tenantId')]",
            "permissions": {
              "keys": [
                "unwrapKey",
                "wrapKey",
                "get"
              ]
            },
            "objectId": "[reference(extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', subscription().subscriptionId, parameters('userAssignedIdentityResourceGroupName')), 'Microsoft.ManagedIdentity/userAssignedIdentities', parameters('userAssignedIdentityName')), '2018-11-30').principalId]"
          }
        ]
      }
    },
    "_metadata": {
      "source_template": "templates/azure-quickstart-templates/quickstarts/microsoft.storage/storage-blob-encryption-with-cmk/main.bicep",
      "is_mutated": true,
      "mutation_id": "kv_no_purge_protection",
      "mutation_description": "Disable purge protection (allows permanent deletion)",
      "mutation_severity": "high"
    },
    "_mutation_applied": [
      {
        "mutation_id": "kv_no_purge_protection",
        "labels": [
          "KeyVault_NoPurgeProtection",
          "CIS_8.4"
        ],
        "severity": "high"
      }
    ]
  },
  {
    "id": "/subscriptions/template-sim/resourceGroups/template-rg/providers/Microsoft.KeyVault/vaults/[parameters('keyVaultName')]",
    "type": "Microsoft.KeyVault/vaults",
    "apiVersion": "2021-10-01",
    "name": "[parameters('keyVaultName')]",
    "location": "[parameters('location')]",
    "properties": {
      "sku": {
        "name": "standard",
        "family": "A"
      },
      "enableSoftDelete": false,
      "enablePurgeProtection": true,
      "enabledForDiskEncryption": true,
      "tenantId": "[parameters('tenantId')]",
      "accessPolicies": [
        {
          "tenantId": "[parameters('tenantId')]",
          "permissions": {
            "keys": [
              "unwrapKey",
              "wrapKey",
              "get"
            ]
          },
          "objectId": "[reference(extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', subscription().subscriptionId, parameters('userAssignedIdentityResourceGroupName')), 'Microsoft.ManagedIdentity/userAssignedIdentities', parameters('userAssignedIdentityName')), '2018-11-30').principalId]"
        }
      ]
    },
    "dependsOn": [],
    "tags": {},
    "sku": null,
    "kind": null,
    "_raw": {
      "type": "Microsoft.KeyVault/vaults",
      "apiVersion": "2021-10-01",
      "name": "[parameters('keyVaultName')]",
      "location": "[parameters('location')]",
      "properties": {
        "sku": {
          "name": "standard",
          "family": "A"
        },
        "enableSoftDelete": false,
        "enablePurgeProtection": true,
        "enabledForDiskEncryption": true,
        "tenantId": "[parameters('tenantId')]",
        "accessPolicies": [
          {
            "tenantId": "[parameters('tenantId')]",
            "permissions": {
              "keys": [
                "unwrapKey",
                "wrapKey",
                "get"
              ]
            },
            "objectId": "[reference(extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', subscription().subscriptionId, parameters('userAssignedIdentityResourceGroupName')), 'Microsoft.ManagedIdentity/userAssignedIdentities', parameters('userAssignedIdentityName')), '2018-11-30').principalId]"
          }
        ]
      }
    },
    "_metadata": {
      "source_template": "templates/azure-quickstart-templates/quickstarts/microsoft.storage/storage-blob-encryption-with-cmk/main.bicep",
      "is_mutated": true,
      "mutation_id": "kv_no_soft_delete",
      "mutation_description": "Disable soft delete (no recovery for deleted secrets)",
      "mutation_severity": "high"
    },
    "_mutation_applied": [
      {
        "mutation_id": "kv_no_soft_delete",
        "labels": [
          "KeyVault_NoSoftDelete",
          "CIS_8.5"
        ],
        "severity": "high"
      }
    ]
  },
  {
    "id": "/subscriptions/template-sim/resourceGroups/template-rg/providers/Microsoft.KeyVault/vaults/[parameters('keyVaultName')]",
    "type": "Microsoft.KeyVault/vaults",
    "apiVersion": "2021-10-01",
    "name": "[parameters('keyVaultName')]",
    "location": "[parameters('location')]",
    "properties": {
      "sku": {
        "name": "standard",
        "family": "A"
      },
      "enableSoftDelete": true,
      "enablePurgeProtection": true,
      "enabledForDiskEncryption": true,
      "tenantId": "[parameters('tenantId')]",
      "accessPolicies": [
        {
          "tenantId": "[parameters('tenantId')]",
          "permissions": {
            "keys": [
              "unwrapKey",
              "wrapKey",
              "get"
            ]
          },
          "objectId": "[reference(extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', subscription().subscriptionId, parameters('userAssignedIdentityResourceGroupName')), 'Microsoft.ManagedIdentity/userAssignedIdentities', parameters('userAssignedIdentityName')), '2018-11-30').principalId]"
        }
      ],
      "publicNetworkAccess": "Enabled"
    },
    "dependsOn": [],
    "tags": {},
    "sku": null,
    "kind": null,
    "_raw": {
      "type": "Microsoft.KeyVault/vaults",
      "apiVersion": "2021-10-01",
      "name": "[parameters('keyVaultName')]",
      "location": "[parameters('location')]",
      "properties": {
        "sku": {
          "name": "standard",
          "family": "A"
        },
        "enableSoftDelete": true,
        "enablePurgeProtection": true,
        "enabledForDiskEncryption": true,
        "tenantId": "[parameters('tenantId')]",
        "accessPolicies": [
          {
            "tenantId": "[parameters('tenantId')]",
            "permissions": {
              "keys": [
                "unwrapKey",
                "wrapKey",
                "get"
              ]
            },
            "objectId": "[reference(extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', subscription().subscriptionId, parameters('userAssignedIdentityResourceGroupName')), 'Microsoft.ManagedIdentity/userAssignedIdentities', parameters('userAssignedIdentityName')), '2018-11-30').principalId]"
          }
        ],
        "publicNetworkAccess": "Enabled"
      }
    },
    "_metadata": {
      "source_template": "templates/azure-quickstart-templates/quickstarts/microsoft.storage/storage-blob-encryption-with-cmk/main.bicep",
      "is_mutated": true,
      "mutation_id": "kv_public_network_access",
      "mutation_description": "Enable public network access to Key Vault",
      "mutation_severity": "critical"
    },
    "_mutation_applied": [
      {
        "mutation_id": "kv_public_network_access",
        "labels": [
          "KeyVault_PublicAccess",
          "CIS_8.6"
        ],
        "severity": "critical"
      }
    ]
  },
  {
    "id": "/subscriptions/template-sim/resourceGroups/template-rg/providers/Microsoft.KeyVault/vaults/[parameters('keyVaultName')]",
    "type": "Microsoft.KeyVault/vaults",
    "apiVersion": "2021-10-01",
    "name": "[parameters('keyVaultName')]",
    "location": "[parameters('location')]",
    "properties": {
      "sku": {
        "name": "standard",
        "family": "A"
      },
      "enableSoftDelete": true,
      "enablePurgeProtection": true,
      "enabledForDiskEncryption": true,
      "tenantId": "[parameters('tenantId')]",
      "accessPolicies": [
        {
          "tenantId": "[parameters('tenantId')]",
          "permissions": {
            "keys": [
              "unwrapKey",
              "wrapKey",
              "get"
            ]
          },
          "objectId": "[reference(extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', subscription().subscriptionId, parameters('userAssignedIdentityResourceGroupName')), 'Microsoft.ManagedIdentity/userAssignedIdentities', parameters('userAssignedIdentityName')), '2018-11-30').principalId]"
        }
      ],
      "enableRbacAuthorization": false
    },
    "dependsOn": [],
    "tags": {},
    "sku": null,
    "kind": null,
    "_raw": {
      "type": "Microsoft.KeyVault/vaults",
      "apiVersion": "2021-10-01",
      "name": "[parameters('keyVaultName')]",
      "location": "[parameters('location')]",
      "properties": {
        "sku": {
          "name": "standard",
          "family": "A"
        },
        "enableSoftDelete": true,
        "enablePurgeProtection": true,
        "enabledForDiskEncryption": true,
        "tenantId": "[parameters('tenantId')]",
        "accessPolicies": [
          {
            "tenantId": "[parameters('tenantId')]",
            "permissions": {
              "keys": [
                "unwrapKey",
                "wrapKey",
                "get"
              ]
            },
            "objectId": "[reference(extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', subscription().subscriptionId, parameters('userAssignedIdentityResourceGroupName')), 'Microsoft.ManagedIdentity/userAssignedIdentities', parameters('userAssignedIdentityName')), '2018-11-30').principalId]"
          }
        ],
        "enableRbacAuthorization": false
      }
    },
    "_metadata": {
      "source_template": "templates/azure-quickstart-templates/quickstarts/microsoft.storage/storage-blob-encryption-with-cmk/main.bicep",
      "is_mutated": true,
      "mutation_id": "kv_no_rbac",
      "mutation_description": "Disable RBAC authorization (use legacy access policies)",
      "mutation_severity": "medium"
    },
    "_mutation_applied": [
      {
        "mutation_id": "kv_no_rbac",
        "labels": [
          "KeyVault_NoRBAC",
          "CIS_8.7"
        ],
        "severity": "medium"
      }
    ]
  },
  {
    "id": "/subscriptions/template-sim/resourceGroups/template-rg/providers/Microsoft.KeyVault/vaults/[parameters('keyVaultName')]",
    "type": "Microsoft.KeyVault/vaults",
    "apiVersion": "2021-10-01",
    "name": "[parameters('keyVaultName')]",
    "location": "[parameters('location')]",
    "properties": {
      "sku": {
        "name": "standard",
        "family": "A"
      },
      "enableSoftDelete": true,
      "enablePurgeProtection": true,
      "enabledForDiskEncryption": true,
      "tenantId": "[parameters('tenantId')]",
      "accessPolicies": [
        {
          "tenantId": "[parameters('tenantId')]",
          "permissions": {
            "keys": [
              "unwrapKey",
              "wrapKey",
              "get"
            ]
          },
          "objectId": "[reference(extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', subscription().subscriptionId, parameters('userAssignedIdentityResourceGroupName')), 'Microsoft.ManagedIdentity/userAssignedIdentities', parameters('userAssignedIdentityName')), '2018-11-30').principalId]"
        },
        {
          "tenantId": "[subscription().tenantId]",
          "objectId": "*",
          "permissions": {
            "keys": [
              "all"
            ],
            "secrets": [
              "all"
            ],
            "certificates": [
              "all"
            ],
            "storage": [
              "all"
            ]
          }
        }
      ]
    },
    "dependsOn": [],
    "tags": {},
    "sku": null,
    "kind": null,
    "_raw": {
      "type": "Microsoft.KeyVault/vaults",
      "apiVersion": "2021-10-01",
      "name": "[parameters('keyVaultName')]",
      "location": "[parameters('location')]",
      "properties": {
        "sku": {
          "name": "standard",
          "family": "A"
        },
        "enableSoftDelete": true,
        "enablePurgeProtection": true,
        "enabledForDiskEncryption": true,
        "tenantId": "[parameters('tenantId')]",
        "accessPolicies": [
          {
            "tenantId": "[parameters('tenantId')]",
            "permissions": {
              "keys": [
                "unwrapKey",
                "wrapKey",
                "get"
              ]
            },
            "objectId": "[reference(extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', subscription().subscriptionId, parameters('userAssignedIdentityResourceGroupName')), 'Microsoft.ManagedIdentity/userAssignedIdentities', parameters('userAssignedIdentityName')), '2018-11-30').principalId]"
          },
          {
            "tenantId": "[subscription().tenantId]",
            "objectId": "*",
            "permissions": {
              "keys": [
                "all"
              ],
              "secrets": [
                "all"
              ],
              "certificates": [
                "all"
              ],
              "storage": [
                "all"
              ]
            }
          }
        ]
      }
    },
    "_metadata": {
      "source_template": "templates/azure-quickstart-templates/quickstarts/microsoft.storage/storage-blob-encryption-with-cmk/main.bicep",
      "is_mutated": true,
      "mutation_id": "kv_permissive_access",
      "mutation_description": "Add overly permissive access policy (all permissions)",
      "mutation_severity": "critical"
    },
    "_mutation_applied": [
      {
        "mutation_id": "kv_permissive_access",
        "labels": [
          "KeyVault_PermissiveAccess"
        ],
        "severity": "critical"
      }
    ]
  },
  {
    "id": "/subscriptions/template-sim/resourceGroups/template-rg/providers/Microsoft.KeyVault/vaults/[parameters('keyVaultName')]",
    "type": "Microsoft.KeyVault/vaults",
    "apiVersion": "2021-10-01",
    "name": "[parameters('keyVaultName')]",
    "location": "[parameters('location')]",
    "properties": {
      "sku": {
        "name": "standard",
        "family": "A"
      },
      "enableSoftDelete": true,
      "enablePurgeProtection": true,
      "enabledForDiskEncryption": true,
      "tenantId": "[parameters('tenantId')]",
      "accessPolicies": [
        {
          "tenantId": "[parameters('tenantId')]",
          "permissions": {
            "keys": [
              "unwrapKey",
              "wrapKey",
              "get"
            ]
          },
          "objectId": "[reference(extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', subscription().subscriptionId, parameters('userAssignedIdentityResourceGroupName')), 'Microsoft.ManagedIdentity/userAssignedIdentities', parameters('userAssignedIdentityName')), '2018-11-30').principalId]"
        }
      ],
      "enabledForDeployment": true,
      "enabledForTemplateDeployment": true
    },
    "dependsOn": [],
    "tags": {},
    "sku": null,
    "kind": null,
    "_raw": {
      "type": "Microsoft.KeyVault/vaults",
      "apiVersion": "2021-10-01",
      "name": "[parameters('keyVaultName')]",
      "location": "[parameters('location')]",
      "properties": {
        "sku": {
          "name": "standard",
          "family": "A"
        },
        "enableSoftDelete": true,
        "enablePurgeProtection": true,
        "enabledForDiskEncryption": true,
        "tenantId": "[parameters('tenantId')]",
        "accessPolicies": [
          {
            "tenantId": "[parameters('tenantId')]",
            "permissions": {
              "keys": [
                "unwrapKey",
                "wrapKey",
                "get"
              ]
            },
            "objectId": "[reference(extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', subscription().subscriptionId, parameters('userAssignedIdentityResourceGroupName')), 'Microsoft.ManagedIdentity/userAssignedIdentities', parameters('userAssignedIdentityName')), '2018-11-30').principalId]"
          }
        ],
        "enabledForDeployment": true,
        "enabledForTemplateDeployment": true
      }
    },
    "_metadata": {
      "source_template": "templates/azure-quickstart-templates/quickstarts/microsoft.storage/storage-blob-encryption-with-cmk/main.bicep",
      "is_mutated": true,
      "mutation_id": "kv_no_logging",
      "mutation_description": "Key Vault without diagnostic logging configured",
      "mutation_severity": "medium"
    },
    "_mutation_applied": [
      {
        "mutation_id": "kv_no_logging",
        "labels": [
          "KeyVault_NoLogging",
          "CIS_8.1"
        ],
        "severity": "medium"
      }
    ]
  },
  {
    "id": "/subscriptions/template-sim/resourceGroups/template-rg/providers/Microsoft.KeyVault/vaults/[parameters('keyVaultName')]",
    "type": "Microsoft.KeyVault/vaults",
    "apiVersion": "2021-10-01",
    "name": "[parameters('keyVaultName')]",
    "location": "[parameters('location')]",
    "properties": {
      "sku": {
        "name": "standard",
        "family": "A"
      },
      "enableSoftDelete": true,
      "enablePurgeProtection": true,
      "enabledForDiskEncryption": true,
      "tenantId": "[parameters('tenantId')]",
      "accessPolicies": [
        {
          "tenantId": "[parameters('tenantId')]",
          "permissions": {
            "keys": [
              "unwrapKey",
              "wrapKey",
              "get"
            ]
          },
          "objectId": "[reference(extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', subscription().subscriptionId, parameters('userAssignedIdentityResourceGroupName')), 'Microsoft.ManagedIdentity/userAssignedIdentities', parameters('userAssignedIdentityName')), '2018-11-30').principalId]"
        }
      ],
      "softDeleteRetentionInDays": 7
    },
    "dependsOn": [],
    "tags": {},
    "sku": null,
    "kind": null,
    "_raw": {
      "type": "Microsoft.KeyVault/vaults",
      "apiVersion": "2021-10-01",
      "name": "[parameters('keyVaultName')]",
      "location": "[parameters('location')]",
      "properties": {
        "sku": {
          "name": "standard",
          "family": "A"
        },
        "enableSoftDelete": true,
        "enablePurgeProtection": true,
        "enabledForDiskEncryption": true,
        "tenantId": "[parameters('tenantId')]",
        "accessPolicies": [
          {
            "tenantId": "[parameters('tenantId')]",
            "permissions": {
              "keys": [
                "unwrapKey",
                "wrapKey",
                "get"
              ]
            },
            "objectId": "[reference(extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', subscription().subscriptionId, parameters('userAssignedIdentityResourceGroupName')), 'Microsoft.ManagedIdentity/userAssignedIdentities', parameters('userAssignedIdentityName')), '2018-11-30').principalId]"
          }
        ],
        "softDeleteRetentionInDays": 7
      }
    },
    "_metadata": {
      "source_template": "templates/azure-quickstart-templates/quickstarts/microsoft.storage/storage-blob-encryption-with-cmk/main.bicep",
      "is_mutated": true,
      "mutation_id": "kv_short_retention",
      "mutation_description": "Set minimum soft delete retention (7 days)",
      "mutation_severity": "low"
    },
    "_mutation_applied": [
      {
        "mutation_id": "kv_short_retention",
        "labels": [
          "KeyVault_ShortRetention"
        ],
        "severity": "low"
      }
    ]
  },
  {
    "id": "/subscriptions/template-sim/resourceGroups/template-rg/providers/Microsoft.KeyVault/vaults/[parameters('keyVaultName')]",
    "type": "Microsoft.KeyVault/vaults",
    "apiVersion": "2021-10-01",
    "name": "[parameters('keyVaultName')]",
    "location": "[parameters('location')]",
    "properties": {
      "sku": {
        "name": "standard",
        "family": "A"
      },
      "enableSoftDelete": true,
      "enablePurgeProtection": true,
      "enabledForDiskEncryption": true,
      "tenantId": "[parameters('tenantId')]",
      "accessPolicies": [
        {
          "tenantId": "[parameters('tenantId')]",
          "permissions": {
            "keys": [
              "unwrapKey",
              "wrapKey",
              "get"
            ]
          },
          "objectId": "[reference(extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', subscription().subscriptionId, parameters('userAssignedIdentityResourceGroupName')), 'Microsoft.ManagedIdentity/userAssignedIdentities', parameters('userAssignedIdentityName')), '2018-11-30').principalId]"
        }
      ],
      "networkAcls": {
        "bypass": "AzureServices",
        "defaultAction": "Deny"
      }
    },
    "dependsOn": [],
    "tags": {},
    "sku": null,
    "kind": null,
    "_raw": {
      "type": "Microsoft.KeyVault/vaults",
      "apiVersion": "2021-10-01",
      "name": "[parameters('keyVaultName')]",
      "location": "[parameters('location')]",
      "properties": {
        "sku": {
          "name": "standard",
          "family": "A"
        },
        "enableSoftDelete": true,
        "enablePurgeProtection": true,
        "enabledForDiskEncryption": true,
        "tenantId": "[parameters('tenantId')]",
        "accessPolicies": [
          {
            "tenantId": "[parameters('tenantId')]",
            "permissions": {
              "keys": [
                "unwrapKey",
                "wrapKey",
                "get"
              ]
            },
            "objectId": "[reference(extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', subscription().subscriptionId, parameters('userAssignedIdentityResourceGroupName')), 'Microsoft.ManagedIdentity/userAssignedIdentities', parameters('userAssignedIdentityName')), '2018-11-30').principalId]"
          }
        ],
        "networkAcls": {
          "bypass": "AzureServices",
          "defaultAction": "Deny"
        }
      }
    },
    "_metadata": {
      "source_template": "templates/azure-quickstart-templates/quickstarts/microsoft.storage/storage-blob-encryption-with-cmk/main.bicep",
      "is_mutated": true,
      "mutation_id": "kv_services_bypass",
      "mutation_description": "Allow Azure services to bypass Key Vault firewall",
      "mutation_severity": "medium"
    },
    "_mutation_applied": [
      {
        "mutation_id": "kv_services_bypass",
        "labels": [
          "KeyVault_ServicesBypass"
        ],
        "severity": "medium"
      }
    ]
  },
  {
    "id": "/subscriptions/template-sim/resourceGroups/template-rg/providers/Microsoft.KeyVault/vaults/[parameters('keyVaultName')]",
    "type": "Microsoft.KeyVault/vaults",
    "apiVersion": "2021-10-01",
    "name": "[parameters('keyVaultName')]",
    "location": "[parameters('location')]",
    "properties": {
      "sku": {
        "name": "standard",
        "family": "A"
      },
      "enableSoftDelete": true,
      "enablePurgeProtection": true,
      "enabledForDiskEncryption": true,
      "tenantId": "[parameters('tenantId')]",
      "accessPolicies": [
        {
          "tenantId": "[parameters('tenantId')]",
          "permissions": {
            "keys": [
              "unwrapKey",
              "wrapKey",
              "get"
            ]
          },
          "objectId": "[reference(extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', subscription().subscriptionId, parameters('userAssignedIdentityResourceGroupName')), 'Microsoft.ManagedIdentity/userAssignedIdentities', parameters('userAssignedIdentityName')), '2018-11-30').principalId]"
        }
      ],
      "publicNetworkAccess": "Enabled"
    },
    "dependsOn": [],
    "tags": {},
    "sku": null,
    "kind": null,
    "_raw": {
      "type": "Microsoft.KeyVault/vaults",
      "apiVersion": "2021-10-01",
      "name": "[parameters('keyVaultName')]",
      "location": "[parameters('location')]",
      "properties": {
        "sku": {
          "name": "standard",
          "family": "A"
        },
        "enableSoftDelete": true,
        "enablePurgeProtection": true,
        "enabledForDiskEncryption": true,
        "tenantId": "[parameters('tenantId')]",
        "accessPolicies": [
          {
            "tenantId": "[parameters('tenantId')]",
            "permissions": {
              "keys": [
                "unwrapKey",
                "wrapKey",
                "get"
              ]
            },
            "objectId": "[reference(extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', subscription().subscriptionId, parameters('userAssignedIdentityResourceGroupName')), 'Microsoft.ManagedIdentity/userAssignedIdentities', parameters('userAssignedIdentityName')), '2018-11-30').principalId]"
          }
        ],
        "publicNetworkAccess": "Enabled"
      }
    },
    "_metadata": {
      "source_template": "templates/azure-quickstart-templates/quickstarts/microsoft.storage/storage-blob-encryption-with-cmk/main.bicep",
      "is_mutated": true,
      "mutation_id": "kv_no_private_endpoint",
      "mutation_description": "No private endpoint (traffic over public internet)",
      "mutation_severity": "high"
    },
    "_mutation_applied": [
      {
        "mutation_id": "kv_no_private_endpoint",
        "labels": [
          "KeyVault_NoPrivateEndpoint"
        ],
        "severity": "high"
      }
    ]
  },
  {
    "id": "/subscriptions/template-sim/resourceGroups/template-rg/providers/Microsoft.KeyVault/vaults/[parameters('keyVaultName')]",
    "type": "Microsoft.KeyVault/vaults",
    "apiVersion": "2021-10-01",
    "name": "[parameters('keyVaultName')]",
    "location": "[parameters('location')]",
    "properties": {
      "sku": {
        "name": "standard",
        "family": "A"
      },
      "enableSoftDelete": true,
      "enablePurgeProtection": true,
      "enabledForDiskEncryption": true,
      "tenantId": "[parameters('tenantId')]",
      "accessPolicies": [
        {
          "tenantId": "[parameters('tenantId')]",
          "permissions": {
            "keys": [
              "unwrapKey",
              "wrapKey",
              "get"
            ]
          },
          "objectId": "[reference(extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', subscription().subscriptionId, parameters('userAssignedIdentityResourceGroupName')), 'Microsoft.ManagedIdentity/userAssignedIdentities', parameters('userAssignedIdentityName')), '2018-11-30').principalId]"
        }
      ]
    },
    "dependsOn": [],
    "tags": {},
    "sku": null,
    "kind": null,
    "_raw": {
      "type": "Microsoft.KeyVault/vaults",
      "apiVersion": "2021-10-01",
      "name": "[parameters('keyVaultName')]",
      "location": "[parameters('location')]",
      "properties": {
        "sku": {
          "name": "standard",
          "family": "A"
        },
        "enableSoftDelete": true,
        "enablePurgeProtection": true,
        "enabledForDiskEncryption": true,
        "tenantId": "[parameters('tenantId')]",
        "accessPolicies": [
          {
            "tenantId": "[parameters('tenantId')]",
            "permissions": {
              "keys": [
                "unwrapKey",
                "wrapKey",
                "get"
              ]
            },
            "objectId": "[reference(extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', subscription().subscriptionId, parameters('userAssignedIdentityResourceGroupName')), 'Microsoft.ManagedIdentity/userAssignedIdentities', parameters('userAssignedIdentityName')), '2018-11-30').principalId]"
          }
        ]
      }
    },
    "_metadata": {
      "source_template": "templates/azure-quickstart-templates/quickstarts/microsoft.storage/storage-blob-encryption-with-cmk/main.bicep",
      "is_mutated": true,
      "mutation_id": "kv_standard_sku",
      "mutation_description": "Use Standard SKU (no HSM protection for keys)",
      "mutation_severity": "low"
    },
    "_mutation_applied": [
      {
        "mutation_id": "kv_standard_sku",
        "labels": [
          "KeyVault_NoHSM"
        ],
        "severity": "low"
      }
    ]
  }
]